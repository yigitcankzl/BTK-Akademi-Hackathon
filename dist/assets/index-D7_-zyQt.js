var Ss=Object.defineProperty;var Cs=(i,e,r)=>e in i?Ss(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r;var $e=(i,e,r)=>Cs(i,typeof e!="symbol"?e+"":e,r);import{j as t,W as As,a as Hr,C as Bt,R as Qe,m,M as Es,A as oe,S as Ts,b as Is,B as Rs,U as Ke,L as Ps,H as Sr,P as rt,G as Cr,c as at,d as Je,e as ge,f as xe,g as We,h as Ca,E as Os,Z as qe,i as vt,k as De,l as Nt,F as fr,X as Ar,n as Mt,o as Ds,p as Gt,Q as _s,q as Ms,r as qr,s as Ls,T as zs,t as Aa,u as Us,v as Fs,w as $s,x as Bs,y as Gs,z as Er,D as Ea,I as Ta,J as Ia,K as Ks,N as Ra,O as Hs,V as qs,Y as Vs,_ as Ys,$ as Pa,a0 as dt,a1 as Ws,a2 as tt,a3 as Ct,a4 as Oa,a5 as Js,a6 as Vr,a7 as Qs,a8 as Xs,a9 as Yr,aa as br,ab as Zs,ac as Wr,ad as ei,ae as ti,af as Jr,ag as ri,ah as ai,ai as si}from"./ui-DVWY36Ga.js";import{a as ii,r as p,b as Kt}from"./vendor-Gm9i_4Ku.js";import{u as Ht,L as ie,a as gt,b as Da,B as ni,R as Qr,c as ce,N as Tr}from"./router-FOaSarTj.js";import{_ as jt,C as St,r as mt,S as oi,a as li,F as Ir,g as _a,b as Rr,c as At,d as ci,i as di,p as ui,u as mi,e as hi,E as Ma,o as gi,L as pi,f as La,h as za,v as Ua,j as Xr,k as Fa,l as yi,m as xi,n as fi,q as bi,G as ki,s as wi,t as Zr,w as te,x as ut,y as re,z as ea,A as vi,B as Pe,D as Ni,H as Re,I as ji,J as Si,K as Ci,M as $a,N as Ai,O as Ei,P as Z,Q as J,R as H,T as Ge,U as Ie,V as kr,W as ne,X as ct,Y as Ti,Z as wr,$ as Ii,a0 as Ri,a1 as Pi}from"./firebase-BTrwVOnm.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();var vr={},ta=ii;vr.createRoot=ta.createRoot,vr.hydrateRoot=ta.hydrateRoot;const Ba={isAuthenticated:!0,showWelcome:!1,isDarkMode:!1,settings:{geminiApiKey:"AIzaSyBWw-Vy9VKIDDZ-7D4Qq738Fcc2_2eSBWA",selectedModel:"gemini-1.5-flash",temperature:.7,maxTokens:1e3,language:"tr",enableNotifications:!0},uploadedFiles:[],processingFiles:[],fileResults:[],cart:{items:[],coupon:null,lastUpdated:null},products:{featured:[],categories:[],brands:[],filters:{category:null,brand:null,priceRange:[0,1e5],rating:0,inStock:!0},searchQuery:"",searchResults:[],recommendations:[]},user:{profile:null,addresses:[],wishlist:[],preferences:{favoriteCategories:[],preferredBrands:[],priceRange:[0,5e4],notifications:{orderUpdates:!0,promotions:!0,recommendations:!0}}},sidebarOpen:!1,activeTab:"home",notifications:[],isLoading:!1,error:null},B={LOGIN:"LOGIN",LOGOUT:"LOGOUT",SET_USER:"SET_USER",HIDE_WELCOME:"HIDE_WELCOME",TOGGLE_DARK_MODE:"TOGGLE_DARK_MODE",SET_THEME:"SET_THEME",UPDATE_SETTINGS:"UPDATE_SETTINGS",RESET_SETTINGS:"RESET_SETTINGS",ADD_UPLOADED_FILE:"ADD_UPLOADED_FILE",REMOVE_UPLOADED_FILE:"REMOVE_UPLOADED_FILE",SET_PROCESSING_FILE:"SET_PROCESSING_FILE",ADD_FILE_RESULT:"ADD_FILE_RESULT",CLEAR_FILE_RESULTS:"CLEAR_FILE_RESULTS",ADD_TO_CART:"ADD_TO_CART",REMOVE_FROM_CART:"REMOVE_FROM_CART",UPDATE_CART_QUANTITY:"UPDATE_CART_QUANTITY",CLEAR_CART:"CLEAR_CART",APPLY_COUPON:"APPLY_COUPON",REMOVE_COUPON:"REMOVE_COUPON",SET_CART:"SET_CART",SET_CART_ITEMS:"SET_CART_ITEMS",SET_PRODUCTS:"SET_PRODUCTS",SET_FEATURED_PRODUCTS:"SET_FEATURED_PRODUCTS",SET_CATEGORIES:"SET_CATEGORIES",SET_BRANDS:"SET_BRANDS",SET_PRODUCT_FILTERS:"SET_PRODUCT_FILTERS",SET_SEARCH_QUERY:"SET_SEARCH_QUERY",SET_SEARCH_RESULTS:"SET_SEARCH_RESULTS",CLEAR_SEARCH:"CLEAR_SEARCH",SET_RECOMMENDATIONS:"SET_RECOMMENDATIONS",SET_USER_PROFILE:"SET_USER_PROFILE",UPDATE_USER_PROFILE:"UPDATE_USER_PROFILE",ADD_USER_ADDRESS:"ADD_USER_ADDRESS",UPDATE_USER_ADDRESS:"UPDATE_USER_ADDRESS",DELETE_USER_ADDRESS:"DELETE_USER_ADDRESS",ADD_TO_WISHLIST:"ADD_TO_WISHLIST",REMOVE_FROM_WISHLIST:"REMOVE_FROM_WISHLIST",SET_USER_PREFERENCES:"SET_USER_PREFERENCES",TOGGLE_SIDEBAR:"TOGGLE_SIDEBAR",SET_ACTIVE_TAB:"SET_ACTIVE_TAB",ADD_NOTIFICATION:"ADD_NOTIFICATION",REMOVE_NOTIFICATION:"REMOVE_NOTIFICATION",SET_LOADING:"SET_LOADING",SET_ERROR:"SET_ERROR",CLEAR_ERROR:"CLEAR_ERROR"};function Oi(i,e){switch(e.type){case B.LOGIN:return{...i,isAuthenticated:!0,user:e.payload};case B.LOGOUT:return{...i,isAuthenticated:!1,user:null};case B.SET_USER:return{...i,user:e.payload};case B.HIDE_WELCOME:return{...i,showWelcome:!1};case B.TOGGLE_DARK_MODE:return{...i,isDarkMode:!i.isDarkMode};case B.SET_THEME:return{...i,isDarkMode:e.payload};case B.UPDATE_SETTINGS:return{...i,settings:{...i.settings,...e.payload}};case B.RESET_SETTINGS:return{...i,settings:Ba.settings};case B.ADD_UPLOADED_FILE:return{...i,uploadedFiles:[...i.uploadedFiles,e.payload]};case B.REMOVE_UPLOADED_FILE:return{...i,uploadedFiles:i.uploadedFiles.filter(r=>r.id!==e.payload)};case B.SET_PROCESSING_FILE:return{...i,processingFiles:e.payload};case B.ADD_FILE_RESULT:return{...i,fileResults:[...i.fileResults,e.payload]};case B.CLEAR_FILE_RESULTS:return{...i,fileResults:[]};case B.TOGGLE_SIDEBAR:return{...i,sidebarOpen:!i.sidebarOpen};case B.SET_ACTIVE_TAB:return{...i,activeTab:e.payload};case B.ADD_NOTIFICATION:return{...i,notifications:[...i.notifications,e.payload]};case B.REMOVE_NOTIFICATION:return{...i,notifications:i.notifications.filter(r=>r.id!==e.payload)};case B.SET_LOADING:return{...i,isLoading:e.payload};case B.SET_ERROR:return{...i,error:e.payload};case B.CLEAR_ERROR:return{...i,error:null};case B.SET_CART:return{...i,cart:e.payload};case B.ADD_TO_CART:return{...i,cart:{...i.cart,items:[...i.cart.items,e.payload],lastUpdated:new Date().toISOString()}};case B.REMOVE_FROM_CART:return{...i,cart:{...i.cart,items:i.cart.items.filter(r=>r.key!==e.payload),lastUpdated:new Date().toISOString()}};case B.UPDATE_CART_QUANTITY:return{...i,cart:{...i.cart,items:i.cart.items.map(r=>r.key===e.payload.itemKey?{...r,quantity:e.payload.quantity}:r),lastUpdated:new Date().toISOString()}};case B.CLEAR_CART:return{...i,cart:{items:[],coupon:null,lastUpdated:new Date().toISOString()}};case B.APPLY_COUPON:return{...i,cart:{...i.cart,coupon:e.payload}};case B.REMOVE_COUPON:return{...i,cart:{...i.cart,coupon:null}};case B.SET_FEATURED_PRODUCTS:return{...i,products:{...i.products,featured:e.payload}};case B.SET_CATEGORIES:return{...i,products:{...i.products,categories:e.payload}};case B.SET_BRANDS:return{...i,products:{...i.products,brands:e.payload}};case B.SET_PRODUCT_FILTERS:return{...i,products:{...i.products,filters:{...i.products.filters,...e.payload}}};case B.SET_SEARCH_QUERY:return{...i,products:{...i.products,searchQuery:e.payload}};case B.SET_SEARCH_RESULTS:return{...i,products:{...i.products,searchResults:e.payload}};case B.CLEAR_SEARCH:return{...i,products:{...i.products,searchQuery:"",searchResults:[]}};case B.SET_RECOMMENDATIONS:return{...i,products:{...i.products,recommendations:e.payload}};case B.SET_CART_ITEMS:return{...i,cart:{...i.cart,items:e.payload,lastUpdated:new Date().toISOString()}};case B.SET_USER_PROFILE:return{...i,user:{...i.user,profile:e.payload}};case B.UPDATE_USER_PROFILE:return{...i,user:{...i.user,profile:{...i.user.profile,...e.payload}}};case B.ADD_USER_ADDRESS:return{...i,user:{...i.user,addresses:[...i.user.addresses,e.payload]}};case B.UPDATE_USER_ADDRESS:return{...i,user:{...i.user,addresses:i.user.addresses.map(r=>r.id===e.payload.id?e.payload:r)}};case B.DELETE_USER_ADDRESS:return{...i,user:{...i.user,addresses:i.user.addresses.filter(r=>r.id!==e.payload)}};case B.ADD_TO_WISHLIST:return{...i,user:{...i.user,wishlist:[...i.user.wishlist,e.payload]}};case B.REMOVE_FROM_WISHLIST:return{...i,user:{...i.user,wishlist:i.user.wishlist.filter(r=>r.id!==e.payload)}};case B.SET_USER_PREFERENCES:return{...i,user:{...i.user,preferences:{...i.user.preferences,...e.payload}}};default:return i}}const Ga=p.createContext();function Di({children:i}){const[e,r]=p.useReducer(Oi,Ba);return p.useEffect(()=>{try{const a=localStorage.getItem("hackathon2025-settings"),s=localStorage.getItem("hackathon2025-theme"),n=localStorage.getItem("hackathon2025-auth"),o=localStorage.getItem("hackathon2025-cart"),l=localStorage.getItem("hackathon2025-user");if(a&&r({type:B.UPDATE_SETTINGS,payload:JSON.parse(a)}),s&&r({type:B.SET_THEME,payload:JSON.parse(s)}),n){const c=JSON.parse(n);c.isAuthenticated&&r({type:B.LOGIN,payload:c.user}),c.showWelcome||r({type:B.HIDE_WELCOME})}o&&r({type:B.SET_CART,payload:JSON.parse(o)}),l&&r({type:B.SET_USER,payload:JSON.parse(l)})}catch(a){console.error("Error loading saved data:",a)}},[]),p.useEffect(()=>{try{localStorage.setItem("hackathon2025-settings",JSON.stringify(e.settings))}catch(a){console.error("Error saving settings:",a)}},[e.settings]),p.useEffect(()=>{try{localStorage.setItem("hackathon2025-theme",JSON.stringify(e.isDarkMode))}catch(a){console.error("Error saving theme:",a)}},[e.isDarkMode]),p.useEffect(()=>{try{localStorage.setItem("hackathon2025-auth",JSON.stringify({isAuthenticated:e.isAuthenticated,user:e.user,showWelcome:e.showWelcome}))}catch(a){console.error("Error saving auth data:",a)}},[e.isAuthenticated,e.user,e.showWelcome]),p.useEffect(()=>{try{localStorage.setItem("hackathon2025-cart",JSON.stringify(e.cart))}catch(a){console.error("Error saving cart data:",a)}},[e.cart]),p.useEffect(()=>{e.isDarkMode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[e.isDarkMode]),t.jsx(Ga.Provider,{value:{state:e,dispatch:r,actionTypes:B},children:i})}function ae(){const i=p.useContext(Ga);if(!i)throw new Error("useApp must be used within an AppProvider");return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka="firebasestorage.googleapis.com",_i="storageBucket",Mi=2*60*1e3,Li=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue extends Ir{constructor(e,r,a=0){super(Qt(e),`Firebase Storage: ${r} (${Qt(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ue.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Qt(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ze;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ze||(ze={}));function Qt(i){return"storage/"+i}function zi(){const i="An unknown error occurred, please check the error payload for server response.";return new Ue(ze.UNKNOWN,i)}function Ui(){return new Ue(ze.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Fi(){return new Ue(ze.CANCELED,"User canceled the upload/download.")}function $i(i){return new Ue(ze.INVALID_URL,"Invalid URL '"+i+"'.")}function Bi(i){return new Ue(ze.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function ra(i){return new Ue(ze.INVALID_ARGUMENT,i)}function Ha(){return new Ue(ze.APP_DELETED,"The Firebase app was deleted.")}function Gi(i){return new Ue(ze.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let a;try{a=Oe.makeFromUrl(e,r)}catch{return new Oe(e,"")}if(a.path==="")return a;throw Bi(e)}static makeFromUrl(e,r){let a=null;const s="([A-Za-z0-9.\\-_]+)";function n(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(I){I.path_=decodeURIComponent(I.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",x=new RegExp(`^https?://${h}/${u}/b/${s}/o${g}`,"i"),k={bucket:1,path:3},f=r===Ka?"(?:storage.googleapis.com|storage.cloud.google.com)":r,E="([^?#]*)",j=new RegExp(`^https?://${f}/${s}/${E}`,"i"),D=[{regex:l,indices:c,postModify:n},{regex:x,indices:k,postModify:d},{regex:j,indices:{bucket:1,path:2},postModify:d}];for(let I=0;I<D.length;I++){const v=D[I],w=v.regex.exec(e);if(w){const y=w[v.indices.bucket];let P=w[v.indices.path];P||(P=""),a=new Oe(y,P),v.postModify(a);break}}if(a==null)throw $i(e);return a}}class Ki{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(i,e,r){let a=1,s=null,n=null,o=!1,l=0;function c(){return l===2}let d=!1;function u(...E){d||(d=!0,e.apply(null,E))}function h(E){s=setTimeout(()=>{s=null,i(x,c())},E)}function g(){n&&clearTimeout(n)}function x(E,...j){if(d){g();return}if(E){g(),u.call(null,E,...j);return}if(c()||o){g(),u.call(null,E,...j);return}a<64&&(a*=2);let D;l===1?(l=2,D=0):D=(a+Math.random())*1e3,h(D)}let k=!1;function f(E){k||(k=!0,g(),!d&&(s!==null?(E||(l=2),clearTimeout(s),h(0)):E||(l=1)))}return h(0),n=setTimeout(()=>{o=!0,f(!0)},r),f}function qi(i){i(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(i){return i!==void 0}function aa(i,e,r,a){if(a<e)throw ra(`Invalid value for '${i}'. Expected ${e} or greater.`);if(a>r)throw ra(`Invalid value for '${i}'. Expected ${r} or less.`)}function Yi(i){const e=encodeURIComponent;let r="?";for(const a in i)if(i.hasOwnProperty(a)){const s=e(a)+"="+e(i[a]);r=r+s+"&"}return r=r.slice(0,-1),r}var Lt;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(Lt||(Lt={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(i,e){const r=i>=500&&i<600,s=[408,429].indexOf(i)!==-1,n=e.indexOf(i)!==-1;return r||s||n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,r,a,s,n,o,l,c,d,u,h,g=!0,x=!1){this.url_=e,this.method_=r,this.headers_=a,this.body_=s,this.successCodes_=n,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=u,this.connectionFactory_=h,this.retry=g,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((k,f)=>{this.resolve_=k,this.reject_=f,this.start_()})}start_(){const e=(a,s)=>{if(s){a(!1,new Rt(!1,null,!0));return}const n=this.connectionFactory_();this.pendingConnection_=n;const o=l=>{const c=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&n.addUploadProgressListener(o),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&n.removeUploadProgressListener(o),this.pendingConnection_=null;const l=n.getErrorCode()===Lt.NO_ERROR,c=n.getStatus();if(!l||Wi(c,this.additionalRetryCodes_)&&this.retry){const u=n.getErrorCode()===Lt.ABORT;a(!1,new Rt(!1,null,u));return}const d=this.successCodes_.indexOf(c)!==-1;a(!0,new Rt(d,n))})},r=(a,s)=>{const n=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());Vi(c)?n(c):n()}catch(c){o(c)}else if(l!==null){const c=zi();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?Ha():Fi();o(c)}else{const c=Ui();o(c)}};this.canceled_?r(!1,new Rt(!1,null,!0)):this.backoffId_=Hi(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&qi(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Rt{constructor(e,r,a){this.wasSuccessCode=e,this.connection=r,this.canceled=!!a}}function Qi(i,e){e!==null&&e.length>0&&(i.Authorization="Firebase "+e)}function Xi(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Zi(i,e){e&&(i["X-Firebase-GMPID"]=e)}function en(i,e){e!==null&&(i["X-Firebase-AppCheck"]=e)}function tn(i,e,r,a,s,n,o=!0,l=!1){const c=Yi(i.urlParams),d=i.url+c,u=Object.assign({},i.headers);return Zi(u,e),Qi(u,r),Xi(u,n),en(u,a),new Ji(d,i.method,u,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(i){if(i.length===0)return null;const e=i.lastIndexOf("/");return e===-1?"":i.slice(0,e)}function an(i){const e=i.lastIndexOf("/",i.length-2);return e===-1?i:i.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e,r){this._service=e,r instanceof Oe?this._location=r:this._location=Oe.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new zt(e,r)}get root(){const e=new Oe(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return an(this._location.path)}get storage(){return this._service}get parent(){const e=rn(this._location.path);if(e===null)return null;const r=new Oe(this._location.bucket,e);return new zt(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw Gi(e)}}function sa(i,e){const r=e==null?void 0:e[_i];return r==null?null:Oe.makeFromBucketSpec(r,i)}function sn(i,e,r,a={}){i.host=`${e}:${r}`;const s=di(e);s&&(ui(`https://${i.host}/b`),mi("Storage",!0)),i._isUsingEmulator=!0,i._protocol=s?"https":"http";const{mockUserToken:n}=a;n&&(i._overrideAuthToken=typeof n=="string"?n:hi(n,i.app.options.projectId))}class nn{constructor(e,r,a,s,n,o=!1){this.app=e,this._authProvider=r,this._appCheckProvider=a,this._url=s,this._firebaseVersion=n,this._isUsingEmulator=o,this._bucket=null,this._host=Ka,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Mi,this._maxUploadRetryTime=Li,this._requests=new Set,s!=null?this._bucket=Oe.makeFromBucketSpec(s,this._host):this._bucket=sa(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Oe.makeFromBucketSpec(this._url,e):this._bucket=sa(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){aa("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){aa("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(li(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new zt(this,e)}_makeRequest(e,r,a,s,n=!0){if(this._deleted)return new Ki(Ha());{const o=tn(e,this._appId,a,s,r,this._firebaseVersion,n,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,r){const[a,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,a,s).getPromise()}}const ia="@firebase/storage",na="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa="storage";function on(i=_a(),e){i=Rr(i);const a=At(i,qa).getImmediate({identifier:e}),s=ci("storage");return s&&ln(a,...s),a}function ln(i,e,r,a={}){sn(i,e,r,a)}function cn(i,{instanceIdentifier:e}){const r=i.getProvider("app").getImmediate(),a=i.getProvider("auth-internal"),s=i.getProvider("app-check-internal");return new nn(r,a,s,e,oi)}function dn(){jt(new St(qa,cn,"PUBLIC").setMultipleInstances(!0)),mt(ia,na,""),mt(ia,na,"esm2020")}dn();const Va="@firebase/installations",Pr="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=1e4,Wa=`w:${Pr}`,Ja="FIS_v2",un="https://firebaseinstallations.googleapis.com/v1",mn=60*60*1e3,hn="installations",gn="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},st=new Ma(hn,gn,pn);function Qa(i){return i instanceof Ir&&i.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa({projectId:i}){return`${un}/projects/${i}/installations`}function Za(i){return{token:i.token,requestStatus:2,expiresIn:xn(i.expiresIn),creationTime:Date.now()}}async function es(i,e){const a=(await e.json()).error;return st.create("request-failed",{requestName:i,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function ts({apiKey:i}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":i})}function yn(i,{refreshToken:e}){const r=ts(i);return r.append("Authorization",fn(e)),r}async function rs(i){const e=await i();return e.status>=500&&e.status<600?i():e}function xn(i){return Number(i.replace("s","000"))}function fn(i){return`${Ja} ${i}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bn({appConfig:i,heartbeatServiceProvider:e},{fid:r}){const a=Xa(i),s=ts(i),n=e.getImmediate({optional:!0});if(n){const d=await n.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:r,authVersion:Ja,appId:i.appId,sdkVersion:Wa},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await rs(()=>fetch(a,l));if(c.ok){const d=await c.json();return{fid:d.fid||r,registrationStatus:2,refreshToken:d.refreshToken,authToken:Za(d.authToken)}}else throw await es("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function as(i){return new Promise(e=>{setTimeout(e,i)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(i){return btoa(String.fromCharCode(...i)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=/^[cdef][\w-]{21}$/,Nr="";function vn(){try{const i=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(i),i[0]=112+i[0]%16;const r=Nn(i);return wn.test(r)?r:Nr}catch{return Nr}}function Nn(i){return kn(i).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(i){return`${i.appName}!${i.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss=new Map;function is(i,e){const r=qt(i);ns(r,e),jn(r,e)}function ns(i,e){const r=ss.get(i);if(r)for(const a of r)a(e)}function jn(i,e){const r=Sn();r&&r.postMessage({key:i,fid:e}),Cn()}let et=null;function Sn(){return!et&&"BroadcastChannel"in self&&(et=new BroadcastChannel("[Firebase] FID Change"),et.onmessage=i=>{ns(i.data.key,i.data.fid)}),et}function Cn(){ss.size===0&&et&&(et.close(),et=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An="firebase-installations-database",En=1,it="firebase-installations-store";let Xt=null;function Or(){return Xt||(Xt=gi(An,En,{upgrade:(i,e)=>{switch(e){case 0:i.createObjectStore(it)}}})),Xt}async function Ut(i,e){const r=qt(i),s=(await Or()).transaction(it,"readwrite"),n=s.objectStore(it),o=await n.get(r);return await n.put(e,r),await s.done,(!o||o.fid!==e.fid)&&is(i,e.fid),e}async function os(i){const e=qt(i),a=(await Or()).transaction(it,"readwrite");await a.objectStore(it).delete(e),await a.done}async function Vt(i,e){const r=qt(i),s=(await Or()).transaction(it,"readwrite"),n=s.objectStore(it),o=await n.get(r),l=e(o);return l===void 0?await n.delete(r):await n.put(l,r),await s.done,l&&(!o||o.fid!==l.fid)&&is(i,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dr(i){let e;const r=await Vt(i.appConfig,a=>{const s=Tn(a),n=In(i,s);return e=n.registrationPromise,n.installationEntry});return r.fid===Nr?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function Tn(i){const e=i||{fid:vn(),registrationStatus:0};return ls(e)}function In(i,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(st.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=Rn(i,r);return{installationEntry:r,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Pn(i)}:{installationEntry:e}}async function Rn(i,e){try{const r=await bn(i,e);return Ut(i.appConfig,r)}catch(r){throw Qa(r)&&r.customData.serverCode===409?await os(i.appConfig):await Ut(i.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function Pn(i){let e=await oa(i.appConfig);for(;e.registrationStatus===1;)await as(100),e=await oa(i.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:a}=await Dr(i);return a||r}return e}function oa(i){return Vt(i,e=>{if(!e)throw st.create("installation-not-found");return ls(e)})}function ls(i){return On(i)?{fid:i.fid,registrationStatus:0}:i}function On(i){return i.registrationStatus===1&&i.registrationTime+Ya<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dn({appConfig:i,heartbeatServiceProvider:e},r){const a=_n(i,r),s=yn(i,r),n=e.getImmediate({optional:!0});if(n){const d=await n.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:Wa,appId:i.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await rs(()=>fetch(a,l));if(c.ok){const d=await c.json();return Za(d)}else throw await es("Generate Auth Token",c)}function _n(i,{fid:e}){return`${Xa(i)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _r(i,e=!1){let r;const a=await Vt(i.appConfig,n=>{if(!cs(n))throw st.create("not-registered");const o=n.authToken;if(!e&&zn(o))return n;if(o.requestStatus===1)return r=Mn(i,e),n;{if(!navigator.onLine)throw st.create("app-offline");const l=Fn(n);return r=Ln(i,l),l}});return r?await r:a.authToken}async function Mn(i,e){let r=await la(i.appConfig);for(;r.authToken.requestStatus===1;)await as(100),r=await la(i.appConfig);const a=r.authToken;return a.requestStatus===0?_r(i,e):a}function la(i){return Vt(i,e=>{if(!cs(e))throw st.create("not-registered");const r=e.authToken;return $n(r)?{...e,authToken:{requestStatus:0}}:e})}async function Ln(i,e){try{const r=await Dn(i,e),a={...e,authToken:r};return await Ut(i.appConfig,a),r}catch(r){if(Qa(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await os(i.appConfig);else{const a={...e,authToken:{requestStatus:0}};await Ut(i.appConfig,a)}throw r}}function cs(i){return i!==void 0&&i.registrationStatus===2}function zn(i){return i.requestStatus===2&&!Un(i)}function Un(i){const e=Date.now();return e<i.creationTime||i.creationTime+i.expiresIn<e+mn}function Fn(i){const e={requestStatus:1,requestTime:Date.now()};return{...i,authToken:e}}function $n(i){return i.requestStatus===1&&i.requestTime+Ya<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bn(i){const e=i,{installationEntry:r,registrationPromise:a}=await Dr(e);return a?a.catch(console.error):_r(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gn(i,e=!1){const r=i;return await Kn(r),(await _r(r,e)).token}async function Kn(i){const{registrationPromise:e}=await Dr(i);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(i){if(!i||!i.options)throw Zt("App Configuration");if(!i.name)throw Zt("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!i.options[r])throw Zt(r);return{appName:i.name,projectId:i.options.projectId,apiKey:i.options.apiKey,appId:i.options.appId}}function Zt(i){return st.create("missing-app-config-values",{valueName:i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds="installations",qn="installations-internal",Vn=i=>{const e=i.getProvider("app").getImmediate(),r=Hn(e),a=At(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},Yn=i=>{const e=i.getProvider("app").getImmediate(),r=At(e,ds).getImmediate();return{getId:()=>Bn(r),getToken:s=>Gn(r,s)}};function Wn(){jt(new St(ds,Vn,"PUBLIC")),jt(new St(qn,Yn,"PRIVATE"))}Wn();mt(Va,Pr);mt(Va,Pr,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft="analytics",Jn="firebase_id",Qn="origin",Xn=60*1e3,Zn="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Mr="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe=new pi("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ve=new Ma("analytics","Analytics",eo);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function to(i){if(!i.startsWith(Mr)){const e=ve.create("invalid-gtag-resource",{gtagURL:i});return fe.warn(e.message),""}return i}function us(i){return Promise.all(i.map(e=>e.catch(r=>r)))}function ro(i,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(i,e)),r}function ao(i,e){const r=ro("firebase-js-sdk-policy",{createScriptURL:to}),a=document.createElement("script"),s=`${Mr}?l=${i}&id=${e}`;a.src=r?r==null?void 0:r.createScriptURL(s):s,a.async=!0,document.head.appendChild(a)}function so(i){let e=[];return Array.isArray(window[i])?e=window[i]:window[i]=e,e}async function io(i,e,r,a,s,n){const o=a[s];try{if(o)await e[o];else{const c=(await us(r)).find(d=>d.measurementId===s);c&&await e[c.appId]}}catch(l){fe.error(l)}i("config",s,n)}async function no(i,e,r,a,s){try{let n=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const l=await us(r);for(const c of o){const d=l.find(h=>h.measurementId===c),u=d&&e[d.appId];if(u)n.push(u);else{n=[];break}}}n.length===0&&(n=Object.values(e)),await Promise.all(n),i("event",a,s||{})}catch(n){fe.error(n)}}function oo(i,e,r,a){async function s(n,...o){try{if(n==="event"){const[l,c]=o;await no(i,e,r,l,c)}else if(n==="config"){const[l,c]=o;await io(i,e,r,a,l,c)}else if(n==="consent"){const[l,c]=o;i("consent",l,c)}else if(n==="get"){const[l,c,d]=o;i("get",l,c,d)}else if(n==="set"){const[l]=o;i("set",l)}else i(n,...o)}catch(l){fe.error(l)}}return s}function lo(i,e,r,a,s){let n=function(...o){window[a].push(arguments)};return window[s]&&typeof window[s]=="function"&&(n=window[s]),window[s]=oo(n,i,e,r),{gtagCore:n,wrappedGtag:window[s]}}function co(i){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(Mr)&&r.src.includes(i))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uo=30,mo=1e3;class ho{constructor(e={},r=mo){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const ms=new ho;function go(i){return new Headers({Accept:"application/json","x-goog-api-key":i})}async function po(i){var o;const{appId:e,apiKey:r}=i,a={method:"GET",headers:go(r)},s=Zn.replace("{app-id}",e),n=await fetch(s,a);if(n.status!==200&&n.status!==304){let l="";try{const c=await n.json();(o=c.error)!=null&&o.message&&(l=c.error.message)}catch{}throw ve.create("config-fetch-failed",{httpStatus:n.status,responseMessage:l})}return n.json()}async function yo(i,e=ms,r){const{appId:a,apiKey:s,measurementId:n}=i.options;if(!a)throw ve.create("no-app-id");if(!s){if(n)return{measurementId:n,appId:a};throw ve.create("no-api-key")}const o=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new bo;return setTimeout(async()=>{l.abort()},Xn),hs({appId:a,apiKey:s,measurementId:n},o,l,e)}async function hs(i,{throttleEndTimeMillis:e,backoffCount:r},a,s=ms){var l;const{appId:n,measurementId:o}=i;try{await xo(a,e)}catch(c){if(o)return fe.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:n,measurementId:o};throw c}try{const c=await po(i);return s.deleteThrottleMetadata(n),c}catch(c){const d=c;if(!fo(d)){if(s.deleteThrottleMetadata(n),o)return fe.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:n,measurementId:o};throw c}const u=Number((l=d==null?void 0:d.customData)==null?void 0:l.httpStatus)===503?Xr(r,s.intervalMillis,uo):Xr(r,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+u,backoffCount:r+1};return s.setThrottleMetadata(n,h),fe.debug(`Calling attemptFetch again in ${u} millis`),hs(i,h,a,s)}}function xo(i,e){return new Promise((r,a)=>{const s=Math.max(e-Date.now(),0),n=setTimeout(r,s);i.addEventListener(()=>{clearTimeout(n),a(ve.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function fo(i){if(!(i instanceof Ir)||!i.customData)return!1;const e=Number(i.customData.httpStatus);return e===429||e===500||e===503||e===504}class bo{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function ko(i,e,r,a,s){if(s&&s.global){i("event",r,a);return}else{const n=await e,o={...a,send_to:n};i("event",r,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wo(){if(za())try{await Ua()}catch(i){return fe.warn(ve.create("indexeddb-unavailable",{errorInfo:i==null?void 0:i.toString()}).message),!1}else return fe.warn(ve.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function vo(i,e,r,a,s,n,o){const l=yo(i);l.then(g=>{r[g.measurementId]=g.appId,i.options.measurementId&&g.measurementId!==i.options.measurementId&&fe.warn(`The measurement ID in the local Firebase config (${i.options.measurementId}) does not match the measurement ID fetched from the server (${g.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(g=>fe.error(g)),e.push(l);const c=wo().then(g=>{if(g)return a.getId()}),[d,u]=await Promise.all([l,c]);co(n)||ao(n,d.measurementId),s("js",new Date);const h=(o==null?void 0:o.config)??{};return h[Qn]="firebase",h.update=!0,u!=null&&(h[Jn]=u),s("config",d.measurementId,h),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e){this.app=e}_delete(){return delete kt[this.app.options.appId],Promise.resolve()}}let kt={},ca=[];const da={};let er="dataLayer",jo="gtag",ua,gs,ma=!1;function So(){const i=[];if(La()&&i.push("This is a browser extension environment."),Fa()||i.push("Cookies are not available."),i.length>0){const e=i.map((a,s)=>`(${s+1}) ${a}`).join(" "),r=ve.create("invalid-analytics-context",{errorInfo:e});fe.warn(r.message)}}function Co(i,e,r){So();const a=i.options.appId;if(!a)throw ve.create("no-app-id");if(!i.options.apiKey)if(i.options.measurementId)fe.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${i.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ve.create("no-api-key");if(kt[a]!=null)throw ve.create("already-exists",{id:a});if(!ma){so(er);const{wrappedGtag:n,gtagCore:o}=lo(kt,ca,da,er,jo);gs=n,ua=o,ma=!0}return kt[a]=vo(i,ca,da,e,ua,er,r),new No(i)}function Ao(i=_a()){i=Rr(i);const e=At(i,Ft);return e.isInitialized()?e.getImmediate():Eo(i)}function Eo(i,e={}){const r=At(i,Ft);if(r.isInitialized()){const s=r.getImmediate();if(yi(e,r.getOptions()))return s;throw ve.create("already-initialized")}return r.initialize({options:e})}async function To(){if(La()||!Fa()||!za())return!1;try{return await Ua()}catch{return!1}}function Io(i,e,r,a){i=Rr(i),ko(gs,kt[i.app.options.appId],e,r,a).catch(s=>fe.error(s))}const ha="@firebase/analytics",ga="0.10.18";function Ro(){jt(new St(Ft,(e,{options:r})=>{const a=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return Co(a,s,r)},"PUBLIC")),jt(new St("analytics-internal",i,"PRIVATE")),mt(ha,ga),mt(ha,ga,"esm2020");function i(e){try{const r=e.getProvider(Ft).getImmediate();return{logEvent:(a,s,n)=>Io(r,a,s,n)}}catch(r){throw ve.create("interop-component-reg-failed",{reason:r})}}}Ro();const Po={apiKey:"AIzaSyCU-KVaFy8pKJ7BhWsC90u0nyzKOqC21j0",authDomain:"btk-akademi-hackathon.firebaseapp.com",projectId:"btk-akademi-hackathon",storageBucket:"btk-akademi-hackathon.firebasestorage.app",messagingSenderId:"536428827175",appId:"1:536428827175:web:83f09d6d4c5754e6497402"},Yt=xi(Po),F=fi(Yt),he=bi(Yt);on(Yt);typeof window<"u"&&To().then(i=>{i&&Ao(Yt)});const Oo=Object.freeze(Object.defineProperty({__proto__:null,auth:he,db:F},Symbol.toStringTag,{value:"Module"}));class Do{constructor(){this.googleProvider=new ki,this.googleProvider.addScope("email"),this.googleProvider.addScope("profile")}async register(e,r,a={}){try{const n=(await wi(he,e,r)).user;await Zr(n,{displayName:a.displayName||`${a.firstName} ${a.lastName}`.trim()});const o={uid:n.uid,email:n.email,displayName:a.displayName||`${a.firstName} ${a.lastName}`.trim(),firstName:a.firstName||"",lastName:a.lastName||"",emailVerified:n.emailVerified,photoURL:n.photoURL||"",createdAt:te(),updatedAt:te(),preferences:{favoriteCategories:[],preferredBrands:[],priceRange:[0,5e4],notifications:{orderUpdates:!0,promotions:!0,recommendations:!0}},addresses:[],orders:[],wishlist:[]};return await ut(re(F,"users",n.uid),o),await ea(n),{success:!0,user:{uid:n.uid,email:n.email,displayName:o.displayName,firstName:a.firstName||"",lastName:a.lastName||"",emailVerified:n.emailVerified,photoURL:n.photoURL||"",preferences:o.preferences,addresses:o.addresses,orders:o.orders,wishlist:o.wishlist}}}catch(s){throw console.error("Registration error:",s),this.handleAuthError(s)}}async login(e,r){try{const s=(await vi(he,e,r)).user,n=await Pe(re(F,"users",s.uid)),o=n.exists()?n.data():{};return{success:!0,user:{uid:s.uid,email:s.email,displayName:s.displayName||o.displayName||"",firstName:o.firstName||"",lastName:o.lastName||"",emailVerified:s.emailVerified,photoURL:s.photoURL||o.photoURL||"",preferences:o.preferences||{},addresses:o.addresses||[],orders:o.orders||[],wishlist:o.wishlist||[]}}}catch(a){throw console.error("Login error:",a),this.handleAuthError(a)}}async loginWithGoogle(){var e,r;try{const s=(await Ni(he,this.googleProvider)).user,n=re(F,"users",s.uid),o=await Pe(n);let l;return o.exists()?(l=o.data(),await Re(n,{updatedAt:te()})):(l={uid:s.uid,email:s.email,displayName:s.displayName||"",firstName:((e=s.displayName)==null?void 0:e.split(" ")[0])||"",lastName:((r=s.displayName)==null?void 0:r.split(" ").slice(1).join(" "))||"",emailVerified:s.emailVerified,photoURL:s.photoURL||"",provider:"google",createdAt:te(),updatedAt:te(),preferences:{favoriteCategories:[],preferredBrands:[],priceRange:[0,5e4],notifications:{orderUpdates:!0,promotions:!0,recommendations:!0}},addresses:[],orders:[],wishlist:[]},await ut(n,l)),{success:!0,user:{uid:s.uid,email:s.email,displayName:s.displayName||l.displayName||"",firstName:l.firstName||"",lastName:l.lastName||"",emailVerified:s.emailVerified,photoURL:s.photoURL||l.photoURL||"",preferences:l.preferences||{},addresses:l.addresses||[],orders:l.orders||[],wishlist:l.wishlist||[]}}}catch(a){throw console.error("Google login error:",a),this.handleAuthError(a)}}async logout(){try{return await ji(he),{success:!0}}catch(e){throw console.error("Logout error:",e),this.handleAuthError(e)}}async resetPassword(e){try{return await Si(he,e),{success:!0,message:"Şifre sıfırlama e-postası gönderildi"}}catch(r){throw console.error("Password reset error:",r),this.handleAuthError(r)}}async updateUserProfile(e){try{const r=he.currentUser;if(!r)throw new Error("Kullanıcı oturumu bulunamadı");(e.displayName||e.photoURL)&&await Zr(r,{displayName:e.displayName,photoURL:e.photoURL});const a=re(F,"users",r.uid);return await Re(a,{...e,updatedAt:te()}),{success:!0}}catch(r){throw console.error("Profile update error:",r),this.handleAuthError(r)}}async changePassword(e){try{const r=he.currentUser;if(!r)throw new Error("Kullanıcı oturumu bulunamadı");return await Ci(r,e),{success:!0,message:"Şifre başarıyla güncellendi"}}catch(r){throw console.error("Password change error:",r),this.handleAuthError(r)}}async deleteAccount(){try{const e=he.currentUser;if(!e)throw new Error("Kullanıcı oturumu bulunamadı");return await $a(re(F,"users",e.uid)),await Ai(e),{success:!0,message:"Hesap başarıyla silindi"}}catch(e){throw console.error("Account deletion error:",e),this.handleAuthError(e)}}getCurrentUser(){return he.currentUser}async getCurrentUserData(){try{const e=he.currentUser;if(!e)return null;const r=await Pe(re(F,"users",e.uid));if(!r.exists())return null;const a=r.data();return{uid:e.uid,email:e.email,displayName:e.displayName||a.displayName||"",firstName:a.firstName||"",lastName:a.lastName||"",emailVerified:e.emailVerified,photoURL:e.photoURL||a.photoURL||"",preferences:a.preferences||{},addresses:a.addresses||[],orders:a.orders||[],wishlist:a.wishlist||[]}}catch(e){return console.error("Get user data error:",e),null}}onAuthStateChange(e){return Ei(he,async r=>{if(r)try{await new Promise(o=>setTimeout(o,1e3));const a=await Pe(re(F,"users",r.uid)),s=a.exists()?a.data():{},n={uid:r.uid,email:r.email,displayName:r.displayName||s.displayName||"",firstName:s.firstName||"",lastName:s.lastName||"",emailVerified:r.emailVerified,photoURL:r.photoURL||s.photoURL||"",preferences:s.preferences||{},addresses:s.addresses||[],orders:s.orders||[],wishlist:s.wishlist||[]};e(n)}catch(a){console.warn("Error getting user data, using basic auth info:",a),e({uid:r.uid,email:r.email,displayName:r.displayName||"",firstName:"",lastName:"",emailVerified:r.emailVerified,photoURL:r.photoURL||"",preferences:{},addresses:[],orders:[],wishlist:[]})}else e(null)})}async sendVerificationEmail(){try{const e=he.currentUser;if(!e)throw new Error("Kullanıcı oturumu bulunamadı");return await ea(e),{success:!0,message:"Doğrulama e-postası gönderildi"}}catch(e){throw console.error("Email verification error:",e),this.handleAuthError(e)}}isAuthenticated(){return he.currentUser!==null}async getUserToken(){try{const e=he.currentUser;return e?await e.getIdToken():null}catch(e){return console.error("Get token error:",e),null}}async testConnection(){try{return{success:!0,message:"Firebase authentication service ready"}}catch(e){return{success:!1,message:"Firebase authentication service error: "+e.message}}}handleAuthError(e){const r={"auth/user-not-found":"Bu e-posta adresi ile kayıtlı kullanıcı bulunamadı","auth/wrong-password":"Hatalı şifre","auth/invalid-credential":"E-posta veya şifre hatalı","auth/email-already-in-use":"Bu e-posta adresi zaten kullanımda. Giriş yapmayı deneyin.","auth/weak-password":"Şifre çok zayıf. En az 6 karakter olmalıdır","auth/invalid-email":"Geçersiz e-posta adresi","auth/user-disabled":"Bu hesap devre dışı bırakılmış","auth/too-many-requests":"Çok fazla deneme. Lütfen daha sonra tekrar deneyin","auth/network-request-failed":"Ağ bağlantısı hatası","auth/requires-recent-login":"Bu işlem için yeniden giriş yapmanız gerekiyor","auth/popup-closed-by-user":"Giriş penceresi kapatıldı","auth/popup-blocked":"Pop-up engellendi. Lütfen pop-up'lara izin verin","permission-denied":"İzin reddedildi. Lütfen daha sonra tekrar deneyin.",unavailable:"Servis şu anda kullanılamıyor. Lütfen daha sonra tekrar deneyin."};if(e.code&&e.code.includes("firestore/"))return console.warn("Firestore error (non-critical):",e),new Error("Veri kaydedildi ancak bazı özellikler gecikebilir");const a=r[e.code]||e.message||"Bilinmeyen hata oluştu";return new Error(a)}}const pa=new Do;class _o{constructor(){this.currentUser=null,this.listeners=[],this.users=JSON.parse(localStorage.getItem("mockUsers")||"[]");const e=localStorage.getItem("mockCurrentUser");e?(this.currentUser=JSON.parse(e),setTimeout(()=>{this.notifyListeners(this.currentUser)},100)):setTimeout(()=>{this.notifyListeners(null)},100)}async register(e,r,a={}){try{if(this.users.find(c=>c.email===e))throw new Error("Bu e-posta adresi zaten kullanımda");const n={uid:Date.now().toString(),email:e,displayName:a.displayName||"",firstName:a.firstName||"",lastName:a.lastName||"",emailVerified:!1,photoURL:"",createdAt:new Date().toISOString(),preferences:{favoriteCategories:[],preferredBrands:[],priceRange:[0,5e4],notifications:{orderUpdates:!0,promotions:!0,recommendations:!0}},addresses:[],password:r};this.users.push(n),localStorage.setItem("mockUsers",JSON.stringify(this.users));const{password:o,...l}=n;return this.currentUser=l,localStorage.setItem("mockCurrentUser",JSON.stringify(this.currentUser)),this.notifyListeners(this.currentUser),{success:!0,user:this.currentUser}}catch(s){throw s}}async login(e,r){try{const a=this.users.find(o=>o.email===e&&o.password===r);if(!a)throw new Error("E-posta veya şifre hatalı");const{password:s,...n}=a;return this.currentUser=n,localStorage.setItem("mockCurrentUser",JSON.stringify(this.currentUser)),this.notifyListeners(this.currentUser),{success:!0,user:this.currentUser}}catch(a){throw a}}async loginWithGoogle(){try{const e={uid:"google_"+Date.now().toString(),email:"google.user@gmail.com",displayName:"Google User",firstName:"Google",lastName:"User",emailVerified:!0,photoURL:"https://ui-avatars.com/api/?name=Google+User&background=random",provider:"google",createdAt:new Date().toISOString(),preferences:{favoriteCategories:[],preferredBrands:[],priceRange:[0,5e4],notifications:{orderUpdates:!0,promotions:!0,recommendations:!0}},addresses:[]};return this.currentUser=e,localStorage.setItem("mockCurrentUser",JSON.stringify(this.currentUser)),this.notifyListeners(this.currentUser),{success:!0,user:this.currentUser}}catch(e){throw e}}async logout(){try{return this.currentUser=null,localStorage.removeItem("mockCurrentUser"),this.notifyListeners(null),{success:!0}}catch(e){throw e}}async resetPassword(e){try{if(!this.users.find(a=>a.email===e))throw new Error("Bu e-posta adresi ile kayıtlı kullanıcı bulunamadı");return{success:!0,message:"Şifre sıfırlama e-postası gönderildi (Mock)"}}catch(r){throw r}}async updateUserProfile(e){try{if(!this.currentUser)throw new Error("Kullanıcı oturumu bulunamadı");this.currentUser={...this.currentUser,...e},localStorage.setItem("mockCurrentUser",JSON.stringify(this.currentUser));const r=this.users.findIndex(a=>a.uid===this.currentUser.uid);return r!==-1&&(this.users[r]={...this.users[r],...e},localStorage.setItem("mockUsers",JSON.stringify(this.users))),this.notifyListeners(this.currentUser),{success:!0}}catch(r){throw r}}getCurrentUser(){return this.currentUser}async getCurrentUserData(){return this.currentUser}onAuthStateChange(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(r=>r!==e)}}notifyListeners(e){this.listeners.forEach(r=>r(e))}async sendVerificationEmail(){return{success:!0,message:"Doğrulama e-postası gönderildi (Mock)"}}async changePassword(e){try{if(!this.currentUser)throw new Error("Kullanıcı oturumu bulunamadı");const r=this.users.findIndex(a=>a.uid===this.currentUser.uid);return r!==-1&&(this.users[r].password=e,localStorage.setItem("mockUsers",JSON.stringify(this.users))),{success:!0,message:"Şifre başarıyla güncellendi"}}catch(r){throw r}}async deleteAccount(){try{if(!this.currentUser)throw new Error("Kullanıcı oturumu bulunamadı");return this.users=this.users.filter(e=>e.uid!==this.currentUser.uid),localStorage.setItem("mockUsers",JSON.stringify(this.users)),await this.logout(),{success:!0,message:"Hesap başarıyla silindi"}}catch(e){throw e}}isAuthenticated(){return this.currentUser!==null}async getUserToken(){return this.currentUser?"mock_token_"+this.currentUser.uid:null}async testConnection(){return{success:!0,message:"Mock authentication service ready"}}}const Mo=new _o;class Lo{constructor(){this.useFirebase=this.checkFirebaseConfig(),this.useFirebase?(this.authProvider=pa,console.info("Using Firebase authentication service")):(this.authProvider=Mo,console.info("Using mock authentication service for development"))}checkFirebaseConfig(){try{return"btk-akademi-hackathon"}catch(e){return console.warn("Firebase configuration check failed:",e),!1}}async register(e,r,a={}){return await this.authProvider.register(e,r,a)}async login(e,r){return await this.authProvider.login(e,r)}async loginWithGoogle(){return await this.authProvider.loginWithGoogle()}async logout(){return await this.authProvider.logout()}async resetPassword(e){return await this.authProvider.resetPassword(e)}async updateUserProfile(e){return await this.authProvider.updateUserProfile(e)}async changePassword(e){return await this.authProvider.changePassword(e)}async deleteAccount(){return await this.authProvider.deleteAccount()}getCurrentUser(){return this.authProvider.getCurrentUser()}async getCurrentUserData(){return await this.authProvider.getCurrentUserData()}onAuthStateChange(e){return this.authProvider.onAuthStateChange(e)}async sendVerificationEmail(){return await this.authProvider.sendVerificationEmail()}handleAuthError(e){return this.authProvider.handleAuthError?this.authProvider.handleAuthError(e):e}isAuthenticated(){return this.authProvider.isAuthenticated()}async getUserToken(){return await this.authProvider.getUserToken()}async testConnection(){return await this.authProvider.testConnection()}enableFirebaseAuth(){try{return this.authProvider=pa,this.useFirebase=!0,console.info("Switched to Firebase authentication service"),{success:!0,message:"Firebase authentication enabled"}}catch(e){return console.error("Failed to enable Firebase auth:",e),{success:!1,message:"Failed to enable Firebase authentication"}}}getCurrentProvider(){return this.useFirebase?"firebase":"mock"}}const je=new Lo,de={MAX_TOKENS:1e3,TEMPERATURE:.7,TOP_P:.95,TOP_K:64},Se={HOME:"/",PRODUCTS:"/products",CATEGORIES:"/categories",CART:"/cart",VISUAL_SEARCH:"/visual-search",RECOMMENDATIONS:"/recommendations",COMPLEMENTARY_PRODUCTS:"/complementary-products"},Pt={USER:"user",ASSISTANT:"assistant",SYSTEM:"system",ERROR:"error"},Ce={SUCCESS:"success",ERROR:"error",WARNING:"warning",INFO:"info"},ya={},Le={API_KEY_MISSING:"Gemini API key is required. Please set it in Settings.",GENERIC_ERROR:"An unexpected error occurred. Please try again.",INVALID_API_KEY:"Invalid API key. Please check your Gemini API key.",MODEL_NOT_AVAILABLE:"The selected model is not available."},K={STORE_NAME:"AI Powered Shop",CURRENCY:"TRY",CURRENCY_SYMBOL:"₺",ITEMS_PER_PAGE:12,MAX_CART_ITEMS:50,FREE_SHIPPING_THRESHOLD:500,TAX_RATE:.18},le={ELECTRONICS:"electronics",CLOTHING:"clothing",HOME_GARDEN:"home_garden",BOOKS:"books",SPORTS:"sports",BEAUTY:"beauty"};function zo(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function q(i,e=Le.GENERIC_ERROR){var r,a;return typeof i=="string"?i:i!=null&&i.message?i.message:(a=(r=i==null?void 0:i.response)==null?void 0:r.data)!=null&&a.message?i.response.data.message:e}function Uo(i){return new Promise(e=>setTimeout(e,i))}async function yt(i,e=3,r=1e3){let a;for(let s=0;s<=e;s++)try{return await i()}catch(n){if(a=n,s===e)throw a;await Uo(r*Math.pow(2,s))}}function Et(){const{state:i,dispatch:e,actionTypes:r}=ae(),[a,s]=p.useState(!1),[n,o]=p.useState(null),[l,c]=p.useState(!0);p.useEffect(()=>je.onAuthStateChange(y=>{e(y?{type:r.LOGIN,payload:{profile:{id:y.uid,email:y.email,displayName:y.displayName,firstName:y.firstName||"",lastName:y.lastName||"",phone:y.phone||"",photoURL:y.photoURL||"",emailVerified:y.emailVerified},preferences:y.preferences||{},addresses:y.addresses||[],orders:y.orders||[],wishlist:y.wishlist||[]}}:{type:r.LOGOUT}),c(!1)}),[]);const d=p.useCallback(async w=>{try{s(!0),o(null);const{email:y,password:P,...N}=w,S=await je.register(y,P,N);if(S.success)return S}catch(y){const P=q(y);throw o(P),new Error(P)}finally{s(!1)}},[]),u=p.useCallback(async(w,y)=>{try{s(!0),o(null);const P=await je.login(w,y);if(P.success)return P}catch(P){const N=q(P);throw o(N),new Error(N)}finally{s(!1)}},[]),h=p.useCallback(async()=>{try{s(!0),o(null);const w=await je.loginWithGoogle();if(w.success)return w}catch(w){const y=q(w);throw o(y),new Error(y)}finally{s(!1)}},[]),g=p.useCallback(async()=>{try{s(!0),o(null);const w=await je.logout();if(w.success)return w}catch(w){const y=q(w);throw o(y),new Error(y)}finally{s(!1)}},[]),x=p.useCallback(async w=>{try{return s(!0),o(null),await je.resetPassword(w)}catch(y){const P=q(y);throw o(P),new Error(P)}finally{s(!1)}},[]),k=p.useCallback(async w=>{try{s(!0),o(null);const y=await je.updateUserProfile(w);return y.success&&e({type:r.UPDATE_USER_PROFILE,payload:w}),y}catch(y){const P=q(y);throw o(P),new Error(P)}finally{s(!1)}},[e,r]),f=p.useCallback(async w=>{try{return s(!0),o(null),await je.changePassword(w)}catch(y){const P=q(y);throw o(P),new Error(P)}finally{s(!1)}},[]),E=p.useCallback(async()=>{try{s(!0),o(null);const w=await je.deleteAccount();return w.success,w}catch(w){const y=q(w);throw o(y),new Error(y)}finally{s(!1)}},[]),j=p.useCallback(async()=>{try{return s(!0),o(null),await je.sendVerificationEmail()}catch(w){const y=q(w);throw o(y),new Error(y)}finally{s(!1)}},[]),T=p.useCallback(async()=>{try{const w=await je.getCurrentUserData();w&&e({type:r.SET_USER,payload:{profile:{id:w.uid,email:w.email,displayName:w.displayName,firstName:w.firstName||"",lastName:w.lastName||"",phone:w.phone||"",photoURL:w.photoURL||"",emailVerified:w.emailVerified},preferences:w.preferences||{},addresses:w.addresses||[],orders:w.orders||[],wishlist:w.wishlist||[]}})}catch(w){console.error("Error refreshing user data:",w)}},[e,r]),D=p.useCallback(()=>{o(null)},[]),I=p.useCallback(async()=>{try{return await je.getUserToken()}catch(w){return console.error("Error getting user token:",w),null}},[]);p.useCallback(()=>{var w,y;return i.isAuthenticated&&((y=(w=i.user)==null?void 0:w.profile)==null?void 0:y.id)},[i.isAuthenticated,i.user]);const v=p.useCallback(()=>{var w,y;return((y=(w=i.user)==null?void 0:w.profile)==null?void 0:y.emailVerified)||!1},[i.user]);return{user:i.user,isAuthenticated:i.isAuthenticated,loading:a,error:n,initializing:l,register:d,login:u,loginWithGoogle:h,logout:g,resetPassword:x,updateProfile:k,changePassword:f,deleteAccount:E,sendVerificationEmail:j,refreshUserData:T,getUserToken:I,clearError:D,isEmailVerified:v,getCurrentUser:()=>i.user,getUserId:()=>{var w,y;return(y=(w=i.user)==null?void 0:w.profile)==null?void 0:y.id}}}class U{static async createUser(e,r){try{return await ut(re(F,this.COLLECTIONS.USERS,e),{...r,createdAt:te(),updatedAt:te()}),{success:!0}}catch(a){throw console.error("Error creating user:",a),a}}static async getUser(e){try{const r=await Pe(re(F,this.COLLECTIONS.USERS,e));return r.exists()?{id:r.id,...r.data()}:null}catch(r){throw console.error("Error getting user:",r),r}}static async updateUser(e,r){try{return await Re(re(F,this.COLLECTIONS.USERS,e),{...r,updatedAt:te()}),{success:!0}}catch(a){throw console.error("Error updating user:",a),a}}static async getProducts(e={}){try{console.log("FirebaseService: Getting products with SERVER-SIDE filters:",e);let r=Z(F,this.COLLECTIONS.PRODUCTS);if(e.category&&(r=J(r,H("category","==",e.category))),e.brand&&(r=J(r,H("brand","==",e.brand))),e.inStock&&(r=J(r,H("stock",">",0))),e.priceMin!==void 0&&e.priceMax!==void 0?r=J(r,H("price",">=",e.priceMin),H("price","<=",e.priceMax)):e.priceMin!==void 0?r=J(r,H("price",">=",e.priceMin)):e.priceMax!==void 0&&(r=J(r,H("price","<=",e.priceMax))),e.orderBy){const l=e.orderDirection==="desc"?"desc":"asc";r=J(r,Ge(e.orderBy,l))}else r=J(r,Ge("createdAt","desc"));e.limit&&(r=J(r,Ie(e.limit))),e.startAfter&&(r=J(r,kr(e.startAfter))),console.log("📊 Executing optimized Firebase query with server-side filtering");const a=await ne(r);let s=[];a.forEach(l=>{const c=l.data(),d={id:l.id,firebaseId:c.firebaseId,name:c.name,slug:c.slug,brand:c.brand,price:c.price,originalPrice:c.originalPrice,discount:c.discount,rating:c.rating,reviewCount:c.reviewCount,images:c.images||[],tags:c.tags||[],stock:c.stock,category:c.category,shortDescription:c.shortDescription,aiGenerated:c.aiGenerated,createdAt:c.createdAt,...e.includeFullData&&{...c}};s.push(d)}),console.log("🔥 Firebase returned optimized products:",s.length);const n=[],o=new Set;for(const l of s)l.firebaseId&&!o.has(l.firebaseId)?(o.add(l.firebaseId),n.push(l)):l.firebaseId||n.push(l);return s=n,console.log("✅ After deduplication:",s.length),console.log("FirebaseService: Filtered products:",s.length),s}catch(r){throw console.error("Error getting products:",r),r}}static async getProduct(e,r={}){try{const a=String(e);if(!a||a==="undefined"||a==="null")return console.warn("Invalid productId provided:",e),null;const s=await Pe(re(F,this.COLLECTIONS.PRODUCTS,a));if(s.exists()){const n=s.data();return r.minimal?{id:s.id,name:n.name,slug:n.slug,price:n.price,originalPrice:n.originalPrice,images:n.images||[],stock:n.stock}:r.includeFullData?{id:s.id,...n}:{id:s.id,firebaseId:n.firebaseId,name:n.name,slug:n.slug,brand:n.brand,price:n.price,originalPrice:n.originalPrice,discount:n.discount,rating:n.rating,reviewCount:n.reviewCount,images:n.images||[],tags:n.tags||[],stock:n.stock,category:n.category,shortDescription:n.shortDescription,aiGenerated:n.aiGenerated}}return null}catch(a){throw console.error("Error getting product:",a),a}}static async createProduct(e){try{return{id:(await ct(Z(F,this.COLLECTIONS.PRODUCTS),{...e,createdAt:te(),updatedAt:te()})).id,success:!0}}catch(r){throw console.error("Error creating product:",r),r}}static async trackUserBehavior(e,r){try{return e?(await ct(Z(F,this.COLLECTIONS.USER_BEHAVIOR),{userId:String(e),...r,timestamp:te()}),{success:!0}):(console.warn("Cannot track behavior: userId is undefined"),{success:!1,error:"User ID is required"})}catch(a){throw console.error("Error tracking user behavior:",a),a}}static async getUserBehavior(e,r=50){try{let a=J(Z(F,this.COLLECTIONS.USER_BEHAVIOR),H("userId","==",e),Ie(r));const s=await ne(a),n=[];return s.forEach(o=>{n.push({id:o.id,...o.data()})}),n}catch(a){throw console.error("Error getting user behavior:",a),a}}static async saveSearchQuery(e,r,a){try{return await ct(Z(F,this.COLLECTIONS.SEARCH_HISTORY),{userId:e,query:r,resultsCount:a.length,timestamp:te()}),{success:!0}}catch(s){throw console.error("Error saving search query:",s),s}}static async getSearchHistory(e,r=20){try{const a=J(Z(F,this.COLLECTIONS.SEARCH_HISTORY),H("userId","==",e),Ie(r)),s=await ne(a),n=[];return s.forEach(o=>{n.push({id:o.id,...o.data()})}),n}catch(a){throw console.error("Error getting search history:",a),a}}static async addToCart(e,r,a=1){try{const s=re(F,this.COLLECTIONS.CART,`${e}_${r}`);return(await Pe(s)).exists()?await Re(s,{quantity:Ti(a),updatedAt:te()}):await ut(s,{userId:e,productId:r,quantity:a,createdAt:te(),updatedAt:te()}),{success:!0}}catch(s){throw console.error("Error adding to cart:",s),s}}static async getCartItems(e){try{const r=J(Z(F,this.COLLECTIONS.CART),H("userId","==",e)),a=await ne(r),s=[];return a.forEach(n=>{s.push({id:n.id,...n.data()})}),s}catch(r){throw console.error("Error getting cart items:",r),r}}static async removeFromCart(e,r){try{return await $a(re(F,this.COLLECTIONS.CART,`${e}_${r}`)),{success:!0}}catch(a){throw console.error("Error removing from cart:",a),a}}static async saveRecommendations(e,r,a="gemini"){try{return await ut(re(F,this.COLLECTIONS.RECOMMENDATIONS,e),{userId:e,recommendations:r,source:a,createdAt:te(),expiresAt:new Date(Date.now()+24*60*60*1e3)}),{success:!0}}catch(s){throw console.error("Error saving recommendations:",s),s}}static async getRecommendations(e){try{const r=await Pe(re(F,this.COLLECTIONS.RECOMMENDATIONS,e));if(r.exists()){const a=r.data();if(a.expiresAt&&a.expiresAt.toDate()>new Date)return a.recommendations}return null}catch(r){throw console.error("Error getting recommendations:",r),r}}static async createOrder(e){try{return{id:(await ct(Z(F,this.COLLECTIONS.ORDERS),{...e,createdAt:te(),updatedAt:te(),status:"pending"})).id,success:!0}}catch(r){throw console.error("Error creating order:",r),r}}static async getUserOrders(e){try{const r=J(Z(F,this.COLLECTIONS.ORDERS),H("userId","==",e),Ge("createdAt","desc")),a=await ne(r),s=[];return a.forEach(n=>{s.push({id:n.id,...n.data()})}),s}catch(r){throw console.error("Error getting user orders:",r),r}}static subscribeToUserCart(e,r){const a=J(Z(F,this.COLLECTIONS.CART),H("userId","==",e));return wr(a,s=>{const n=[];s.forEach(o=>{n.push({id:o.id,...o.data()})}),r(n)})}static subscribeToProducts(e,r={}){let a=Z(F,this.COLLECTIONS.PRODUCTS);return r.category&&(a=J(a,H("category","==",r.category))),wr(a,s=>{const n=[];s.forEach(o=>{n.push({id:o.id,...o.data()})}),e(n)})}static async batchUpdateProducts(e){try{const r=Ii(F);return e.forEach(({id:a,data:s})=>{const n=re(F,this.COLLECTIONS.PRODUCTS,a);r.update(n,{...s,updatedAt:te()})}),await r.commit(),{success:!0}}catch(r){throw console.error("Error batch updating products:",r),r}}static async checkConnection(){try{const e=J(Z(F,this.COLLECTIONS.PRODUCTS),Ie(1)),r=await ne(e);return console.log("Firebase connection test result:",r.size,"documents found"),{success:!0,message:"Firebase connection successful"}}catch(e){return console.error("Firebase connection failed:",e),{success:!1,message:e.message}}}}$e(U,"COLLECTIONS",{USERS:"users",PRODUCTS:"products",ORDERS:"orders",CART:"cart",REVIEWS:"reviews",CATEGORIES:"categories",USER_BEHAVIOR:"userBehavior",RECOMMENDATIONS:"recommendations",SEARCH_HISTORY:"searchHistory"});const _e=[{id:1,name:"iPhone 15 Pro Max",slug:"iphone-15-pro-max",price:52999,originalPrice:55999,discount:5,category:le.ELECTRONICS,subcategory:"smartphones",brand:"Apple",rating:4.8,reviewCount:1247,stock:15,images:["https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=500","https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=500","https://images.unsplash.com/photo-1585060544812-6b45742d762f?w=500"],description:"AI-enhanced smartphone with advanced camera system",shortDescription:"Latest iPhone with Pro camera system and A17 Pro chip",features:["A17 Pro chip with 6-core GPU","Pro camera system with 5x Telephoto","Action Button","USB-C connector","Up to 29 hours video playback"],specifications:{Display:"6.7-inch Super Retina XDR",Chip:"A17 Pro",Camera:"48MP Main, 12MP Ultra Wide, 12MP Telephoto",Storage:"256GB",Battery:"Up to 29 hours video playback","Operating System":"iOS 17"},variants:[{id:"color",name:"Renk",options:["Doğal Titanyum","Mavi Titanyum","Beyaz Titanyum","Siyah Titanyum"]},{id:"storage",name:"Depolama",options:["256GB","512GB","1TB"]}],tags:["yeni","popüler","premium","ai-powered"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:2,name:"MacBook Air M3",slug:"macbook-air-m3",price:42999,originalPrice:45999,discount:7,category:le.ELECTRONICS,subcategory:"laptops",brand:"Apple",rating:4.9,reviewCount:892,stock:8,images:["https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=500","https://images.unsplash.com/photo-1484788984921-03950022c9ef?w=500","https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=500"],description:"Ultra-thin laptop with M3 chip and exceptional battery life",shortDescription:"Lightweight laptop with M3 chip and all-day battery",features:["Apple M3 chip with 8-core CPU","13.6-inch Liquid Retina display","Up to 18 hours battery life","MagSafe 3 charging","Two Thunderbolt ports"],specifications:{Display:"13.6-inch Liquid Retina",Chip:"Apple M3",Memory:"8GB unified memory",Storage:"256GB SSD",Battery:"Up to 18 hours",Weight:"1.24 kg"},variants:[{id:"color",name:"Renk",options:["Gece Yarısı","Yıldız Işığı","Gümüş","Uzay Grisi"]},{id:"memory",name:"Bellek",options:["8GB","16GB","24GB"]},{id:"storage",name:"Depolama",options:["256GB","512GB","1TB","2TB"]}],tags:["yeni","hafif","güçlü","uzun-batarya"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:3,name:"Nike Air Force 1",slug:"nike-air-force-1",price:3499,originalPrice:3999,discount:13,category:le.CLOTHING,subcategory:"shoes",brand:"Nike",rating:4.6,reviewCount:2156,stock:25,images:["https://images.unsplash.com/photo-1549298916-b41d501d3772?w=500","https://images.unsplash.com/photo-1600185365483-26d7a4cc7519?w=500","https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?w=500"],description:"Iconic basketball shoe with timeless design and superior comfort",shortDescription:"Classic basketball sneaker with leather upper and Air cushioning",features:["Full-grain leather upper","Nike Air cushioning","Rubber sole with pivot points","Perforated toe box","Classic basketball style"],specifications:{Upper:"Full-grain leather",Sole:"Rubber with Air cushioning",Closure:"Lace-up",Style:"Low-top",Origin:"Basketball"},variants:[{id:"color",name:"Renk",options:["Beyaz","Siyah","Kırmızı","Mavi"]},{id:"size",name:"Numara",options:["38","39","40","41","42","43","44","45"]}],tags:["klasik","rahat","basketbol","günlük"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:4,name:"Sony WH-1000XM5",slug:"sony-wh-1000xm5",price:9999,originalPrice:11999,discount:17,category:le.ELECTRONICS,subcategory:"audio",brand:"Sony",rating:4.7,reviewCount:756,stock:12,images:["https://images.unsplash.com/photo-1484704849700-f032a568e944?w=500","https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=500","https://images.unsplash.com/photo-1593642632823-8f785ba67e45?w=500"],description:"Premium noise-canceling headphones with exceptional sound quality",shortDescription:"Wireless noise-canceling headphones with 30-hour battery",features:["Industry-leading noise canceling","30-hour battery life","Quick Charge (3 min = 3 hours)","Touch sensor controls","Multipoint connection"],specifications:{Driver:"30mm","Frequency Response":"4Hz-40,000Hz",Battery:"Up to 30 hours",Charging:"USB-C",Weight:"250g"},variants:[{id:"color",name:"Renk",options:["Siyah","Gümüş"]}],tags:["premium","noise-canceling","wireless","uzun-batarya"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:5,name:"Philips Hue Smart Bulb",slug:"philips-hue-smart-bulb",price:299,originalPrice:349,discount:14,category:le.HOME_GARDEN,subcategory:"lighting",brand:"Philips",rating:4.5,reviewCount:1834,stock:50,images:["https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=500","https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=500","https://images.unsplash.com/photo-1513506003901-1e6a229e2d15?w=500"],description:"Smart LED bulb with 16 million colors and voice control",shortDescription:"Wi-Fi enabled smart bulb with color changing capabilities",features:["16 million colors","Voice control compatible","App-controlled","Energy efficient LED","Schedule and automation"],specifications:{Wattage:"9W (60W equivalent)",Brightness:"800 lumens","Color Temperature":"2000K-6500K",Connectivity:"Wi-Fi",Lifespan:"25,000 hours"},variants:[{id:"type",name:"Tip",options:["E27","E14","GU10"]}],tags:["akıllı","renkli","ses-kontrol","enerji-tasarruflu"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:6,name:"The Art of War",slug:"the-art-of-war",price:49,originalPrice:59,discount:17,category:le.BOOKS,subcategory:"philosophy",brand:"Penguin Classics",rating:4.4,reviewCount:3247,stock:100,images:["https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=500","https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=500","https://images.unsplash.com/photo-1519904981063-b0cf448d479e?w=500"],description:"Ancient Chinese military treatise on strategy and tactics",shortDescription:"Classic strategy guide with timeless wisdom for modern applications",features:["Complete original text","Modern translation","Historical context","Study guide included","Paperback edition"],specifications:{Pages:"256",Language:"Turkish",Publisher:"Penguin Classics",ISBN:"978-0140439991",Format:"Paperback"},variants:[{id:"format",name:"Format",options:["Paperback","Hardcover","E-book"]}],tags:["klasik","strateji","felsefe","tarih"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:17,firebaseId:"17",name:"Samsung Galaxy Buds 3",slug:"samsung-galaxy-buds-3",price:2499,originalPrice:2999,discount:17,currency:"TRY",stock:45,category:"electronics",subCategory:"audio",brand:"Samsung",images:["https://images.unsplash.com/photo-1590658268037-6bf12165a8df?w=500"],rating:4.4,reviewCount:89,description:"Premium kablosuz kulaklık deneyimi",shortDescription:"Aktif gürültü engelleme ve üstün ses kalitesi",features:["ANC","Kablosuz şarj","6 saat pil ömrü"],tags:["kulaklık","samsung","kablosuz"],aiGenerated:{description:!0,tags:!0}},{id:18,firebaseId:"18",name:"Dell XPS 15",slug:"dell-xps-15",price:45999,originalPrice:49999,discount:8,currency:"TRY",stock:12,category:"electronics",subCategory:"laptops",brand:"Dell",images:["https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=500"],rating:4.7,reviewCount:156,description:"Profesyonel performans laptopları",shortDescription:"Intel i7, 16GB RAM, 512GB SSD",features:["Intel i7","16GB RAM","512GB SSD",'15.6" 4K Display'],tags:["laptop","dell","profesyonel"],aiGenerated:{description:!0,tags:!0}},{id:19,firebaseId:"19",name:"Sony WH-1000XM5",slug:"sony-wh-1000xm5",price:8999,originalPrice:9999,discount:10,currency:"TRY",stock:28,category:"electronics",subCategory:"audio",brand:"Sony",images:["https://images.unsplash.com/photo-1583394838336-acd977736f90?w=500"],rating:4.8,reviewCount:203,description:"Dünya standartında gürültü engelleme",shortDescription:"Premium over-ear kulaklık",features:["Aktif gürültü engelleme","30 saat pil","Hızlı şarj"],tags:["kulaklık","sony","premium"],aiGenerated:{description:!0,tags:!0}},{id:20,firebaseId:"20",name:'LG OLED C3 55"',slug:"lg-oled-c3-55",price:34999,originalPrice:39999,discount:13,currency:"TRY",stock:8,category:"electronics",subCategory:"tv",brand:"LG",images:["https://images.unsplash.com/photo-1593359677879-a4bb92f829d1?w=500"],rating:4.9,reviewCount:67,description:"OLED teknolojisi ile mükemmel görüntü",shortDescription:'55" 4K OLED Smart TV',features:["4K OLED","webOS","Dolby Vision","Gaming Mode"],tags:["tv","lg","oled","4k"],aiGenerated:{description:!0,tags:!0}},{id:21,firebaseId:"21",name:"Dyson V15 Detect",slug:"dyson-v15-detect",price:15999,originalPrice:17999,discount:11,currency:"TRY",stock:22,category:"home",subCategory:"cleaning",brand:"Dyson",images:["https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=500"],rating:4.6,reviewCount:134,description:"Kablosuz süpürge teknolojisinin zirvesi",shortDescription:"Laser toz algılama özelliği",features:["Laser algılama","60 dk pil","HEPA filtre"],tags:["süpürge","dyson","kablosuz"],aiGenerated:{description:!0,tags:!0}},{id:22,firebaseId:"22",name:"Bose QuietComfort 45",slug:"bose-quietcomfort-45",price:7499,originalPrice:8499,discount:12,currency:"TRY",stock:35,category:"electronics",subCategory:"audio",brand:"Bose",images:["https://images.unsplash.com/photo-1484704849700-f032a568e944?w=500"],rating:4.5,reviewCount:178,description:"Sessizliğin tadını çıkarın",shortDescription:"Aktif gürültü engelleme kulaklık",features:["ANC","24 saat pil","Konforlu tasarım"],tags:["kulaklık","bose","anc"],aiGenerated:{description:!0,tags:!0}},{id:23,firebaseId:"23",name:"Nintendo Switch OLED",slug:"nintendo-switch-oled",price:8999,originalPrice:9999,discount:10,currency:"TRY",stock:18,category:"electronics",subCategory:"gaming",brand:"Nintendo",images:["https://images.unsplash.com/photo-1606144042614-b2417e99c4e3?w=500"],rating:4.7,reviewCount:245,description:"Oyun dünyasına adım atın",shortDescription:'7" OLED ekranlı oyun konsolu',features:['7" OLED ekran',"Dock modlu","Joy-Con kontrolcü"],tags:["oyun","nintendo switch","konsol"],aiGenerated:{description:!0,tags:!0}},{id:24,firebaseId:"24",name:"Philips Hue Starter Kit",slug:"philips-hue-starter-kit",price:3499,originalPrice:3999,discount:13,currency:"TRY",stock:41,category:"home",subCategory:"lighting",brand:"Philips",images:["https://images.unsplash.com/photo-1558002038-bb4237b54485?w=500"],rating:4.4,reviewCount:89,description:"Akıllı aydınlatma sistemi",shortDescription:"Renkli LED ampul seti",features:["16 milyon renk","Uygulama kontrolü","3lü set"],tags:["akıllı ev","philips","led"],aiGenerated:{description:!0,tags:!0}},{id:25,firebaseId:"25",name:"Levi's 501 Original Jeans",slug:"levis-501-original-jeans",price:899,originalPrice:1199,discount:25,category:le.CLOTHING,subcategory:"pants",brand:"Levi's",rating:4.7,reviewCount:1456,stock:35,images:["https://images.unsplash.com/photo-1541099649105-f69ad21f3246?w=500","https://images.unsplash.com/photo-1542272604-787c3835535d?w=500"],description:"Klasik kesim orijinal jean pantolon",shortDescription:"İkonik 501 modeli orijinal kesim",features:["100% pamuk","Straight fit","Button fly","Klasik 5 cep"],tags:["jean","klasik","günlük"],aiGenerated:{description:!0,tags:!0}},{id:26,firebaseId:"26",name:"Adidas Ultraboost 22",slug:"adidas-ultraboost-22",price:2299,originalPrice:2799,discount:18,category:le.CLOTHING,subcategory:"shoes",brand:"Adidas",rating:4.8,reviewCount:892,stock:28,images:["https://images.unsplash.com/photo-1539185441755-769473a23570?w=500","https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=500"],description:"Yüksek performanslı koşu ayakkabısı",shortDescription:"Boost teknolojili performans ayakkabı",features:["Boost orta taban","Primeknit üst","Continental kauçuk taban","Responsive cushioning"],tags:["spor","koşu","adidas"],aiGenerated:{description:!0,tags:!0}},{id:27,firebaseId:"27",name:"Zara Basic T-Shirt",slug:"zara-basic-tshirt",price:149,originalPrice:199,discount:25,category:le.CLOTHING,subcategory:"shirts",brand:"Zara",rating:4.3,reviewCount:567,stock:85,images:["https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=500","https://images.unsplash.com/photo-1503341504253-dff4815485f1?w=500"],description:"Günlük kullanım için temel t-shirt",shortDescription:"Pamuklu basic t-shirt",features:["100% pamuk","Regular fit","Yuvarlak yaka","Çok renkli seçenek"],tags:["basic","günlük","pamuk"],aiGenerated:{description:!0,tags:!0}},{id:28,firebaseId:"28",name:"H&M Denim Jacket",slug:"hm-denim-jacket",price:399,originalPrice:499,discount:20,category:le.CLOTHING,subcategory:"jackets",brand:"H&M",rating:4.4,reviewCount:234,stock:22,images:["https://images.unsplash.com/photo-1551028719-00167b16eac5?w=500","https://images.unsplash.com/photo-1590736969955-71cc94901144?w=500"],description:"Klasik kot ceket",shortDescription:"Vintage tarzı denim ceket",features:["Denim kumaş","Metal düğmeler","Chest pockets","Regular fit"],tags:["kot","ceket","vintage"],aiGenerated:{description:!0,tags:!0}},{id:29,firebaseId:"29",name:"Mango Dress",slug:"mango-dress",price:599,originalPrice:799,discount:25,category:le.CLOTHING,subcategory:"dresses",brand:"Mango",rating:4.6,reviewCount:345,stock:18,images:["https://images.unsplash.com/photo-1572804013309-59a88b7e92f1?w=500","https://images.unsplash.com/photo-1583496661160-fb5886a13d36?w=500"],description:"Şık günlük elbise",shortDescription:"Midi boy günlük elbise",features:["Midi boy","A kesim","Desenli kumaş","Kısa kollu"],tags:["elbise","şık","günlük"],aiGenerated:{description:!0,tags:!0}},{id:30,firebaseId:"30",name:"Nike Hoodie",slug:"nike-hoodie",price:799,originalPrice:999,discount:20,category:le.CLOTHING,subcategory:"hoodies",brand:"Nike",rating:4.5,reviewCount:678,stock:42,images:["https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=500","https://images.unsplash.com/photo-1556821840-3a63f95609a7?w=500"],description:"Spor kapüşonlu sweatshirt",shortDescription:"Nike swoosh logolu hoodie",features:["Kapüşonlu","Pamuk karışım","Nike logosu","Kanguru cep"],tags:["hoodie","spor","nike"],aiGenerated:{description:!0,tags:!0}}],ps={[le.ELECTRONICS]:{name:"Elektronik",description:"En yeni teknoloji ürünleri",icon:"📱",subcategories:["smartphones","laptops","tablets","audio","gaming","accessories"]},[le.CLOTHING]:{name:"Giyim",description:"Moda ve stil ürünleri",icon:"👕",subcategories:["shirts","pants","shoes","accessories","bags","jewelry"]},[le.HOME_GARDEN]:{name:"Ev & Bahçe",description:"Ev dekorasyonu ve bahçe ürünleri",icon:"🏠",subcategories:["furniture","lighting","decor","kitchen","garden","tools"]},[le.BOOKS]:{name:"Kitaplar",description:"Bilgi ve eğlence kaynakları",icon:"📚",subcategories:["fiction","non-fiction","textbooks","children","philosophy","science"]},[le.SPORTS]:{name:"Spor",description:"Spor ve fitness ürünleri",icon:"⚽",subcategories:["fitness","outdoor","team-sports","water-sports","winter-sports"]},[le.BEAUTY]:{name:"Güzellik",description:"Kozmetik ve kişisel bakım",icon:"💄",subcategories:["skincare","makeup","hair-care","fragrance","tools"]}},Lr=i=>_e.find(e=>e.id===parseInt(i)),ys=i=>_e.find(e=>e.slug===i),xs=i=>_e.filter(e=>e.category===i),fs=(i=6)=>_e.filter(e=>e.tags.includes("popüler")||e.rating>=4.5).slice(0,i),bs=(i=6)=>_e.filter(e=>e.discount>0).sort((e,r)=>r.discount-e.discount).slice(0,i),$t=i=>{const e=i.toLowerCase();return _e.filter(r=>r.name.toLowerCase().includes(e)||r.description.toLowerCase().includes(e)||r.brand.toLowerCase().includes(e)||r.tags.some(a=>a.toLowerCase().includes(e)))},Dt=(i,e=4)=>{const r=Lr(i);return r?_e.filter(a=>a.id!==i&&(a.category===r.category||a.brand===r.brand||a.tags.some(s=>r.tags.includes(s)))).slice(0,e):[]},Fo=()=>_e,He=Object.freeze(Object.defineProperty({__proto__:null,PRODUCT_CATEGORY_DATA:ps,SAMPLE_PRODUCTS:_e,getAllProducts:Fo,getDiscountedProducts:bs,getFeaturedProducts:fs,getProductById:Lr,getProductBySlug:ys,getProductsByCategory:xs,getRelatedProducts:Dt,searchProducts:$t},Symbol.toStringTag,{value:"Module"}));class we{static async initializeProducts(){try{console.log("Starting product initialization in Firebase...");const e=await U.getProducts();return console.log(`Found ${e.length} existing products in Firebase`),e.length===0&&await this.migrateProductsToFirebase(),await this.addAdditionalProducts(),console.log("Product initialization completed successfully"),{success:!0}}catch(e){throw console.error("Error initializing products:",e),e}}static async migrateProductsToFirebase(){try{console.log("Migrating sample products to Firebase...");for(const e of _e){const r={...e,firebaseId:e.id.toString(),createdAt:new Date,updatedAt:new Date};await U.createProduct(r),console.log(`Migrated product: ${e.name}`)}console.log("Sample products migration completed")}catch(e){throw console.error("Error migrating products:",e),e}}static async addAdditionalProducts(){try{console.log("Adding additional products...");const e=[{id:7,name:"Samsung Galaxy S24 Ultra",slug:"samsung-galaxy-s24-ultra",price:48999,originalPrice:51999,discount:6,category:"electronics",subcategory:"smartphones",brand:"Samsung",rating:4.7,reviewCount:892,stock:20,images:["https://picsum.photos/500/500?random=100","https://picsum.photos/500/500?random=101","https://picsum.photos/500/500?random=102"],description:"Flagship Android smartphone with S Pen and advanced camera system",shortDescription:"Premium Android phone with built-in S Pen stylus",features:["S Pen integrated stylus","200MP main camera","6.8-inch Dynamic AMOLED display","Snapdragon 8 Gen 3 processor","5000mAh battery"],specifications:{Display:"6.8-inch Dynamic AMOLED 2X",Processor:"Snapdragon 8 Gen 3",Camera:"200MP Main, 50MP Periscope Telephoto",Storage:"256GB",Battery:"5000mAh","Operating System":"Android 14"},variants:[{id:"color",name:"Renk",options:["Phantom Black","Phantom Silver","Phantom Violet"]},{id:"storage",name:"Depolama",options:["256GB","512GB","1TB"]}],tags:["yeni","android","s-pen","premium"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:8,name:"Dell XPS 13",slug:"dell-xps-13",price:38999,originalPrice:41999,discount:7,category:"electronics",subcategory:"laptops",brand:"Dell",rating:4.6,reviewCount:654,stock:15,images:["https://picsum.photos/500/500?random=103","https://picsum.photos/500/500?random=104","https://picsum.photos/500/500?random=105"],description:"Premium ultrabook with InfinityEdge display and long battery life",shortDescription:"Compact laptop with virtually borderless display",features:["13.4-inch InfinityEdge display","Intel Core i7-1355U processor","16GB LPDDR5 RAM","Up to 12 hours battery life","Compact and lightweight design"],specifications:{Display:"13.4-inch FHD+ InfinityEdge",Processor:"Intel Core i7-1355U",Memory:"16GB LPDDR5",Storage:"512GB SSD",Battery:"Up to 12 hours",Weight:"1.2 kg"},variants:[{id:"color",name:"Renk",options:["Platinum Silver","Graphite"]},{id:"memory",name:"Bellek",options:["16GB","32GB"]},{id:"storage",name:"Depolama",options:["512GB","1TB"]}],tags:["ultrabook","compact","premium","business"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:9,name:"Adidas Ultraboost 22",slug:"adidas-ultraboost-22",price:4999,originalPrice:5999,discount:17,category:"clothing",subcategory:"shoes",brand:"Adidas",rating:4.5,reviewCount:1523,stock:35,images:["https://picsum.photos/500/500?random=106","https://picsum.photos/500/500?random=107","https://picsum.photos/500/500?random=108"],description:"High-performance running shoe with responsive Boost cushioning",shortDescription:"Energy-returning running shoe with Primeknit upper",features:["Boost midsole technology","Primeknit upper","Continental Rubber outsole","Sock-like fit","Energy return with every step"],specifications:{Upper:"Primeknit textile",Midsole:"Boost foam",Outsole:"Continental Rubber",Drop:"10mm",Weight:"310g (size 9)"},variants:[{id:"color",name:"Renk",options:["Core Black","Cloud White","Solar Red","Navy Blue"]},{id:"size",name:"Numara",options:["38","39","40","41","42","43","44","45","46"]}],tags:["koşu","spor","boost","rahat"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:10,name:"Bose QuietComfort Earbuds",slug:"bose-quietcomfort-earbuds",price:7999,originalPrice:8999,discount:11,category:"electronics",subcategory:"audio",brand:"Bose",rating:4.4,reviewCount:467,stock:25,images:["https://picsum.photos/500/500?random=109","https://picsum.photos/500/500?random=110","https://picsum.photos/500/500?random=111"],description:"True wireless earbuds with world-class noise cancellation",shortDescription:"Premium wireless earbuds with excellent noise cancellation",features:["Active noise cancellation","6 hours battery + 12 hours with case","Weather and sweat resistant","Touch controls","Quick 15-minute charge = 2 hours"],specifications:{Driver:"Full-range",Connectivity:"Bluetooth 5.1",Battery:"6 + 12 hours",Charging:"USB-C","Water Resistance":"IPX4"},variants:[{id:"color",name:"Renk",options:["Triple Black","Soapstone","Glacier White"]}],tags:["wireless","noise-canceling","premium","spor"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:11,name:"IKEA BILLY Bookcase",slug:"ikea-billy-bookcase",price:899,originalPrice:999,discount:10,category:"home_garden",subcategory:"furniture",brand:"IKEA",rating:4.3,reviewCount:2847,stock:50,images:["https://picsum.photos/500/500?random=112","https://picsum.photos/500/500?random=113","https://picsum.photos/500/500?random=114"],description:"Classic bookcase with adjustable shelves for flexible storage",shortDescription:"Versatile bookcase with adjustable shelves",features:["Adjustable shelves","Easy to assemble","Surface treated with wood stain","Can be extended with height extension unit","Classic design fits any room"],specifications:{Width:"80 cm",Depth:"28 cm",Height:"202 cm",Material:"Particleboard, Paper foil","Adjustable shelves":"4 pieces"},variants:[{id:"color",name:"Renk",options:["White","Brown ash veneer","Black-brown"]},{id:"size",name:"Boyut",options:["80x28x202 cm","40x28x202 cm"]}],tags:["kitaplık","depolama","klasik","uygun-fiyat"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:12,name:"Dune: Complete Series",slug:"dune-complete-series",price:149,originalPrice:199,discount:25,category:"books",subcategory:"fiction",brand:"Ace Books",rating:4.6,reviewCount:1876,stock:75,images:["https://picsum.photos/500/500?random=115","https://picsum.photos/500/500?random=116","https://picsum.photos/500/500?random=117"],description:"Epic science fiction saga set in a distant future universe",shortDescription:"Complete collection of Frank Herbert's legendary sci-fi series",features:["All 6 original novels","Premium box set edition","Author introduction","Maps and appendices","Collector's edition"],specifications:{Books:"6 novels",Pages:"3000+ total",Language:"Turkish",Publisher:"Ace Books",Format:"Paperback box set"},variants:[{id:"format",name:"Format",options:["Paperback Box Set","Hardcover Box Set","E-book Collection"]}],tags:["sci-fi","klasik","epic","koleksiyon"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:13,name:"Wilson Pro Staff Tennis Racket",slug:"wilson-pro-staff-tennis-racket",price:2499,originalPrice:2999,discount:17,category:"sports",subcategory:"tennis",brand:"Wilson",rating:4.7,reviewCount:543,stock:18,images:["https://picsum.photos/500/500?random=118","https://picsum.photos/500/500?random=119","https://picsum.photos/500/500?random=120"],description:"Professional tennis racket with precision control and power",shortDescription:"Pro-level tennis racket for advanced players",features:["Graphite construction","100 sq inch head size","Precision control","Professional grip size","Tour-level performance"],specifications:{"Head Size":"100 sq in",Weight:"315g unstrung","String Pattern":"16x19","Grip Size":"4 1/4",Material:"Graphite"},variants:[{id:"grip",name:"Grip Boyutu",options:["4 1/8","4 1/4","4 3/8","4 1/2"]},{id:"string",name:"Germe",options:["Gerdirili","Gerdiriesiz"]}],tags:["tenis","professional","graphite","kontrol"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:14,name:"Clinique Dramatically Different Moisturizing Lotion",slug:"clinique-dramatically-different-moisturizing-lotion",price:899,originalPrice:1099,discount:18,category:"beauty",subcategory:"skincare",brand:"Clinique",rating:4.4,reviewCount:2156,stock:60,images:["https://picsum.photos/500/500?random=121","https://picsum.photos/500/500?random=122","https://picsum.photos/500/500?random=123"],description:"Lightweight, oil-free moisturizer for balanced skin hydration",shortDescription:"Daily moisturizer suitable for all skin types",features:["Oil-free formula","All skin types","Lightweight texture","Quick absorption","Dermatologist tested"],specifications:{Volume:"125ml",Type:"Lotion","Skin Type":"All skin types",Formula:"Oil-free",Usage:"Daily moisturizer"},variants:[{id:"size",name:"Boyut",options:["50ml","125ml","200ml"]},{id:"type",name:"Tip",options:["Lotion","Gel","Cream"]}],tags:["moisturizer","oil-free","daily-care","all-skin-types"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:15,name:"H&M Oversized Hoodie",slug:"hm-oversized-hoodie",price:399,originalPrice:499,discount:20,category:"clothing",subcategory:"hoodies",brand:"H&M",rating:4.2,reviewCount:834,stock:45,images:["https://picsum.photos/500/500?random=124","https://picsum.photos/500/500?random=125","https://picsum.photos/500/500?random=126"],description:"Rahat kesimli kapüşonlu sweatshirt, günlük kullanım için ideal",shortDescription:"Oversized kesimli pamuklu hoodie",features:["100% pamuk kumaş","Oversized kesim","Kanguru cep","Ayarlanabilir kapüşon","Yumuşak iç astar"],specifications:{Kumaş:"100% Pamuk",Kesim:"Oversized",Yaka:"Kapüşonlu",Kol:"Uzun kol",Bakım:"Makine yıkama 30°C"},variants:[{id:"color",name:"Renk",options:["Siyah","Beyaz","Gri","Lacivert","Bordo"]},{id:"size",name:"Beden",options:["XS","S","M","L","XL","XXL"]}],tags:["hoodie","casual","pamuk","rahat","günlük"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:16,name:"Levi's 501 Original Jeans",slug:"levis-501-original-jeans",price:1299,originalPrice:1599,discount:19,category:"clothing",subcategory:"jeans",brand:"Levi's",rating:4.6,reviewCount:2156,stock:30,images:["https://picsum.photos/500/500?random=127","https://picsum.photos/500/500?random=128","https://picsum.photos/500/500?random=129"],description:"Klasik straight fit jean, zamansız tarz ve dayanıklılık",shortDescription:"Orijinal straight fit denim pantolon",features:["Straight fit kesim","100% pamuk denim","Klasik 5 cep","Düğme fly","Shrink-to-fit denim"],specifications:{Kumaş:"100% Pamuk Denim",Kesim:"Straight Fit",Yükselti:"Normal bel",Kapama:"Düğme fly",Bakım:"Soğuk yıkama, ters çevir"},variants:[{id:"color",name:"Renk",options:["Stonewash","Dark Blue","Black","Light Blue"]},{id:"size",name:"Beden",options:["28","30","32","34","36","38","40"]}],tags:["jeans","klasik","denim","straight-fit","pamuk"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:17,name:"Zara Basic T-Shirt",slug:"zara-basic-t-shirt",price:149,originalPrice:199,discount:25,category:"clothing",subcategory:"tshirts",brand:"Zara",rating:4.1,reviewCount:967,stock:80,images:["https://picsum.photos/500/500?random=130","https://picsum.photos/500/500?random=131","https://picsum.photos/500/500?random=132"],description:"Günlük kullanım için basic pamuklu tişört, her gardırobun vazgeçilmezi",shortDescription:"Basic pamuklu t-shirt, çok renkli seçenekler",features:["100% pamuk","Slim fit kesim","Yuvarlak yaka","Kısa kollu","Çok renkli seçenekler"],specifications:{Kumaş:"100% Pamuk",Kesim:"Slim Fit",Yaka:"Yuvarlak",Kol:"Kısa kol",Bakım:"Makine yıkama 40°C"},variants:[{id:"color",name:"Renk",options:["Beyaz","Siyah","Gri","Lacivert","Kırmızı","Yeşil","Sarı","Pembe"]},{id:"size",name:"Beden",options:["XS","S","M","L","XL"]}],tags:["basic","tişört","pamuk","günlük","çok-renkli"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:18,name:"Nike Air Force 1",slug:"nike-air-force-1",price:3999,originalPrice:4499,discount:11,category:"clothing",subcategory:"shoes",brand:"Nike",rating:4.7,reviewCount:3421,stock:25,images:["https://picsum.photos/500/500?random=133","https://picsum.photos/500/500?random=134","https://picsum.photos/500/500?random=135"],description:"İkonik basketbol ayakkabısı, sokak modasının vazgeçilmezi",shortDescription:"Klasik beyaz sneaker, zamansız tasarım",features:["Deri üst malzeme","Air-Sole unit yastıklama","Dayanıklı kauçuk taban","Klasik tasarım","Her stile uygun"],specifications:{"Üst Malzeme":"Gerçek deri",Taban:"Kauçuk",Yastıklama:"Air-Sole",Kapama:"Bağcıklı",Stil:"Low-top"},variants:[{id:"color",name:"Renk",options:["Triple White","Triple Black","White/Black","White/Red"]},{id:"size",name:"Numara",options:["36","37","38","39","40","41","42","43","44","45"]}],tags:["sneaker","klasik","beyaz","nike","basketbol"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:19,name:"Mango Blazer Ceket",slug:"mango-blazer-ceket",price:799,originalPrice:999,discount:20,category:"clothing",subcategory:"blazers",brand:"Mango",rating:4.3,reviewCount:456,stock:22,images:["https://picsum.photos/500/500?random=136","https://picsum.photos/500/500?random=137","https://picsum.photos/500/500?random=138"],description:"Şık blazer ceket, iş ve günlük kullanım için mükemmel",shortDescription:"Klasik kesim blazer, çok amaçlı kullanım",features:["Tailored kesim","Tek düğme kapama","Lined iç astar","Shoulder pads","İş ve casual uyum"],specifications:{Kumaş:"Polyester Blend",Kesim:"Tailored",Kapama:"Tek düğme",Astar:"Polyester",Bakım:"Kuru temizleme"},variants:[{id:"color",name:"Renk",options:["Siyah","Lacivert","Kahverengi","Gri"]},{id:"size",name:"Beden",options:["XS","S","M","L","XL"]}],tags:["blazer","şık","iş","formal","ceket"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:20,name:"Adidas Originals Track Pants",slug:"adidas-originals-track-pants",price:699,originalPrice:899,discount:22,category:"clothing",subcategory:"pants",brand:"Adidas",rating:4.4,reviewCount:723,stock:35,images:["https://picsum.photos/500/500?random=139","https://picsum.photos/500/500?random=140","https://picsum.photos/500/500?random=141"],description:"Sporty track pantolon, rahat kesim ve üç çizgi detayı",shortDescription:"Klasik eşofman altı, streetwear tarzı",features:["İkonik 3 çizgi","Elastik bel","Tapered kesim","Polyester kumaş","Streetwear stil"],specifications:{Kumaş:"100% Polyester",Kesim:"Tapered",Kapama:"Elastik bel",Cep:"2 yan cep",Bakım:"Makine yıkama 30°C"},variants:[{id:"color",name:"Renk",options:["Siyah","Lacivert","Bordo","Yeşil"]},{id:"size",name:"Beden",options:["S","M","L","XL","XXL"]}],tags:["track-pants","spor","streetwear","adidas","eşofman"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:21,name:"Koton Boyfriend Gömlek",slug:"koton-boyfriend-gomlek",price:299,originalPrice:399,discount:25,category:"clothing",subcategory:"shirts",brand:"Koton",rating:4,reviewCount:542,stock:40,images:["https://picsum.photos/500/500?random=21","https://picsum.photos/500/500?random=21a","https://picsum.photos/500/500?random=21b"],description:"Oversize boyfriend gömlek, rahat ve şık kullanım",shortDescription:"Oversize kesimli pamuklu gömlek",features:["Boyfriend kesim","100% pamuk","Uzun kollu","Düğmeli ön","Casual stil"],specifications:{Kumaş:"100% Pamuk",Kesim:"Boyfriend/Oversize",Kol:"Uzun",Kapama:"Düğmeli",Bakım:"Makine yıkama 40°C"},variants:[{id:"color",name:"Renk",options:["Beyaz","Açık Mavi","Pembe","Sarı"]},{id:"size",name:"Beden",options:["XS","S","M","L"]}],tags:["gömlek","boyfriend","oversize","pamuk","casual"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:22,name:"LC Waikiki Skinny Jean",slug:"lc-waikiki-skinny-jean",price:199,originalPrice:249,discount:20,category:"clothing",subcategory:"jeans",brand:"LC Waikiki",rating:3.9,reviewCount:1234,stock:60,images:["https://picsum.photos/500/500?random=22","https://picsum.photos/500/500?random=22a","https://picsum.photos/500/500?random=22b"],description:"Uygun fiyatlı skinny jean, gençler için ideal seçim",shortDescription:"Budget-friendly skinny fit denim",features:["Skinny fit","Stretch denim","Normal bel","Klasik 5 cep","Uygun fiyat"],specifications:{Kumaş:"98% Pamuk, 2% Elastan",Kesim:"Skinny Fit",Yükselti:"Normal bel",Kapama:"Fermuarlı",Bakım:"Makine yıkama 30°C"},variants:[{id:"color",name:"Renk",options:["Koyu Mavi","Siyah","Gri","Açık Mavi"]},{id:"size",name:"Beden",options:["26","28","30","32","34","36"]}],tags:["skinny","jean","uygun-fiyat","stretch","genç"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:23,name:"Puma Suede Classic",slug:"puma-suede-classic",price:2799,originalPrice:3299,discount:15,category:"clothing",subcategory:"shoes",brand:"Puma",rating:4.5,reviewCount:892,stock:28,images:["https://picsum.photos/500/500?random=142","https://picsum.photos/500/500?random=143","https://picsum.photos/500/500?random=144"],description:"Retro basketbol ayakkabısı, süet malzeme ile vintage tarz",shortDescription:"Klasik süet sneaker, retro tasarım",features:["Süet üst malzeme","Retro basketbol tasarımı","Kauçuk taban","Klasik Puma şeridi","Rahat fit"],specifications:{"Üst Malzeme":"Süet deri",Taban:"Kauçuk",Astar:"Tekstil",Kapama:"Bağcıklı",Stil:"Low-top retro"},variants:[{id:"color",name:"Renk",options:["Peacoat","Rhubarb","Classic Blue","Forest Night","High Risk Red"]},{id:"size",name:"Numara",options:["36","37","38","39","40","41","42","43","44","45"]}],tags:["suede","retro","klasik","basketbol","vintage"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:24,name:"Defacto Kadın Elbise",slug:"defacto-kadin-elbise",price:259,originalPrice:349,discount:26,category:"clothing",subcategory:"dresses",brand:"DeFacto",rating:4.1,reviewCount:1567,stock:55,images:["https://picsum.photos/500/500?random=145","https://picsum.photos/500/500?random=146","https://picsum.photos/500/500?random=147"],description:"Günlük kullanım için rahat midi elbise, çok renkli seçenekler",shortDescription:"Rahat kesimli midi elbise, çiçekli desenler",features:["Midi boy","A-line kesim","Kısa kollu","Çiçekli desenler","Rahat kumaş"],specifications:{Kumaş:"95% Polyester, 5% Elastan",Kesim:"A-line",Boy:"Midi",Kol:"Kısa kol",Bakım:"Makine yıkama 30°C"},variants:[{id:"color",name:"Renk",options:["Çiçekli Kırmızı","Çiçekli Mavi","Çiçekli Pembe","Düz Siyah","Düz Lacivert"]},{id:"size",name:"Beden",options:["XS","S","M","L","XL"]}],tags:["elbise","midi","çiçekli","günlük","kadın"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:25,name:"Columbia Windbreaker",slug:"columbia-windbreaker",price:899,originalPrice:1199,discount:25,category:"clothing",subcategory:"jackets",brand:"Columbia",rating:4.4,reviewCount:423,stock:20,images:["https://picsum.photos/500/500?random=148","https://picsum.photos/500/500?random=149","https://picsum.photos/500/500?random=150"],description:"Hafif rüzgarlık ceket, outdoor aktiviteler için ideal",shortDescription:"Su geçirmez rüzgarlık, paketlenebilir",features:["Su geçirmez","Rüzgar geçirmez","Paketlenebilir","Kapüşonlu","Hafif kumaş"],specifications:{Kumaş:"Polyester ripstop","Su geçirmezlik":"DWR kaplama",Kapüşon:"Ayarlanabilir",Cep:"2 fermuar cep",Ağırlık:"200g"},variants:[{id:"color",name:"Renk",options:["Navy","Bright Green","Orange","Black"]},{id:"size",name:"Beden",options:["S","M","L","XL","XXL"]}],tags:["outdoor","rüzgarlık","su-geçirmez","hafif","paketlenebilir"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:26,name:"Marks & Spencer Yün Kazak",slug:"marks-spencer-yun-kazak",price:699,originalPrice:899,discount:22,category:"clothing",subcategory:"sweaters",brand:"Marks & Spencer",rating:4.3,reviewCount:756,stock:35,images:["https://picsum.photos/500/500?random=151","https://picsum.photos/500/500?random=152","https://picsum.photos/500/500?random=153"],description:"Merino yün kazak, sıcak ve şık kış seçimi",shortDescription:"Merino yün triko, V yaka",features:["100% Merino yün","V yaka","Ince örme","Sıcak tutan","Yumuşak dokum"],specifications:{Kumaş:"100% Merino Yün",Yaka:"V yaka",Kol:"Uzun kol",Örme:"İnce gauge",Bakım:"El yıkama"},variants:[{id:"color",name:"Renk",options:["Camel","Navy","Charcoal","Cream","Burgundy"]},{id:"size",name:"Beden",options:["S","M","L","XL"]}],tags:["kazak","yün","merino","kış","şık"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:27,name:"Converse Chuck Taylor All Star",slug:"converse-chuck-taylor-all-star",price:1999,originalPrice:2299,discount:13,category:"clothing",subcategory:"shoes",brand:"Converse",rating:4.6,reviewCount:4521,stock:40,images:["https://picsum.photos/500/500?random=154","https://picsum.photos/500/500?random=155","https://picsum.photos/500/500?random=156"],description:"Efsanevi canvas sneaker, sokak stilinin ikonu",shortDescription:"Klasik high-top canvas ayakkabı",features:["Canvas üst malzeme","High-top tasarım","İkonik yıldız logosu","Kauçuk taban","Zamansız stil"],specifications:{"Üst Malzeme":"Canvas",Taban:"Vulkanize kauçuk",Astar:"Tekstil",Kapama:"Bağcıklı",Stil:"High-top"},variants:[{id:"color",name:"Renk",options:["Optical White","Black","Red","Navy","Pink","Yellow"]},{id:"size",name:"Numara",options:["35","36","37","38","39","40","41","42","43","44"]}],tags:["converse","canvas","high-top","klasik","streetwear"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:28,name:"Pull & Bear Crop Top",slug:"pull-bear-crop-top",price:179,originalPrice:229,discount:22,category:"clothing",subcategory:"tops",brand:"Pull & Bear",rating:3.9,reviewCount:634,stock:65,images:["https://picsum.photos/500/500?random=157","https://picsum.photos/500/500?random=158","https://picsum.photos/500/500?random=159"],description:"Trendy crop top, yaz için ideal kısa üst",shortDescription:"Kısa kesim üst, genç tarz",features:["Crop kesim","Pamuk karışımı","Kısa kollu","Rahat fit","Trend renklerde"],specifications:{Kumaş:"60% Pamuk, 40% Polyester",Kesim:"Crop",Kol:"Kısa kol",Fit:"Regular",Bakım:"Makine yıkama 30°C"},variants:[{id:"color",name:"Renk",options:["White","Black","Pink","Mint Green","Lilac","Orange"]},{id:"size",name:"Beden",options:["XS","S","M","L"]}],tags:["crop-top","trend","yaz","genç","kısa"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:29,name:"Mavi Erkek Chino Pantolon",slug:"mavi-erkek-chino-pantolon",price:449,originalPrice:599,discount:25,category:"clothing",subcategory:"pants",brand:"Mavi",rating:4.2,reviewCount:987,stock:45,images:["https://picsum.photos/500/500?random=160","https://picsum.photos/500/500?random=161","https://picsum.photos/500/500?random=162"],description:"Klasik chino pantolon, iş ve günlük kullanım için uygun",shortDescription:"Düz paça chino, çok amaçlı kullanım",features:["Pamuk twill kumaş","Düz paça","Normal bel","Klasik kesim","Çok renkli seçenek"],specifications:{Kumaş:"97% Pamuk, 3% Elastan",Kesim:"Regular Fit",Yükselti:"Normal bel",Kapama:"Fermuarlı",Bakım:"Makine yıkama 40°C"},variants:[{id:"color",name:"Renk",options:["Khaki","Navy","Black","Olive","Stone","Burgundy"]},{id:"size",name:"Beden",options:["30","32","34","36","38","40"]}],tags:["chino","pamuk","klasik","iş","günlük"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:30,name:"Bershka Denim Ceket",slug:"bershka-denim-ceket",price:399,originalPrice:499,discount:20,category:"clothing",subcategory:"jackets",brand:"Bershka",rating:4.1,reviewCount:1245,stock:30,images:["https://picsum.photos/500/500?random=163","https://picsum.photos/500/500?random=164","https://picsum.photos/500/500?random=165"],description:"Vintage tarz denim ceket, her mevsim kullanılabilir",shortDescription:"Klasik kot ceket, vintage yıkama",features:["100% pamuk denim","Klasik kesim","Düğmeli ön","Göğüs cepleri","Vintage yıkama"],specifications:{Kumaş:"100% Pamuk Denim",Yıkama:"Vintage stonewash",Kapama:"Düğmeli",Cep:"4 cep",Bakım:"Makine yıkama 30°C"},variants:[{id:"color",name:"Renk",options:["Light Blue","Dark Blue","Black","White"]},{id:"size",name:"Beden",options:["XS","S","M","L","XL"]}],tags:["denim","kot-ceket","vintage","klasik","pamuk"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:31,name:"Vans Old Skool",slug:"vans-old-skool",price:2499,originalPrice:2899,discount:14,category:"clothing",subcategory:"shoes",brand:"Vans",rating:4.5,reviewCount:2876,stock:35,images:["https://picsum.photos/500/500?random=166","https://picsum.photos/500/500?random=167","https://picsum.photos/500/500?random=168"],description:"Skate kültürünün ikonu, yan şerit detaylı sneaker",shortDescription:"Klasik skate ayakkabısı, yan şerit",features:["Suede ve canvas kombinasyonu","İkonik yan şerit","Waffle taban","Skate performansı","Dayanıklı yapı"],specifications:{"Üst Malzeme":"Suede/Canvas",Taban:"Waffle rubber",Kapama:"Bağcıklı",Stil:"Low-top skate",Özellik:"Yan şerit detayı"},variants:[{id:"color",name:"Renk",options:["Black/White","Navy/White","Burgundy/White","Green/White","Grey/White"]},{id:"size",name:"Numara",options:["36","37","38","39","40","41","42","43","44","45"]}],tags:["vans","skate","streetwear","yan-şerit","klasik"],aiGenerated:{description:!0,tags:!0,recommendations:!0}},{id:32,name:"Reserved Kadın Trençkot",slug:"reserved-kadin-trenckot",price:1299,originalPrice:1699,discount:24,category:"clothing",subcategory:"coats",brand:"Reserved",rating:4.4,reviewCount:567,stock:18,images:["https://picsum.photos/500/500?random=169","https://picsum.photos/500/500?random=170","https://picsum.photos/500/500?random=171"],description:"Klasik trençkot, zamansız şıklık ve fonksiyonellik",shortDescription:"Double-breasted trençkot, klasik kesim",features:["Double-breasted","Su itici kumaş","Kemerli","Omuzda detay","Midi boy"],specifications:{Kumaş:"Polyester blend",Boy:"Midi",Kapama:"Double-breasted",Kemer:"Kuşak kemer",Bakım:"Kuru temizleme"},variants:[{id:"color",name:"Renk",options:["Beige","Navy","Black","Khaki"]},{id:"size",name:"Beden",options:["S","M","L","XL"]}],tags:["trençkot","klasik","şık","kemer","midi"],aiGenerated:{description:!0,tags:!0,recommendations:!0}}];for(const r of e)try{const a={...r,firebaseId:r.id.toString(),createdAt:new Date,updatedAt:new Date};await U.createProduct(a),console.log(`Added product: ${r.name}`)}catch(a){console.error(`Error adding product ${r.name}:`,a)}console.log("Additional products added successfully")}catch(e){throw console.error("Error adding additional products:",e),e}}static async getAllProducts(e={}){try{console.log("ProductFirebaseService: Getting products with filters:",e);const r=await U.getProducts(e);return console.log("ProductFirebaseService: Fetched unique products:",r.length),r.length>0&&console.log("First product example:",r[0]),r}catch(r){return console.error("Error getting products from Firebase:",r),[]}}static async getProduct(e){try{return await U.getProduct(e)}catch(r){throw console.error("Error getting product from Firebase:",r),r}}static async searchProducts(e,r={}){try{const a=await U.getProducts(r);if(!e||e.trim().length<2)return a;const s=e.toLowerCase();return a.filter(n=>{var o,l,c;return((o=n.name)==null?void 0:o.toLowerCase().includes(s))||((l=n.description)==null?void 0:l.toLowerCase().includes(s))||((c=n.brand)==null?void 0:c.toLowerCase().includes(s))||n.tags&&n.tags.some(d=>d.toLowerCase().includes(s))})}catch(a){return console.error("Error searching products:",a),[]}}static async getProductsByCategory(e,r){try{const a={category:e};return r&&(a.limit=r),await U.getProducts(a)}catch(a){return console.error("Error getting products by category:",a),[]}}static async getFeaturedProducts(e=6){try{return(await U.getProducts()).filter(a=>a.tags&&a.tags.includes("popüler")||a.rating>=4.5).slice(0,e)}catch(r){return console.error("Error getting featured products:",r),[]}}static async getDiscountedProducts(e=6){try{return(await U.getProducts()).filter(a=>a.discount>0).sort((a,s)=>s.discount-a.discount).slice(0,e)}catch(r){return console.error("Error getting discounted products:",r),[]}}}class $o{static async initializeDatabase(){try{console.log("🚀 Starting Firebase database initialization...");const e=await U.checkConnection();if(!e.success)throw new Error(`Firebase connection failed: ${e.message}`);console.log("✅ Firebase connection successful"),await we.initializeProducts(),console.log("✅ Products initialized successfully");const r=await we.getAllProducts();return console.log(`✅ Database initialization complete! Total products: ${r.length}`),{success:!0,message:`Database initialized with ${r.length} products`,productCount:r.length}}catch(e){return console.error("❌ Firebase initialization failed:",e),{success:!1,message:e.message,error:e}}}static async getStatus(){try{const e=await U.checkConnection(),r=await we.getAllProducts();return{connected:e.success,productCount:r.length,initialized:r.length>0}}catch(e){return{connected:!1,productCount:0,initialized:!1,error:e.message}}}}typeof window<"u"&&setTimeout(()=>{console.log("🚀 Starting Firebase auto-initialization..."),$o.initializeDatabase().then(i=>{i.success?console.log("🎉 Firebase auto-initialization completed successfully"):console.warn("⚠️ Firebase auto-initialization failed, will fallback to local data")}).catch(i=>{console.error("💥 Firebase auto-initialization error:",i)})},2e3);class Bo{constructor(){this.memoryCache=new Map,this.requestCache=new Map,this.cacheMetrics={hits:0,misses:0,requests:0,savedReads:0},this.cacheConfig={products:{ttl:30*60*1e3,maxItems:1e3},users:{ttl:10*60*1e3,maxItems:200},carts:{ttl:2*60*1e3,maxItems:100},orders:{ttl:60*60*1e3,maxItems:500},searches:{ttl:15*60*1e3,maxItems:300},recommendations:{ttl:120*60*1e3,maxItems:100}},this.startCleanupScheduler(),this.loadFromPersistentStorage()}async get(e,r,a){this.cacheMetrics.requests++;const s=`${r}:${e}`,n=this.cacheConfig[r]||this.cacheConfig.products,o=this.memoryCache.get(s);if(o&&!this.isExpired(o,n.ttl))return this.cacheMetrics.hits++,this.updateAccessTime(s),o.data;if(this.requestCache.has(s))return console.log(`🔄 Deduplicating concurrent request for ${s}`),await this.requestCache.get(s);const l=this.executeWithMetrics(a,s);this.requestCache.set(s,l);try{const c=await l;return c!=null&&(this.set(s,c,r),this.saveToPersistentStorage(s,c,r)),c}catch(c){throw console.error(`❌ Cache fetch failed for ${s}:`,c),c}finally{this.requestCache.delete(s)}}set(e,r,a){const s=this.cacheConfig[a]||this.cacheConfig.products,n={data:r,timestamp:Date.now(),accessTime:Date.now(),dataType:a,size:this.estimateSize(r)};this.memoryCache.size>=s.maxItems&&this.evictLRU(a,s.maxItems),this.memoryCache.set(e,n)}async getBatch(e,r,a){const s={},n=[];for(const o of e){const l=`${r}:${o}`,c=this.memoryCache.get(l),d=this.cacheConfig[r]||this.cacheConfig.products;c&&!this.isExpired(c,d.ttl)?(s[o]=c.data,this.cacheMetrics.hits++):(n.push(o),this.cacheMetrics.misses++)}if(n.length>0){console.log(`📦 Batch fetching ${n.length} items for ${r}`);try{const o=await a(n);Object.entries(o).forEach(([l,c])=>{const d=`${r}:${l}`;this.set(d,c,r),this.saveToPersistentStorage(d,c,r),s[l]=c}),this.cacheMetrics.savedReads+=Math.max(0,n.length-1)}catch(o){throw console.error(`❌ Batch fetch failed for ${r}:`,o),o}}return s}invalidate(e,r=null){let a=0;const s=[];for(const[n,o]of this.memoryCache)(r?o.dataType===r&&n.includes(e):n.includes(e))&&(s.push(n),a++);return s.forEach(n=>this.memoryCache.delete(n)),typeof window<"u"&&Object.keys(localStorage).forEach(o=>{o.startsWith("cache:")&&o.includes(e)&&localStorage.removeItem(o)}),console.log(`🗑️ Invalidated ${a} cache entries matching "${e}"`),a}async warmCache(e,r,a){console.log(`🔥 Warming cache for ${e} with ${r.length} items`);const s=r.map(async l=>{const c=`${e}:${l}`;if(!this.memoryCache.has(c))try{const d=await a(l);return this.set(c,d,e),{key:l,success:!0}}catch(d){return console.warn(`⚠️ Cache warming failed for ${c}:`,d),{key:l,success:!1,error:d}}return{key:l,success:!0,fromCache:!0}}),n=await Promise.allSettled(s),o=n.filter(l=>l.status==="fulfilled"&&l.value.success).length;return console.log(`✅ Cache warming completed: ${o}/${r.length} items loaded`),n}evictLRU(e,r){const a=Array.from(this.memoryCache.entries()).filter(([n,o])=>o.dataType===e).sort(([,n],[,o])=>n.accessTime-o.accessTime),s=a.slice(0,Math.max(0,a.length-r+1));s.forEach(([n])=>{this.memoryCache.delete(n)}),s.length>0&&console.log(`♻️ Evicted ${s.length} LRU entries for ${e}`)}saveToPersistentStorage(e,r,a){if(!(typeof window>"u"))try{const s=`cache:${e}`,n={data:r,timestamp:Date.now(),dataType:a,version:"1.0"};localStorage.setItem(s,JSON.stringify(n))}catch(s){console.warn("⚠️ Failed to save to persistent storage:",s)}}loadFromPersistentStorage(){if(!(typeof window>"u"))try{const e=Object.keys(localStorage);let r=0;e.forEach(a=>{if(a.startsWith("cache:"))try{const s=JSON.parse(localStorage.getItem(a)),n=a.replace("cache:",""),o=this.cacheConfig[s.dataType]||this.cacheConfig.products;this.isExpired(s,o.ttl)?localStorage.removeItem(a):(this.memoryCache.set(n,{data:s.data,timestamp:s.timestamp,accessTime:Date.now(),dataType:s.dataType,size:this.estimateSize(s.data)}),r++)}catch{localStorage.removeItem(a)}}),r>0&&console.log(`💾 Loaded ${r} items from persistent storage`)}catch(e){console.warn("⚠️ Failed to load from persistent storage:",e)}}isExpired(e,r){return Date.now()-e.timestamp>r}updateAccessTime(e){const r=this.memoryCache.get(e);r&&(r.accessTime=Date.now())}estimateSize(e){try{return JSON.stringify(e).length}catch{return 1e3}}async executeWithMetrics(e,r){const a=Date.now();this.cacheMetrics.misses++;try{const s=await e(),n=Date.now()-a;return console.log(`📊 Firebase read for ${r}: ${n}ms`),s}catch(s){throw console.error(`❌ Firebase read failed for ${r}:`,s),s}}startCleanupScheduler(){setInterval(()=>{this.cleanupExpiredEntries()},5*60*1e3),setInterval(()=>{this.performMaintenance()},30*60*1e3)}cleanupExpiredEntries(){let e=0;for(const[r,a]of this.memoryCache){const s=this.cacheConfig[a.dataType]||this.cacheConfig.products;this.isExpired(a,s.ttl)&&(this.memoryCache.delete(r),e++)}e>0&&console.log(`🧹 Cleaned ${e} expired cache entries`)}performMaintenance(){console.log("🔧 Performing cache maintenance...");const e=this.memoryCache.size,r=Array.from(this.memoryCache.values()).reduce((s,n)=>s+(n.size||0),0),a=this.cacheMetrics.requests>0?(this.cacheMetrics.hits/this.cacheMetrics.requests*100).toFixed(2):0;console.log(`📈 Cache Stats: ${e} items, ${(r/1024).toFixed(2)}KB, ${a}% hit rate, ${this.cacheMetrics.savedReads} Firebase reads saved`),this.cacheMetrics={hits:0,misses:0,requests:0,savedReads:0}}getCacheStats(){const e={memoryItems:this.memoryCache.size,pendingRequests:this.requestCache.size,metrics:{...this.cacheMetrics}},r={};for(const[a,s]of this.memoryCache){const n=s.dataType;r[n]=(r[n]||0)+1}return e.typeBreakdown=r,e}clear(){this.memoryCache.clear(),this.requestCache.clear(),typeof window<"u"&&Object.keys(localStorage).forEach(r=>{r.startsWith("cache:")&&localStorage.removeItem(r)}),console.log("🗑️ Cache cleared completely")}}let tr=null;function Wt(){return tr||(tr=new Bo),tr}class Go{constructor(){this.cache=Wt(),this.isInitialized=!1,this.initializationPromise=null}async getProducts(e={}){const{page:r=1,limit:a=K.ITEMS_PER_PAGE,category:s,brand:n,minPrice:o,maxPrice:l,sortBy:c="name",sortOrder:d="asc",search:u,useCache:h=!0}=e,g=this.createProductsCacheKey(e);if(h)try{return await this.cache.get(g,"products",()=>this.fetchProductsFromFirebase(e))}catch(x){throw console.error("❌ Optimized product fetch failed:",x),x}else return await this.fetchProductsFromFirebase(e)}async fetchProductsFromFirebase(e){const{page:r=1,limit:a=K.ITEMS_PER_PAGE,category:s,brand:n,minPrice:o,maxPrice:l,sortBy:c="name",sortOrder:d="asc",search:u}=e;console.log(`🔍 Executing optimized Firebase query: ${JSON.stringify(e)}`);const h={limit:a,offset:(r-1)*a};s&&(h.category=s),n&&(h.brand=n),o!==void 0&&(h.priceMin=o),l!==void 0&&(h.priceMax=l),c&&(h.orderBy=c,h.orderDirection=d);let g=await U.getProducts(h);const x={...h};delete x.limit,delete x.offset;const k=await U.getProducts(x);let f=k.length;return u&&u.trim()&&(g=this.optimizedSearch(g,u.trim()),f=this.optimizedSearch(k,u.trim()).length),console.log("OptimizedProductService: Pagination debug:",{productsLength:g.length,totalCount:f,page:r,limit:a,hasMore:g.length===a&&(r-1)*a+g.length<f}),{products:g,pagination:{page:r,limit:a,total:f,hasMore:g.length===a&&(r-1)*a+g.length<f},filters:e,fromCache:!1,queryTime:Date.now()}}async searchProducts(e,r={}){if(!e||e.trim().length<2)return{products:[],total:0};const a=`search:${e.toLowerCase()}:${JSON.stringify(r)}`;return await this.cache.get(a,"searches",async()=>{const s=await this.getAllProductsCached(),n=this.optimizedSearch(s,e);return{products:n,query:e,total:n.length,searchTime:Date.now()}})}optimizedSearch(e,r){const a=r.toLowerCase().trim(),s=a.split(" ").filter(o=>o.length>1);return e.map(o=>{let l=0;const c=[o.name,o.description,o.shortDescription,o.category,o.brand,...o.tags||[],...o.features||[]].join(" ").toLowerCase();return o.name.toLowerCase().includes(a)&&(l+=100),o.brand&&o.brand.toLowerCase().includes(a)&&(l+=80),o.category&&o.category.toLowerCase().includes(a)&&(l+=60),s.forEach(d=>{c.includes(d)&&(l+=20)}),o.tags&&o.tags.forEach(d=>{d.toLowerCase().includes(a)&&(l+=40)}),{...o,searchScore:l}}).filter(o=>o.searchScore>0).sort((o,l)=>l.searchScore-o.searchScore).map(({searchScore:o,...l})=>l)}async getProduct(e){if(!e)throw new Error("Product ID is required");return await this.cache.get(e.toString(),"products",()=>U.getProduct(e))}async getProductBySlug(e){if(!e)throw new Error("Product slug is required");const r=`slug:${e}`;return await this.cache.get(r,"products",async()=>(await this.getAllProductsCached()).find(s=>s.slug===e)||null)}async getFeaturedProducts(e=6){const r=`featured:${e}`;return await this.cache.get(r,"products",async()=>{const a={featured:!0,limit:e,orderBy:"rating",orderDirection:"desc"},s=await U.getProducts(a);if(s.length===0){const n={limit:e,orderBy:"rating",orderDirection:"desc"};return await U.getProducts(n)}return s})}async getDiscountedProducts(e=8){const r=`discounted:${e}`;return await this.cache.get(r,"products",async()=>{const a={hasDiscount:!0,limit:e,orderBy:"discount",orderDirection:"desc"};return await U.getProducts(a)})}async getProductsByCategory(e,r={}){return await this.getProducts({...r,category:e})}async getProductsByBrand(e,r={}){return await this.getProducts({...r,brand:e})}async getRelatedProducts(e,r=4){const a=`related:${e}:${r}`;return await this.cache.get(a,"products",async()=>{const s=await this.getProduct(e);return s?(await this.getProductsByCategory(s.category,{limit:r*2})).products.filter(l=>l.id!==s.id).map(l=>({...l,similarityScore:this.calculateSimilarityScore(s,l)})).sort((l,c)=>c.similarityScore-l.similarityScore).slice(0,r).map(({similarityScore:l,...c})=>c):[]})}calculateSimilarityScore(e,r){let a=0;e.category===r.category&&(a+=50),e.brand===r.brand&&(a+=30);const s=Math.abs(e.price-r.price),n=(e.price+r.price)/2,o=Math.max(0,20-s/n*100);a+=o;const l=Math.abs((e.rating||0)-(r.rating||0));if(a+=Math.max(0,10-l*2),e.tags&&r.tags){const c=e.tags.filter(d=>r.tags.includes(d));a+=c.length*15}return a}async getCategories(){return await this.cache.get("all-categories","products",async()=>{const e=await this.getAllProductsCached();return[...new Set(e.map(a=>a.category))].map(a=>({id:a,name:a,productCount:e.filter(s=>s.category===a).length}))})}async getBrands(){return await this.cache.get("all-brands","products",async()=>{const e=await this.getAllProductsCached();return[...new Set(e.map(a=>a.brand).filter(Boolean))].map(a=>({id:a,name:a,productCount:e.filter(s=>s.brand===a).length}))})}async getProductsBatch(e){return!e||e.length===0?{}:await this.cache.getBatch(e,"products",async r=>{console.log(`📦 Batch fetching ${r.length} products from Firebase`);const a={},s=r.map(o=>U.getProduct(o).catch(l=>(console.warn(`Failed to fetch product ${o}:`,l),null))),n=await Promise.all(s);return r.forEach((o,l)=>{n[l]&&(a[o]=n[l])}),a})}async getAllProductsCached(){return await this.cache.get("all-products","products",()=>U.getProducts({limit:1e3}))}async warmProductCache(e){!e||e.length===0||await this.cache.warmCache("products",e,r=>U.getProduct(r))}async preloadCommonData(){console.log("🔥 Preloading common product data...");const e=[this.getFeaturedProducts(6),this.getDiscountedProducts(8),this.getCategories(),this.getBrands()];try{await Promise.all(e),console.log("✅ Common product data preloaded successfully")}catch(r){console.warn("⚠️ Some preload tasks failed:",r)}}invalidateProductCache(e=null){e?(this.cache.invalidate(e.toString(),"products"),this.cache.invalidate(`related:${e}`,"products")):(this.cache.invalidate("","products"),this.cache.invalidate("","searches"))}createProductsCacheKey(e){return["products",e.page||1,e.limit||K.ITEMS_PER_PAGE,e.category||"",e.brand||"",e.minPrice||"",e.maxPrice||"",e.sortBy||"name",e.sortOrder||"asc",e.search||""].join(":")}getCacheStats(){return this.cache.getCacheStats()}clearCache(){this.cache.invalidate("","products"),this.cache.invalidate("","searches")}}let rr=null;function zr(){return rr||(rr=new Go),rr}class Ko{constructor(){this.cache=Wt(),this.productService=zr(),this.activeListeners=new Map}async getUserCart(e,r=!0){if(!e)throw new Error("User ID is required");const a=`cart:${e}`;if(r)try{return await this.cache.get(a,"carts",()=>this.fetchCartFromFirebase(e))}catch(s){throw console.error("❌ Optimized cart fetch failed:",s),s}else return await this.fetchCartFromFirebase(e)}async fetchCartFromFirebase(e){try{console.log(`🛒 Fetching cart for user: ${e}`);const r=await U.getUserCart(e);if(!r||r.length===0)return{userId:e,items:[],totalItems:0,totalPrice:0,lastUpdated:new Date().toISOString(),isEmpty:!0};const a=[...new Set(r.map(d=>d.productId))];console.log(`📦 Batch fetching ${a.length} unique products for cart`);const s=await this.productService.getProductsBatch(a),n=new Map;Object.entries(s).forEach(([d,u])=>{u&&n.set(d,u)});const o=r.map(d=>this.enrichCartItem(d,n)).filter(d=>d.product!==null),l=this.calculateCartTotals(o),c={userId:e,items:o,totalItems:o.reduce((d,u)=>d+u.quantity,0),totalPrice:l.totalPrice,totalOriginalPrice:l.totalOriginalPrice,totalDiscount:l.totalDiscount,totalSavings:l.totalSavings,lastUpdated:new Date().toISOString(),isEmpty:o.length===0,hasUnavailableItems:o.some(d=>!d.isAvailable),optimizedFetch:!0};return console.log(`✅ Cart loaded: ${o.length} items, ₺${l.totalPrice.toFixed(2)} total`),c}catch(r){throw console.error(`❌ Error fetching cart for user ${e}:`,r),r}}enrichCartItem(e,r){var h;const a=r.get(e.productId);if(!a)return console.warn(`⚠️ Product not found for cart item: ${e.productId}`),{...e,product:null,isAvailable:!1,itemTotalPrice:0,itemOriginalPrice:0,itemDiscount:0,error:"Product not found"};const s=a.price||0,n=a.originalPrice||s,o=s*e.quantity,l=n*e.quantity,c=l-o,d=a.stock>=e.quantity,u=this.getStockStatus(a.stock,e.quantity);return{...e,product:a,itemPrice:s,itemOriginalPrice:n,itemTotalPrice:o,itemOriginalTotalPrice:l,itemDiscount:c,itemSavings:c>0?c:0,isAvailable:d,stockStatus:u,maxAvailableQuantity:a.stock,displayName:a.name,displayImage:((h=a.images)==null?void 0:h[0])||"",displaySlug:a.slug,lastChecked:new Date().toISOString(),key:`${e.productId}_${JSON.stringify(e.selectedVariants||{})}`}}calculateCartTotals(e){const r=e.reduce((a,s)=>(s.isAvailable?(a.totalPrice+=s.itemTotalPrice||0,a.totalOriginalPrice+=s.itemOriginalTotalPrice||0,a.totalDiscount+=s.itemDiscount||0):a.unavailableItemsValue+=s.itemTotalPrice||0,a),{totalPrice:0,totalOriginalPrice:0,totalDiscount:0,unavailableItemsValue:0});return r.totalSavings=r.totalDiscount,r.discountPercentage=r.totalOriginalPrice>0?(r.totalDiscount/r.totalOriginalPrice*100).toFixed(2):0,r}getStockStatus(e,r){return e===0?{status:"out_of_stock",message:"Stokta yok",available:0}:e<r?{status:"insufficient_stock",message:`Sadece ${e} adet mevcut`,available:e}:e<=5?{status:"low_stock",message:`Son ${e} adet`,available:e}:{status:"in_stock",message:"Stokta",available:e}}async addToCart(e,r,a=1,s={}){if(!e||!r)throw new Error("User ID and Product ID are required");try{console.log(`➕ Adding to cart: ${r} x${a} for user ${e}`);const n=await this.productService.getProduct(r);if(!n)throw new Error("Product not found");if(n.stock<a)throw new Error(`Insufficient stock. Only ${n.stock} items available.`);const o=`cart:${e}`,l=await this.getUserCart(e),c=this.updateCartOptimistically(l,r,a,s,n,"add");this.cache.set(o,c,"carts");const d=await U.addToCart(e,r,a,s);return this.cache.invalidate(o,"carts"),setTimeout(()=>{this.getUserCart(e,!1).catch(console.error)},100),console.log("✅ Item added to cart successfully"),d}catch(n){console.error("❌ Failed to add item to cart:",n);const o=`cart:${e}`;throw this.cache.invalidate(o,"carts"),n}}async updateCartItem(e,r,a,s={}){if(!e||!r)throw new Error("User ID and Product ID are required");try{if(console.log(`🔄 Updating cart item: ${r} to quantity ${a}`),a<=0)return await this.removeFromCart(e,r,s);const n=await this.productService.getProduct(r);if(n&&n.stock<a)throw new Error(`Insufficient stock. Only ${n.stock} items available.`);const o=`cart:${e}`,l=await this.getUserCart(e),c=this.updateCartOptimistically(l,r,a,s,n,"update");this.cache.set(o,c,"carts");const d=await U.updateCartItem(e,r,a,s);return this.cache.invalidate(o,"carts"),console.log("✅ Cart item updated successfully"),d}catch(n){console.error("❌ Failed to update cart item:",n);const o=`cart:${e}`;throw this.cache.invalidate(o,"carts"),n}}async removeFromCart(e,r,a={}){if(!e||!r)throw new Error("User ID and Product ID are required");try{console.log(`➖ Removing from cart: ${r} for user ${e}`);const s=`cart:${e}`,n=await this.getUserCart(e),o=this.updateCartOptimistically(n,r,0,a,null,"remove");this.cache.set(s,o,"carts");const l=await U.removeFromCart(e,r,a);return this.cache.invalidate(s,"carts"),console.log("✅ Item removed from cart successfully"),l}catch(s){console.error("❌ Failed to remove item from cart:",s);const n=`cart:${e}`;throw this.cache.invalidate(n,"carts"),s}}async clearCart(e){if(!e)throw new Error("User ID is required");try{console.log(`🗑️ Clearing cart for user: ${e}`);const r=await U.clearCart(e);return this.cache.invalidate(`cart:${e}`,"carts"),console.log("✅ Cart cleared successfully"),r}catch(r){throw console.error("❌ Failed to clear cart:",r),r}}updateCartOptimistically(e,r,a,s,n,o){const l=[...e.items||[]],c=`${r}_${JSON.stringify(s)}`,d=l.findIndex(h=>h.key===c);switch(o){case"add":if(d>=0)l[d].quantity+=a;else if(n){const h=this.enrichCartItem({productId:r,quantity:a,selectedVariants:s,addedAt:new Date().toISOString()},new Map([[r,n]]));l.push(h)}break;case"update":d>=0&&(l[d].quantity=a);break;case"remove":d>=0&&l.splice(d,1);break}const u=this.calculateCartTotals(l);return{...e,items:l,totalItems:l.reduce((h,g)=>h+g.quantity,0),totalPrice:u.totalPrice,totalOriginalPrice:u.totalOriginalPrice,totalDiscount:u.totalDiscount,totalSavings:u.totalSavings,lastUpdated:new Date().toISOString(),isEmpty:l.length===0,optimisticUpdate:!0}}subscribeToCart(e,r){if(!e||!r)throw new Error("User ID and callback are required");const a=`cart_${e}_${Date.now()}`;try{const s=U.subscribeToUserCart(e,async n=>{try{const o=await this.fetchCartFromFirebase(e),l=`cart:${e}`;this.cache.set(l,o,"carts"),r(o)}catch(o){console.error("❌ Error processing cart subscription data:",o),r({error:o.message})}});return this.activeListeners.set(a,s),console.log(`👂 Cart subscription established for user: ${e}`),()=>{s(),this.activeListeners.delete(a),console.log(`🔕 Cart subscription ended for user: ${e}`)}}catch(s){throw console.error("❌ Failed to subscribe to cart:",s),s}}async validateCartItems(e){try{console.log(`✅ Validating cart items for user: ${e}`);const r=await this.getUserCart(e,!1),a=[];let s=!1;for(const n of r.items){const o={productId:n.productId,originalQuantity:n.quantity,isValid:!0,issues:[]};n.product?(n.product.stock<n.quantity&&(o.isValid=!1,o.issues.push(`Insufficient stock (${n.product.stock} available)`),o.suggestedQuantity=n.product.stock,o.suggestedAction=n.product.stock>0?"reduce":"remove",s=!0),Math.abs(n.itemPrice-n.product.price)>.01&&(o.issues.push(`Price changed from ₺${n.itemPrice} to ₺${n.product.price}`),o.priceChange={old:n.itemPrice,new:n.product.price,difference:n.product.price-n.itemPrice})):(o.isValid=!1,o.issues.push("Product no longer exists"),o.suggestedAction="remove",s=!0),a.push(o)}return{isValid:!s,hasChanges:s,items:a,validatedAt:new Date().toISOString()}}catch(r){throw console.error("❌ Cart validation failed:",r),r}}getCartAnalytics(e){if(!e||!e.items)return null;const r={totalItems:e.totalItems,uniqueProducts:e.items.length,totalValue:e.totalPrice,averageItemPrice:e.items.length>0?e.totalPrice/e.totalItems:0,totalSavings:e.totalSavings||0,categories:{},brands:{},priceRanges:{low:0,medium:0,high:0},unavailableItems:e.items.filter(a=>!a.isAvailable).length};return e.items.forEach(a=>{if(a.product){const s=a.product.category,n=a.product.brand,o=a.product.price;r.categories[s]=(r.categories[s]||0)+a.quantity,r.brands[n]=(r.brands[n]||0)+a.quantity,o<100?r.priceRanges.low+=a.quantity:o<1e3?r.priceRanges.medium+=a.quantity:r.priceRanges.high+=a.quantity}}),r}cleanup(){this.activeListeners.forEach((e,r)=>{try{e(),console.log(`🔕 Cleaned up listener: ${r}`)}catch(a){console.warn(`⚠️ Error cleaning up listener ${r}:`,a)}}),this.activeListeners.clear(),console.log("✅ Cart service cleanup completed")}}let ar=null;function Ho(){return ar||(ar=new Ko),ar}class ft{static async getProducts(e={}){try{console.log("🔍 OptimizedFirebaseService: Getting products with filters:",e);let r=Z(F,this.COLLECTIONS.PRODUCTS);const a=[];if(e.category&&a.push(H("category","==",e.category)),e.brand&&a.push(H("brand","==",e.brand)),e.featured!==void 0&&a.push(H("featured","==",e.featured)),e.inStock&&a.push(H("stock",">",0)),e.hasDiscount&&a.push(H("discount",">",0)),e.priceMin!==void 0&&e.priceMax!==void 0?(a.push(H("price",">=",e.priceMin)),a.push(H("price","<=",e.priceMax))):e.priceMin!==void 0?a.push(H("price",">=",e.priceMin)):e.priceMax!==void 0&&a.push(H("price","<=",e.priceMax)),e.orderBy){const c=e.orderDirection==="desc"?"desc":"asc";a.push(Ge(e.orderBy,c))}else a.push(Ge("createdAt","desc"));e.lastDoc&&a.push(kr(e.lastDoc));const s=Math.min(e.limit||50,this.maxQueryResults);a.push(Ie(s)),r=J(r,...a);const n=await ne(r);let o=[],l=null;return n.forEach(c=>{o.push({id:c.id,docRef:c,...c.data()}),l=c}),console.log(`✅ OptimizedFirebaseService: Fetched ${o.length} products with server-side filtering`),{products:this.sanitizeProductData(o),lastDoc:l,hasMore:o.length===s,total:o.length,fromOptimized:!0}}catch(r){if(console.error("❌ OptimizedFirebaseService: Error getting products:",r),r.code==="failed-precondition"&&r.message.includes("index"))return console.log("⚠️ Falling back to simplified query due to missing index"),await this.getProductsSimplified(e);throw r}}static async getProductsSimplified(e={}){try{let r=Z(F,this.COLLECTIONS.PRODUCTS);e.category?r=J(r,H("category","==",e.category)):e.brand?r=J(r,H("brand","==",e.brand)):e.featured!==void 0&&(r=J(r,H("featured","==",e.featured)));const a=Math.min(e.limit||50,this.maxQueryResults);r=J(r,Ie(a));const s=await ne(r);let n=[];return s.forEach(o=>{n.push({id:o.id,...o.data()})}),n=this.applyClientSideFilters(n,e),{products:this.sanitizeProductData(n),lastDoc:null,hasMore:!1,total:n.length,fromOptimized:!1,fallbackUsed:!0}}catch(r){throw console.error("❌ Simplified query also failed:",r),r}}static async getProduct(e){if(!e)throw new Error("Product ID is required");try{const r=re(F,this.COLLECTIONS.PRODUCTS,e.toString()),a=await Pe(r);if(a.exists()){const s={id:a.id,...a.data()};return this.sanitizeProductData([s])[0]}else return null}catch(r){throw console.error(`❌ Error getting product ${e}:`,r),r}}static async getProductsBatch(e){if(!e||e.length===0)return[];try{console.log(`📦 Batch fetching ${e.length} products`);const r=[],a=10;for(let s=0;s<e.length;s+=a){const n=e.slice(s,s+a),o=n.map(c=>this.getProduct(c));(await Promise.allSettled(o)).forEach((c,d)=>{c.status==="fulfilled"&&c.value?r.push(c.value):console.warn(`⚠️ Failed to fetch product ${n[d]}:`,c.reason)})}return console.log(`✅ Batch fetch completed: ${r.length}/${e.length} products retrieved`),r}catch(r){throw console.error("❌ Batch product fetch failed:",r),r}}static async getUserCart(e){if(!e)throw new Error("User ID is required");try{const r=J(Z(F,this.COLLECTIONS.CART),H("userId","==",e)),a=await ne(r),s=[];return a.forEach(n=>{s.push({id:n.id,...n.data()})}),s}catch(r){throw console.error(`❌ Error getting cart for user ${e}:`,r),r}}static async getCartWithProducts(e){try{const r=await this.getUserCart(e);if(r.length===0)return{items:[],total:0};const a=[...new Set(r.map(c=>c.productId))],s=await this.getProductsBatch(a),n=new Map(s.map(c=>[c.id,c])),o=r.map(c=>({...c,product:n.get(c.productId)})).filter(c=>c.product),l=o.reduce((c,d)=>c+d.product.price*d.quantity,0);return{items:o,total:l,itemCount:o.length}}catch(r){throw console.error(`❌ Error getting cart with products for user ${e}:`,r),r}}static async getUserOrders(e,r={}){if(!e)throw new Error("User ID is required");try{const{limit:a=20,status:s,startDate:n,endDate:o,lastDoc:l}=r;let c=Z(F,this.COLLECTIONS.ORDERS);const d=[H("userId","==",e)];s&&d.push(H("status","==",s)),n&&d.push(H("createdAt",">=",n)),o&&d.push(H("createdAt","<=",o)),d.push(Ge("createdAt","desc")),l&&d.push(kr(l)),d.push(Ie(a)),c=J(c,...d);const u=await ne(c),h=[];let g=null;return u.forEach(x=>{h.push({id:x.id,...x.data()}),g=x}),{orders:h,lastDoc:g,hasMore:h.length===a}}catch(a){throw console.error(`❌ Error getting orders for user ${e}:`,a),a}}static async getUserBehavior(e,r=100){if(!e)throw new Error("User ID is required");try{const a=J(Z(F,this.COLLECTIONS.USER_BEHAVIOR),H("userId","==",e),Ge("timestamp","desc"),Ie(r)),s=await ne(a),n=[];return s.forEach(o=>{n.push({id:o.id,...o.data()})}),n}catch(a){throw console.error(`❌ Error getting user behavior for ${e}:`,a),a}}static async getSearchHistory(e,r=50){if(!e)throw new Error("User ID is required");try{const a=J(Z(F,this.COLLECTIONS.SEARCH_HISTORY),H("userId","==",e),Ge("timestamp","desc"),Ie(r)),s=await ne(a),n=[];return s.forEach(o=>{n.push({id:o.id,...o.data()})}),n}catch(a){throw console.error(`❌ Error getting search history for ${e}:`,a),a}}static async enableOfflineSupport(){try{await Ri(F),console.log("✅ Firebase offline support enabled")}catch(e){console.warn("⚠️ Failed to enable offline support:",e)}}static async disableOfflineSupport(){try{await Pi(F),console.log("✅ Firebase offline support disabled")}catch(e){console.warn("⚠️ Failed to disable offline support:",e)}}static sanitizeProductData(e){return e.map(r=>({...r,price:parseFloat(r.price)||0,originalPrice:parseFloat(r.originalPrice)||null,discount:parseFloat(r.discount)||0,rating:parseFloat(r.rating)||0,stock:parseInt(r.stock)||0,reviewCount:parseInt(r.reviewCount)||0}))}static applyClientSideFilters(e,r){let a=[...e];return r.priceMin!==void 0&&(a=a.filter(s=>s.price>=r.priceMin)),r.priceMax!==void 0&&(a=a.filter(s=>s.price<=r.priceMax)),r.brand&&!r.category&&(a=a.filter(s=>s.brand===r.brand)),r.orderBy&&a.sort((s,n)=>{let o=s[r.orderBy],l=n[r.orderBy];return r.orderBy==="price"&&(o=parseFloat(o)||0,l=parseFloat(l)||0),r.orderDirection==="desc"?l>o?1:-1:o>l?1:-1}),r.limit&&a.length>r.limit&&(a=a.slice(0,r.limit)),a}static async testConnection(){try{const e=Date.now(),r=J(Z(F,this.COLLECTIONS.PRODUCTS),Ie(1));return await ne(r),{success:!0,latency:Date.now()-e,timestamp:new Date().toISOString()}}catch(e){return{success:!1,error:e.message,timestamp:new Date().toISOString()}}}static async addToCart(e,r,a,s={}){throw new Error("addToCart method should be implemented by CartFirebaseService")}static async updateCartItem(e,r,a,s={}){throw new Error("updateCartItem method should be implemented by CartFirebaseService")}static async removeFromCart(e,r,a={}){throw new Error("removeFromCart method should be implemented by CartFirebaseService")}static async clearCart(e){throw new Error("clearCart method should be implemented by CartFirebaseService")}static subscribeToUserCart(e,r){throw new Error("subscribeToUserCart method should be implemented by CartFirebaseService")}static getRequiredIndexes(){return[{collection:"products",fields:[{field:"category"}]},{collection:"products",fields:[{field:"brand"}]},{collection:"products",fields:[{field:"featured"}]},{collection:"products",fields:[{field:"price"}]},{collection:"products",fields:[{field:"rating"}]},{collection:"products",fields:[{field:"discount"}]},{collection:"products",fields:[{field:"stock"}]},{collection:"products",fields:[{field:"createdAt"}]},{collection:"products",fields:[{field:"category"},{field:"price"}]},{collection:"products",fields:[{field:"category"},{field:"rating",direction:"desc"}]},{collection:"products",fields:[{field:"brand"},{field:"price"}]},{collection:"products",fields:[{field:"featured"},{field:"rating",direction:"desc"}]},{collection:"products",fields:[{field:"category"},{field:"createdAt",direction:"desc"}]},{collection:"cart",fields:[{field:"userId"}]},{collection:"orders",fields:[{field:"userId"},{field:"createdAt",direction:"desc"}]},{collection:"orders",fields:[{field:"userId"},{field:"status"}]},{collection:"user_behavior",fields:[{field:"userId"},{field:"timestamp",direction:"desc"}]},{collection:"search_history",fields:[{field:"userId"},{field:"timestamp",direction:"desc"}]}]}}$e(ft,"COLLECTIONS",{PRODUCTS:"products",USERS:"users",ORDERS:"orders",CART:"cart",USER_BEHAVIOR:"user_behavior",SEARCH_HISTORY:"search_history",RECOMMENDATIONS:"recommendations"}),$e(ft,"cache",Wt()),$e(ft,"batchSize",500),$e(ft,"maxQueryResults",1e3);class qo{constructor(){this.cache=Wt(),this.productService=zr(),this.cartService=Ho(),this.firebaseService=ft,this.performanceMetrics={totalRequests:0,cacheHits:0,cacheMisses:0,averageResponseTime:0,firebaseReadsSaved:0,lastResetTime:Date.now()},this.isInitialized=!1,this.setupPerformanceMonitoring()}async initialize(){if(this.isInitialized){console.log("📊 Optimized services already initialized");return}console.log("🚀 Initializing optimized Firebase services...");try{const e=Date.now(),r=await this.firebaseService.testConnection();if(!r.success)throw new Error(`Firebase connection failed: ${r.error}`);console.log(`✅ Firebase connection established (${r.latency}ms)`),await this.warmupCaches(),this.startPerformanceTracking();const a=Date.now()-e;return console.log(`🎯 Optimized services initialized in ${a}ms`),this.isInitialized=!0,{success:!0,initializationTime:a,connectionLatency:r.latency,services:["cache","products","cart","firebase"]}}catch(e){throw console.error("❌ Failed to initialize optimized services:",e),e}}async warmupCaches(){console.log("🔥 Warming up caches with common data...");const e=[this.productService.preloadCommonData(),this.productService.getCategories(),this.productService.getBrands()];try{await Promise.all(e),console.log("✅ Cache warmup completed successfully")}catch(r){console.warn("⚠️ Some cache warmup tasks failed:",r)}}setupPerformanceMonitoring(){setInterval(()=>{this.updatePerformanceMetrics()},3e4),setInterval(()=>{this.generatePerformanceReport()},24*60*60*1e3)}startPerformanceTracking(){this.performanceMetrics.lastResetTime=Date.now(),console.log("📈 Performance tracking started")}updatePerformanceMetrics(){const e=this.cache.getCacheStats();this.performanceMetrics={...this.performanceMetrics,cacheHits:e.metrics.hits,cacheMisses:e.metrics.misses,firebaseReadsSaved:e.metrics.savedReads,totalRequests:e.metrics.requests,cacheEfficiency:e.metrics.requests>0?(e.metrics.hits/e.metrics.requests*100).toFixed(2):0}}generatePerformanceReport(){const a=((Date.now()-this.performanceMetrics.lastResetTime)/(1e3*60*60)).toFixed(2),s=this.cache.getCacheStats(),n={reportDate:new Date().toISOString(),period:`${a} hours`,performance:{totalRequests:this.performanceMetrics.totalRequests,cacheHits:this.performanceMetrics.cacheHits,cacheMisses:this.performanceMetrics.cacheMisses,cacheEfficiency:`${this.performanceMetrics.cacheEfficiency}%`,firebaseReadsSaved:this.performanceMetrics.firebaseReadsSaved,estimatedCostSavings:this.calculateCostSavings(this.performanceMetrics.firebaseReadsSaved)},cacheStatus:{memoryItems:s.memoryItems,typeBreakdown:s.typeBreakdown,pendingRequests:s.pendingRequests},recommendations:this.generateOptimizationRecommendations(s)};return console.log("📊 Performance Report:",n),this.storePerformanceReport(n),n}calculateCostSavings(e){const a=e*6e-8;return{readsSaved:e,estimatedSavings:`$${a.toFixed(4)}`,monthlyProjection:`$${(a*30).toFixed(2)}`}}generateOptimizationRecommendations(e){const r=[],a=e.metrics.requests>0?e.metrics.hits/e.metrics.requests:0;return a<.7&&r.push({type:"cache_efficiency",priority:"high",message:`Cache hit rate is ${(a*100).toFixed(1)}%. Consider increasing TTL for frequently accessed data.`}),e.memoryItems>5e3&&r.push({type:"memory_usage",priority:"medium",message:`Cache contains ${e.memoryItems} items. Consider implementing more aggressive LRU eviction.`}),Object.entries(e.typeBreakdown||{}).forEach(([s,n])=>{n>1e3&&r.push({type:"cache_overflow",priority:"low",message:`${s} cache has ${n} items. Monitor for potential memory issues.`})}),r}storePerformanceReport(e){try{const r=JSON.parse(localStorage.getItem("optimized_service_reports")||"[]");r.push(e),r.length>30&&r.splice(0,r.length-30),localStorage.setItem("optimized_service_reports",JSON.stringify(r))}catch(r){console.warn("⚠️ Failed to store performance report:",r)}}async healthCheck(){const e={timestamp:new Date().toISOString(),overall:"healthy",services:{}};try{const r=await this.firebaseService.testConnection();e.services.firebase={status:r.success?"healthy":"unhealthy",latency:r.latency,error:r.error};const a="health_check_test",s={test:!0,timestamp:Date.now()};this.cache.set(a,s,"products");const n=await this.cache.get(a,"products",()=>Promise.resolve(s));e.services.cache={status:n?"healthy":"unhealthy",items:this.cache.getCacheStats().memoryItems};try{await this.productService.getFeaturedProducts(1),e.services.products={status:"healthy"}}catch(l){e.services.products={status:"unhealthy",error:l.message}}const o=Object.values(e.services).filter(l=>l.status==="unhealthy");o.length>0&&(e.overall=o.length===Object.keys(e.services).length?"critical":"degraded")}catch(r){e.overall="critical",e.error=r.message}return e}async refreshAllCaches(){console.log("🔄 Refreshing all caches...");try{return this.cache.clear(),this.productService.clearCache(),await this.warmupCaches(),console.log("✅ All caches refreshed successfully"),{success:!0,timestamp:new Date().toISOString()}}catch(e){throw console.error("❌ Failed to refresh caches:",e),e}}getServiceStatistics(){const e=this.cache.getCacheStats();return{timestamp:new Date().toISOString(),uptime:Date.now()-this.performanceMetrics.lastResetTime,cache:e,performance:this.performanceMetrics,products:this.productService.getCacheStats(),isInitialized:this.isInitialized}}enableFallbackMode(){return console.warn("⚠️ Enabling fallback mode - optimizations disabled"),{mode:"fallback",timestamp:new Date().toISOString(),reason:"Emergency fallback activated"}}cleanup(){console.log("🧹 Cleaning up optimized service integration..."),this.cartService.cleanup(),console.log("✅ Cleanup completed")}}let sr=null;function Vo(){return sr||(sr=new qo),sr}async function Yo(){return await Vo().initialize()}class Wo{constructor(){this.errors=[],this.maxErrors=50,this.setupGlobalHandlers()}setupGlobalHandlers(){window.addEventListener("error",r=>{var a;this.logError({type:"javascript",message:r.message,filename:r.filename,lineno:r.lineno,colno:r.colno,error:r.error,stack:(a=r.error)==null?void 0:a.stack,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href})}),window.addEventListener("unhandledrejection",r=>{var a,s;this.logError({type:"promise",message:((a=r.reason)==null?void 0:a.message)||"Unhandled promise rejection",reason:r.reason,stack:(s=r.reason)==null?void 0:s.stack,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href})});const e=console.error;console.error=(...r)=>{const a=r.join(" ");(a.includes("React")||a.includes("Warning:")||a.includes("Error:"))&&this.logError({type:"react",message:a,args:r,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href,stack:new Error().stack}),e.apply(console,r)}}logError(e){this.errors.unshift(e),this.errors.length>this.maxErrors&&(this.errors=this.errors.slice(0,this.maxErrors)),console.group(`🚨 ERROR LOGGED [${e.type.toUpperCase()}]`),console.error("Message:",e.message),console.error("Timestamp:",e.timestamp),console.error("URL:",e.url),e.stack&&console.error("Stack trace:",e.stack),e.filename&&console.error("File:",`${e.filename}:${e.lineno}:${e.colno}`),console.groupEnd();try{localStorage.setItem("app-errors",JSON.stringify(this.errors.slice(0,10)))}catch{}this.shouldReport(e)&&this.reportError(e)}shouldReport(e){return!["Script error","Network request failed","Non-Error promise rejection captured","ResizeObserver loop limit exceeded"].some(a=>{var s;return(s=e.message)==null?void 0:s.toLowerCase().includes(a.toLowerCase())})}async reportError(e){console.log("📊 Would report error to monitoring service:",e.message)}getRecentErrors(e=10){return this.errors.slice(0,e)}clearErrors(){this.errors=[],localStorage.removeItem("app-errors")}showErrorDebugModal(){}}const Jo=new Wo;typeof window<"u"&&(window.errorLogger=Jo);class Qo{constructor(){this.isOfflineMode=!1,this.consecutiveFailures=0,this.maxFailures=3,this.lastFailureTime=0,this.offlineCooldown=5*60*1e3,this.templates={productDescription:["Bu ürün, kaliteli malzeme ve modern tasarımıyla dikkat çeken bir seçenek.","Yüksek performans ve şık tasarımı bir araya getiren bu ürün, kullanıcıların ihtiyaçlarını karşılar.","Dayanıklı yapısı ve kullanım kolaylığıyla öne çıkan bu ürün, uzun ömürlü kulanım sunar.","Teknoloji ve estetik bir araya geldiği bu üründe, kullanıcı deneyimi ön planda.","İhtiyaçlarınızı karşılamak için tasarlanan bu ürün, güvenilir performans sunar."],productTags:[["kaliteli","modern","güvenilir"],["premium","dayanıklı","şık"],["yenilikçi","pratik","fonksiyonel"],["trend","teknolojik","kullanışlı"],["popüler","özel","tercih edilen"]],visualSearch:["Bu görselde benzer ürünler tespit edildi. Kategori ve renk özelliklerine göre eşleştirme yapıldı.","Görsel analizi tamamlandı. Benzer tasarım özelliklerine sahip ürünler bulundu.","Görüntü işleme sonucu: Ürün kategorisi ve stil özellikleri belirlendi."],recommendations:["Kullanım geçmişiniz ve tercihlerinize göre bu ürünler önerilmektedir.","Benzer ürünleri inceleyen kullanıcılar bu seçenekleri de beğendi.","Size özel seçilmiş bu ürünler, ilgi alanlarınıza uygun olarak belirlendi."]}}recordFailure(){this.consecutiveFailures++,this.lastFailureTime=Date.now(),this.consecutiveFailures>=this.maxFailures&&(console.log("🔄 Gemini API offline mode aktif edildi"),this.isOfflineMode=!0)}recordSuccess(){this.consecutiveFailures=0,this.isOfflineMode&&(console.log("✅ Gemini API yeniden aktif"),this.isOfflineMode=!1)}shouldUseOfflineMode(){return this.isOfflineMode&&Date.now()-this.lastFailureTime>this.offlineCooldown&&(console.log("🔄 Offline cooldown tamamlandı, API tekrar denenecek"),this.isOfflineMode=!1,this.consecutiveFailures=0),this.isOfflineMode}generateOfflineDescription(e){const r=this.getRandomTemplate("productDescription"),a=e.category||"ürün",s=e.brand||"marka";return{text:`${r} ${s} markasının bu ${a} kategorisindeki ürünü, ${e.price?e.price+" TL fiyatıyla":""} kullanıcıların beğenisini kazanmaktadır.`,isOffline:!0,finishReason:"STOP"}}generateOfflineTags(e){const r=this.getRandomTemplate("productTags"),a=this.getCategoryTags(e.category),s=e.brand?[e.brand.toLowerCase()]:[];return{text:JSON.stringify([...r,...a,...s].slice(0,6)),isOffline:!0,finishReason:"STOP"}}generateOfflineVisualSearch(e=[]){const r=this.getRandomTemplate("visualSearch"),a=e.slice(0,4).map(s=>({...s,matchReason:"Kategori ve görsel özelliklere göre eşleşti"}));return{text:r,matchedProducts:a,confidence:.75,isOffline:!0}}generateOfflineRecommendations(e={}){return{text:this.getRandomTemplate("recommendations"),isOffline:!0,finishReason:"STOP"}}getRandomTemplate(e){const r=this.templates[e];return r[Math.floor(Math.random()*r.length)]}getCategoryTags(e){return{elektronik:["teknoloji","digital","modern"],giyim:["moda","stil","trend"],"ev-yasam":["ev","konfor","yaşam"],spor:["aktif","sağlık","performans"],kitap:["bilgi","eğitim","kültür"],oyuncak:["eğlence","çocuk","oyun"]}[e]||["kalite","ürün"]}getStatus(){return{isOffline:this.isOfflineMode,consecutiveFailures:this.consecutiveFailures,nextRetryTime:this.lastFailureTime+this.offlineCooldown,canRetryIn:Math.max(0,this.lastFailureTime+this.offlineCooldown-Date.now())}}forceOnlineMode(){console.log("🔄 Manuel olarak online moda geçildi"),this.isOfflineMode=!1,this.consecutiveFailures=0,this.lastFailureTime=0}}const pe=new Qo,Xo=({className:i=""})=>{const[e,r]=p.useState(pe.getStatus()),[a,s]=p.useState(!1);p.useEffect(()=>{const l=setInterval(()=>{r(pe.getStatus())},5e3);return()=>clearInterval(l)},[]);const n=()=>{pe.forceOnlineMode(),r(pe.getStatus())},o=l=>l<=0?"Şimdi":`${Math.ceil(l/(1e3*60))} dakika`;return e.isOffline?t.jsxs("div",{className:`${i}`,children:[t.jsxs("div",{className:"flex items-center text-orange-600 text-xs cursor-pointer",onClick:()=>s(!a),children:[t.jsx(Hr,{size:14,className:"mr-1"}),t.jsx("span",{children:"AI Offline"}),e.canRetryIn>0&&t.jsx(Bt,{size:12,className:"ml-1"})]}),a&&t.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg p-3 z-50 min-w-64",children:t.jsxs("div",{className:"text-xs text-gray-700 space-y-2",children:[t.jsxs("div",{className:"flex items-center text-orange-600 font-medium",children:[t.jsx(Hr,{size:14,className:"mr-2"}),"AI Servisi Geçici Olarak Kullanılamıyor"]}),t.jsxs("div",{className:"text-gray-600",children:[t.jsxs("p",{children:["• Ardışık ",e.consecutiveFailures," hata nedeniyle offline mode aktif"]}),e.canRetryIn>0?t.jsxs("p",{children:["• Otomatik yeniden deneme: ",o(e.canRetryIn)]}):t.jsx("p",{className:"text-green-600",children:"• Yeniden deneme için hazır"})]}),t.jsxs("div",{className:"bg-blue-50 p-2 rounded text-xs",children:[t.jsx("p",{className:"text-blue-800 font-medium",children:"Bu sürada:"}),t.jsx("p",{className:"text-blue-700",children:"• Yerel AI benzeri özellikler kullanılıyor"}),t.jsx("p",{className:"text-blue-700",children:"• Önbellekteki veriler gösteriliyor"})]}),t.jsxs("button",{onClick:n,className:"flex items-center w-full px-3 py-2 bg-blue-100 text-blue-800 rounded hover:bg-blue-200 transition-colors text-xs",children:[t.jsx(Qe,{size:12,className:"mr-1"}),"Manuel Yeniden Dene"]})]})})]}):t.jsxs("div",{className:`flex items-center text-green-600 text-xs ${i}`,children:[t.jsx(As,{size:14,className:"mr-1"}),t.jsx("span",{children:"AI Aktif"})]})},Zo=()=>{var j,T,D,I,v,w,y,P,N;const{state:i,dispatch:e,actionTypes:r}=ae(),{isDarkMode:a,sidebarOpen:s,notifications:n,user:o}=i,{logout:l,isAuthenticated:c}=Et(),d=Ht(),[u,h]=p.useState(!1),g=p.useRef(null),x=()=>{e({type:r.TOGGLE_SIDEBAR})},k=()=>{e({type:r.TOGGLE_DARK_MODE})},f=async()=>{try{await l(),e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"info",message:"Başarıyla çıkış yapıldı.",duration:3e3}}),d("/login")}catch{e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Çıkış yapılırken hata oluştu.",duration:3e3}})}h(!1)},E=()=>{d("/login")};return p.useEffect(()=>{const S=b=>{g.current&&!g.current.contains(b.target)&&h(!1)};return document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[]),t.jsx("header",{className:"fixed top-0 left-0 right-0 h-16 bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg border-b border-gray-200/50 dark:border-gray-700/50 z-40 shadow-sm",children:t.jsxs("div",{className:"flex items-center justify-between h-full px-4 lg:px-6",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(m.button,{onClick:x,className:"p-2 rounded-xl text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100/70 dark:hover:bg-gray-700/70 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500/30",whileHover:{scale:1.05},whileTap:{scale:.95},children:t.jsx(m.div,{animate:{rotate:s?180:0},transition:{duration:.3,ease:"easeInOut"},children:t.jsx(Es,{className:"w-5 h-5"})})}),t.jsx(ie,{to:"/",children:t.jsx(m.h1,{className:"text-xl font-bold bg-gradient-to-r from-primary-600 via-accent-500 to-primary-600 bg-clip-text text-transparent hidden sm:block cursor-pointer",whileHover:{scale:1.02},children:"ShopSmart"})}),t.jsx(ie,{to:"/",children:t.jsx(m.h1,{className:"text-lg font-bold bg-gradient-to-r from-primary-600 to-accent-500 bg-clip-text text-transparent sm:hidden cursor-pointer",whileHover:{scale:1.02},children:"ShopSmart"})})]}),t.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[t.jsx("div",{className:"relative",children:t.jsx(Xo,{})}),t.jsx(m.button,{onClick:k,className:"p-2 rounded-xl text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100/70 dark:hover:bg-gray-700/70 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500/30",whileHover:{scale:1.05,rotate:180},whileTap:{scale:.95},children:t.jsx(oe,{mode:"wait",children:a?t.jsx(m.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:0},exit:{opacity:0,rotate:180},transition:{duration:.3},children:t.jsx(Ts,{className:"w-5 h-5"})},"sun"):t.jsx(m.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:0},exit:{opacity:0,rotate:180},transition:{duration:.3},children:t.jsx(Is,{className:"w-5 h-5"})},"moon")})}),t.jsxs(m.button,{className:"relative p-2 rounded-xl text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100/70 dark:hover:bg-gray-700/70 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500/30",whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(Rs,{className:"w-5 h-5"}),t.jsx(oe,{children:n.length>0&&t.jsx(m.span,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},className:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-[8px] font-bold text-white",children:n.length>9?"9+":n.length})})})]}),c?t.jsxs("div",{className:"relative",ref:g,children:[t.jsxs(m.button,{onClick:()=>h(!u),className:"flex items-center space-x-2 p-2 rounded-xl text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100/70 dark:hover:bg-gray-700/70 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500/30",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsxs("div",{className:"relative",children:[(j=o==null?void 0:o.profile)!=null&&j.photoURL?t.jsx(m.img,{src:o.profile.photoURL,alt:o.profile.displayName||o.profile.email,className:"w-7 h-7 rounded-full ring-2 ring-primary-200 dark:ring-primary-800",whileHover:{scale:1.1}}):t.jsx(m.div,{className:"w-7 h-7 rounded-full bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center",whileHover:{scale:1.1},children:t.jsx(Ke,{className:"w-4 h-4 text-white"})}),t.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-800"})]}),t.jsx("span",{className:"hidden lg:block text-sm font-medium max-w-24 truncate",children:((T=o==null?void 0:o.profile)==null?void 0:T.displayName)||((D=o==null?void 0:o.profile)==null?void 0:D.firstName)||"Kullanıcı"})]}),t.jsx(oe,{children:u&&t.jsx(m.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.2,ease:"easeOut"},className:"absolute right-0 mt-2 w-56 bg-white/90 dark:bg-gray-800/90 backdrop-blur-xl rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 z-50 overflow-hidden",children:t.jsxs("div",{className:"py-2",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200/50 dark:border-gray-700/50",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"relative",children:[(I=o==null?void 0:o.profile)!=null&&I.photoURL?t.jsx("img",{src:o.profile.photoURL,alt:o.profile.displayName||o.profile.email,className:"w-10 h-10 rounded-full"}):t.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center",children:t.jsx(Ke,{className:"w-5 h-5 text-white"})}),t.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-800"})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-semibold text-gray-900 dark:text-white truncate",children:((v=o==null?void 0:o.profile)==null?void 0:v.displayName)||`${(w=o==null?void 0:o.profile)==null?void 0:w.firstName} ${(y=o==null?void 0:o.profile)==null?void 0:y.lastName}`.trim()||"Kullanıcı"}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:((P=o==null?void 0:o.profile)==null?void 0:P.email)||"user@example.com"}),!((N=o==null?void 0:o.profile)!=null&&N.emailVerified)&&t.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:"E-posta doğrulanmadı"})]})]})}),t.jsxs(m.button,{onClick:()=>{h(!1),d("/profile")},className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100/70 dark:hover:bg-gray-700/70 transition-all duration-200",whileHover:{x:4},children:[t.jsx(Ke,{className:"w-4 h-4 mr-3 text-gray-400"}),"Profil"]}),t.jsxs(m.button,{onClick:f,className:"flex items-center w-full px-4 py-3 text-sm text-red-600 dark:text-red-400 hover:bg-red-50/70 dark:hover:bg-red-900/20 transition-all duration-200",whileHover:{x:4},children:[t.jsx(Ps,{className:"w-4 h-4 mr-3"}),"Çıkış Yap"]})]})})})]}):t.jsxs(m.button,{onClick:E,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-primary-600 to-accent-600 hover:from-primary-700 hover:to-accent-700 text-white font-medium rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500/30",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(Ke,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:block",children:"Giriş Yap"})]})]})]})})},el=()=>{var l,c;const{state:i,dispatch:e,actionTypes:r}=ae(),{sidebarOpen:a}=i,s=gt(),n=[{id:"home",name:"Ana Sayfa",href:Se.HOME,icon:Sr},{id:"products",name:"Ürünler",href:Se.PRODUCTS,icon:rt},{id:"categories",name:"Kategoriler",href:Se.CATEGORIES,icon:Cr},{id:"cart",name:"Sepet",href:Se.CART,icon:at,badge:((c=(l=i.cart)==null?void 0:l.items)==null?void 0:c.length)||0},{id:"visual-search",name:"AI Görsel Arama",href:Se.VISUAL_SEARCH,icon:Je,isAI:!0},{id:"recommendations",name:"Akıllı Öneriler",href:Se.RECOMMENDATIONS,icon:ge,isAI:!0},{id:"complementary-products",name:"Tamamlayıcı Ürünler",href:Se.COMPLEMENTARY_PRODUCTS,icon:xe,isAI:!0},{id:"profile-questionnaire",name:"AI Profil Anketi",href:"/profile/questionnaire",icon:We,isAI:!0}],o=d=>d===Se.HOME?s.pathname===d:s.pathname.startsWith(d);return t.jsxs(t.Fragment,{children:[a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>e({type:r.TOGGLE_SIDEBAR})}),t.jsxs("aside",{className:`fixed left-0 top-16 bottom-0 w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 z-40 overflow-y-auto transition-transform duration-300 ${a?"translate-x-0":"-translate-x-full"}`,children:[t.jsx("div",{className:"p-4",children:t.jsx("nav",{className:"space-y-1 mb-6",children:n.map(d=>t.jsxs(ie,{to:d.href,className:`flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors duration-200 ${o(d.href)?"bg-primary-100 dark:bg-primary-900/20 text-primary-700 dark:text-primary-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:u=>{},children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(d.icon,{className:"w-5 h-5 mr-3"}),d.name]}),d.badge>0&&t.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-1 min-w-[20px] text-center",children:d.badge})]},d.id))})}),t.jsx("button",{onClick:()=>e({type:r.TOGGLE_SIDEBAR}),className:"absolute top-4 -right-3 w-6 h-6 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full flex items-center justify-center shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200",children:t.jsx(Ca,{className:"w-3 h-3 text-gray-600 dark:text-gray-400"})})]})]})},tl=()=>t.jsx("footer",{className:"mt-12 py-8 border-t border-gray-200 dark:border-gray-700",children:t.jsx("div",{className:"max-w-7xl mx-auto px-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[t.jsxs("div",{className:"flex items-center space-x-4 mb-4 md:mb-0",children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"© 2025 ShopSmart - Akıllı E-Ticaret Platformu"}),t.jsx("span",{className:"text-gray-300 dark:text-gray-600",children:"•"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"BTK Akademi Hackathon 2025 için geliştirildi - Türkiye"})]}),t.jsx("div",{className:"flex items-center space-x-4",children:t.jsxs("a",{href:"https://ai.google.dev/gemini-api",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors duration-200",children:[t.jsx("span",{children:"Google Gemini AI ile güçlendirildi"}),t.jsx(Os,{className:"w-3 h-3"})]})})]})})}),rl=()=>{var s,n;const{state:i}=ae(),e=gt(),r=[{id:"home",name:"Ana Sayfa",href:Se.HOME,icon:Sr},{id:"products",name:"Ürünler",href:Se.PRODUCTS,icon:rt},{id:"cart",name:"Sepet",href:Se.CART,icon:at,badge:((n=(s=i.cart)==null?void 0:s.items)==null?void 0:n.length)||0}],a=o=>o===Se.HOME?e.pathname===o:e.pathname.startsWith(o);return t.jsxs("div",{className:"lg:hidden",children:[t.jsx(m.nav,{className:"fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm border-t border-gray-200 dark:border-gray-700 z-40 safe-area-pb",initial:{y:100},animate:{y:0},transition:{duration:.3},children:t.jsx("div",{className:"flex items-center justify-around px-2 py-2",children:r.map(o=>{const l=a(o.href);return t.jsxs(ie,{to:o.href,className:"relative flex flex-col items-center justify-center min-w-0 flex-1 px-1 py-2 group ",onClick:c=>{},children:[t.jsx(oe,{children:l&&t.jsx(m.div,{className:"absolute inset-0 bg-primary-50 dark:bg-primary-900/20 rounded-xl",layoutId:"activeTab",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2}})}),t.jsxs("div",{className:"relative",children:[t.jsx(m.div,{className:`p-1 transition-colors duration-200 ${l?"text-primary-600 dark:text-primary-400":"text-gray-600 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-gray-100"}`,whileTap:{scale:.9},animate:{scale:l?1.1:1},transition:{duration:.2},children:t.jsx(o.icon,{className:"w-6 h-6"})}),o.badge>0&&t.jsx(m.span,{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-medium",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:o.badge>99?"99+":o.badge})]}),t.jsx("span",{className:`text-xs font-medium mt-1 transition-colors duration-200 ${l?"text-primary-600 dark:text-primary-400":"text-gray-600 dark:text-gray-400"}`,children:o.name})]},o.id)})})}),t.jsx("div",{className:"h-20"})]})};function al(){const{dispatch:i,actionTypes:e}=ae(),r=()=>{i({type:e.HIDE_WELCOME})},a=()=>{i({type:e.HIDE_WELCOME})};return t.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:[t.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[t.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-r from-blue-400/20 to-purple-400/20 rounded-full mix-blend-multiply filter blur-xl animate-pulse"}),t.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-r from-purple-400/20 to-pink-400/20 rounded-full mix-blend-multiply filter blur-xl animate-pulse animation-delay-2000"}),t.jsx("div",{className:"absolute top-40 left-1/2 w-60 h-60 bg-gradient-to-r from-cyan-400/20 to-blue-400/20 rounded-full mix-blend-multiply filter blur-xl animate-pulse animation-delay-4000"})]}),t.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((s,n)=>t.jsx("div",{className:"absolute w-2 h-2 bg-blue-400/30 rounded-full animate-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,animationDuration:`${3+Math.random()*2}s`}},n))}),t.jsxs("div",{className:"max-w-4xl w-full relative z-10",children:[t.jsx("div",{className:"text-center mb-12",children:t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full mb-6 relative shadow-2xl transform hover:scale-110 transition-all duration-300",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full animate-ping opacity-20"}),t.jsx("svg",{className:"w-10 h-10 text-white relative z-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})]}),t.jsxs("h1",{className:"text-5xl font-bold text-gray-900 dark:text-white mb-4 animate-fade-in-up",children:["Hoş Geldiniz ",t.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent animate-gradient-x",children:"AI E-Ticaret"})]}),t.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto animate-fade-in-up animation-delay-200",children:"Yapay zeka destekli akıllı alışveriş deneyimi ile geleceğin e-ticaret platformunu keşfedin. Kişiselleştirilmiş öneriler, hızlı arama ve kolay alışveriş."})]})}),t.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mb-12",children:[t.jsxs("div",{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-gray-200/50 dark:border-gray-700/50 hover:transform hover:scale-105 hover:shadow-2xl transition-all duration-300 animate-fade-in-up animation-delay-400",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900 dark:to-blue-800 rounded-lg flex items-center justify-center mb-4 shadow-lg hover:shadow-xl transition-shadow duration-300",children:t.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400 hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"AI Alışveriş Asistanı"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Akıllı AI asistanı ile ürün araması yapın, önerileri keşfedin ve sorularınızı sorun."})]}),t.jsxs("div",{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-gray-200/50 dark:border-gray-700/50 hover:transform hover:scale-105 hover:shadow-2xl transition-all duration-300 animate-fade-in-up animation-delay-600",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-100 to-purple-200 dark:from-purple-900 dark:to-purple-800 rounded-lg flex items-center justify-center mb-4 shadow-lg hover:shadow-xl transition-shadow duration-300",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600 dark:text-purple-400 hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Akıllı Ürün Kataloğu"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Binlerce ürün arasında AI destekli arama ile istediğinizi kolayca bulun ve karşılaştırın."})]}),t.jsxs("div",{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-gray-200/50 dark:border-gray-700/50 hover:transform hover:scale-105 hover:shadow-2xl transition-all duration-300 animate-fade-in-up animation-delay-800",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900 dark:to-green-800 rounded-lg flex items-center justify-center mb-4 shadow-lg hover:shadow-xl transition-shadow duration-300",children:t.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400 hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Kişisel Öneriler"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Alışveriş geçmişinize ve tercihlerinize göre size özel ürün önerileri alın."})]})]}),t.jsxs("div",{className:"text-center animate-fade-in-up animation-delay-1000",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[t.jsxs("button",{onClick:r,className:"group px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-purple-700 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-2xl relative overflow-hidden",children:[t.jsxs("span",{className:"relative z-10 flex items-center",children:["Alışverişe Başla",t.jsx("svg",{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-700 to-purple-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),t.jsx("button",{onClick:a,className:"group px-8 py-4 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm text-gray-900 dark:text-white font-semibold rounded-xl border-2 border-gray-300/50 dark:border-gray-600/50 hover:border-blue-500 dark:hover:border-blue-400 hover:bg-white dark:hover:bg-gray-800 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl",children:t.jsxs("span",{className:"flex items-center",children:["Giriş Yap",t.jsx("svg",{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})})]})})]}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4",children:"Ücretsiz başlayın • Kredi kartı gerektirmez • AI destekli alışveriş deneyimi"})]}),t.jsxs("div",{className:"mt-16 grid grid-cols-1 md:grid-cols-4 gap-6 text-center",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mb-2",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Güvenli & Gizli"})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mb-2",children:t.jsx("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z",clipRule:"evenodd"})})}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Hızlı Arama"})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:"w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center mb-2",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600 dark:text-purple-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Kolay Kullanım"})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:"w-8 h-8 bg-yellow-100 dark:bg-yellow-900 rounded-full flex items-center justify-center mb-2",children:t.jsx("svg",{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Kaliteli Ürünler"})]})]})]})]})}function sl(){const{dispatch:i,actionTypes:e}=ae(),{login:r,register:a,loading:s,error:n,clearError:o}=Et(),l=Ht(),[c,d]=p.useState({email:"",password:"",displayName:"",firstName:"",lastName:"",rememberMe:!1}),[u,h]=p.useState(!1),[g,x]=p.useState(!1),k=E=>{const{name:j,value:T,type:D,checked:I}=E.target;d(v=>({...v,[j]:D==="checkbox"?I:T}))},f=async E=>{E.preventDefault(),o();try{u?(await a({email:c.email,password:c.password,displayName:c.displayName,firstName:c.firstName,lastName:c.lastName}),i({type:e.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:"Hesap başarıyla oluşturuldu! E-posta doğrulama linki gönderildi.",duration:5e3}}),setTimeout(()=>{l("/")},2e3)):(await r(c.email,c.password),i({type:e.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:"Başarıyla giriş yapıldı!",duration:3e3}}),setTimeout(()=>{l("/")},1500))}catch(j){i({type:e.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:j.message,duration:5e3}})}};return t.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:[t.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[t.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-r from-blue-400/10 to-purple-400/10 rounded-full mix-blend-multiply filter blur-xl animate-pulse"}),t.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-r from-purple-400/10 to-pink-400/10 rounded-full mix-blend-multiply filter blur-xl animate-pulse animation-delay-2000"}),t.jsx("div",{className:"absolute top-1/3 left-1/4 w-40 h-40 bg-gradient-to-r from-cyan-400/10 to-blue-400/10 rounded-full mix-blend-multiply filter blur-xl animate-pulse animation-delay-4000"})]}),t.jsx("div",{className:"absolute inset-0",children:[...Array(15)].map((E,j)=>t.jsx("div",{className:"absolute w-1 h-1 bg-blue-400/20 rounded-full animate-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,animationDuration:`${4+Math.random()*2}s`}},j))}),t.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10",children:[t.jsxs("div",{className:"text-center animate-fade-in-up",children:[t.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full mb-6 relative shadow-2xl transform hover:scale-110 transition-all duration-300",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full animate-ping opacity-20"}),t.jsx("svg",{className:"w-8 h-8 text-white relative z-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})]}),t.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white animate-fade-in-up animation-delay-200",children:u?"Hesap Oluşturun":"Tekrar Hoş Geldiniz"}),t.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400 animate-fade-in-up animation-delay-300",children:u?"AI destekli alışveriş deneyiminizi başlatın":"Hesabınıza giriş yapın"})]}),t.jsxs("div",{className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-xl shadow-2xl p-8 border border-gray-200/50 dark:border-gray-700/50 hover:shadow-3xl transition-all duration-300 animate-fade-in-up animation-delay-400",children:[n&&t.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 rounded-lg text-sm",children:n}),t.jsxs("form",{onSubmit:f,className:"space-y-6",children:[u&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Ad"}),t.jsx("input",{id:"firstName",name:"firstName",type:"text",required:!0,value:c.firstName,onChange:k,className:"w-full px-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700/50 dark:text-white transition-all duration-300 backdrop-blur-sm hover:border-blue-400 dark:hover:border-blue-400",placeholder:"Adınızı girin"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Soyad"}),t.jsx("input",{id:"lastName",name:"lastName",type:"text",required:!0,value:c.lastName,onChange:k,className:"w-full px-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700/50 dark:text-white transition-all duration-300 backdrop-blur-sm hover:border-blue-400 dark:hover:border-blue-400",placeholder:"Soyadınızı girin"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Görünen Ad"}),t.jsx("input",{id:"displayName",name:"displayName",type:"text",value:c.displayName,onChange:k,className:"w-full px-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700/50 dark:text-white transition-all duration-300 backdrop-blur-sm hover:border-blue-400 dark:hover:border-blue-400",placeholder:"Görünen adınızı girin"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"E-posta Adresi"}),t.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:c.email,onChange:k,className:"w-full px-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700/50 dark:text-white transition-all duration-300 backdrop-blur-sm hover:border-blue-400 dark:hover:border-blue-400",placeholder:"E-posta adresinizi girin"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Şifre"}),t.jsx("input",{id:"password",name:"password",type:"password",autoComplete:u?"new-password":"current-password",required:!0,value:c.password,onChange:k,className:"w-full px-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700/50 dark:text-white transition-all duration-300 backdrop-blur-sm hover:border-blue-400 dark:hover:border-blue-400",placeholder:u?"En az 6 karakter":"Şifrenizi girin"})]}),!u&&t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{id:"rememberMe",name:"rememberMe",type:"checkbox",checked:c.rememberMe,onChange:k,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),t.jsx("label",{htmlFor:"rememberMe",className:"ml-2 block text-sm text-gray-900 dark:text-gray-300",children:"Remember me"})]}),t.jsx("button",{type:"button",className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 transition-colors",children:"Forgot password?"})]}),t.jsx("button",{type:"submit",disabled:s,className:"group w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-lg text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-[1.02] transition-all duration-300 hover:shadow-xl relative overflow-hidden",children:s?t.jsxs("div",{className:"flex items-center",children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u?"Hesap oluşturuluyor...":"Giriş yapılıyor..."]}):u?"Hesap Oluştur":"Giriş Yap"})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsx("button",{type:"button",onClick:()=>{h(!u),o(),d({email:"",password:"",displayName:"",firstName:"",lastName:"",rememberMe:!1})},className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 transition-colors",children:u?"Zaten hesabınız var mı? Giriş yapın":"Hesabınız yok mu? Kayıt olun"})})]}),t.jsxs("div",{className:"text-center text-xs text-gray-500 dark:text-gray-400",children:["By continuing, you agree to our"," ",t.jsx("button",{className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Terms of Service"})," ","and"," ",t.jsx("button",{className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Privacy Policy"})]})]})]})}class il{constructor(){this.products=_e,this.categories=ps,this.useFirebase=!1,this.optimizedService=zr()}async getProducts(e={}){const{page:r=1,limit:a=K.ITEMS_PER_PAGE,category:s,brand:n,minPrice:o,maxPrice:l,sortBy:c="name",sortOrder:d="asc",search:u}=e;if(console.log("ProductService: useFirebase flag:",this.useFirebase),this.useFirebase)try{console.log("🚀 Using optimized product service for getProducts");const f={page:r,limit:a,category:s,brand:n,minPrice:o,maxPrice:l,sortBy:c,sortOrder:d,search:u},E=await this.optimizedService.getProducts(f);return{products:E.products,pagination:{currentPage:E.pagination.page,totalPages:Math.ceil(E.pagination.total/E.pagination.limit),totalItems:E.pagination.total,itemsPerPage:a,hasNextPage:E.pagination.hasMore,hasPrevPage:r>1},fromOptimized:!0}}catch(f){console.error("Error fetching from Firebase, falling back to local data:",f),this.useFirebase=!1}let h=[...this.products];if(s&&(h=h.filter(f=>f.category===s)),n&&(h=h.filter(f=>f.brand===n)),o!==void 0&&(h=h.filter(f=>f.price>=o)),l!==void 0&&(h=h.filter(f=>f.price<=l)),u){const f=u.toLowerCase();h=h.filter(E=>E.name.toLowerCase().includes(f)||E.description.toLowerCase().includes(f)||E.brand.toLowerCase().includes(f)||E.tags.some(j=>j.toLowerCase().includes(f)))}h.sort((f,E)=>{let j=f[c],T=E[c];return c==="price"&&(j=parseFloat(j),T=parseFloat(T)),d==="desc"?T>j?1:-1:j>T?1:-1});const g=(r-1)*a,x=g+a;return{products:h.slice(g,x),pagination:{currentPage:r,totalPages:Math.ceil(h.length/a),totalItems:h.length,itemsPerPage:a,hasNextPage:x<h.length,hasPrevPage:r>1}}}async getProduct(e){if(this.useFirebase)try{console.log("🚀 Using optimized service for getProduct");const a=await this.optimizedService.getProduct(e);if(!a)throw console.log(`Product not found with optimized service for ID: ${e}`),new Error("Product not found");const s=await this.getRelatedProducts(a.firebaseId||a.id);return{...a,relatedProducts:s}}catch(a){console.error("Error fetching product from Firebase, falling back to local:",a),this.useFirebase=!1}const r=Lr(e);if(!r)throw new Error("Product not found");return await new Promise(a=>setTimeout(a,100)),{...r,relatedProducts:Dt(e)}}async getProductBySlug(e){if(this.useFirebase)try{const s=(await we.getAllProducts()).find(o=>o.slug===e);if(!s)throw new Error("Product not found");const n=await this.getRelatedProducts(s.firebaseId||s.id);return{...s,relatedProducts:n}}catch(a){console.error("Error fetching product by slug from Firebase, falling back to local:",a),this.useFirebase=!1}const r=ys(e);if(!r)throw new Error("Product not found");return await new Promise(a=>setTimeout(a,100)),{...r,relatedProducts:Dt(r.id)}}async getFeaturedProducts(e=6){if(this.useFirebase)try{return console.log("🚀 Using optimized service for getFeaturedProducts"),await this.optimizedService.getFeaturedProducts(e)}catch(r){console.error("Error fetching featured products from optimized service, falling back to local:",r),this.useFirebase=!1}return await new Promise(r=>setTimeout(r,50)),fs(e)}async getDiscountedProducts(e=6){if(this.useFirebase)try{return await we.getDiscountedProducts(e)}catch(r){console.error("Error fetching discounted products from Firebase, falling back to local:",r),this.useFirebase=!1}return await new Promise(r=>setTimeout(r,50)),bs(e)}async getProductsByCategory(e,r){if(this.useFirebase)try{return await we.getProductsByCategory(e,r)}catch(s){console.error("Error fetching products by category from Firebase, falling back to local:",s),this.useFirebase=!1}await new Promise(s=>setTimeout(s,50));const a=xs(e);return r?a.slice(0,r):a}async searchProducts(e){if(!e||e.trim().length<2)return[];if(this.useFirebase)try{return await we.searchProducts(e)}catch(r){console.error("Error searching products in Firebase, falling back to local:",r),this.useFirebase=!1}return await new Promise(r=>setTimeout(r,200)),$t(e)}async getCategories(){if(this.useFirebase)try{const e=await we.getAllProducts();return Object.entries(this.categories).map(([r,a])=>({id:r,...a,productCount:e.filter(s=>s.category===r).length}))}catch(e){console.error("Error getting categories from Firebase, falling back to local:",e),this.useFirebase=!1}return await new Promise(e=>setTimeout(e,50)),Object.entries(this.categories).map(([e,r])=>({id:e,...r,productCount:this.products.filter(a=>a.category===e).length}))}async getBrands(){if(this.useFirebase)try{const r=await we.getAllProducts();return[...new Set(r.map(s=>s.brand))].map(s=>({name:s,productCount:r.filter(n=>n.brand===s).length}))}catch(r){console.error("Error getting brands from Firebase, falling back to local:",r),this.useFirebase=!1}return await new Promise(r=>setTimeout(r,50)),[...new Set(this.products.map(r=>r.brand))].map(r=>({name:r,productCount:this.products.filter(a=>a.brand===r).length}))}async getPriceRange(){if(this.useFirebase)try{const a=(await we.getAllProducts()).map(s=>s.price);return{min:Math.min(...a),max:Math.max(...a)}}catch(r){console.error("Error getting price range from Firebase, falling back to local:",r),this.useFirebase=!1}const e=this.products.map(r=>r.price);return{min:Math.min(...e),max:Math.max(...e)}}async getProductReviews(e,r=1,a=10){await new Promise(d=>setTimeout(d,100));const s=await this.getProduct(e);if(!s)throw new Error("Product not found");const n=Array.from({length:s.reviewCount},(d,u)=>({id:u+1,userId:`user_${u+1}`,userName:`User ${u+1}`,userAvatar:`https://ui-avatars.com/api/?name=User+${u+1}&background=random`,rating:Math.floor(Math.random()*2)+4,title:`Great product ${u+1}`,comment:`This is a sample review comment for product ${e}. The product quality is excellent and I would recommend it.`,date:new Date(Date.now()-Math.random()*90*24*60*60*1e3).toISOString(),helpful:Math.floor(Math.random()*20),verified:Math.random()>.3})),o=(r-1)*a,l=o+a;return{reviews:n.slice(o,l),pagination:{currentPage:r,totalPages:Math.ceil(n.length/a),totalItems:n.length,itemsPerPage:a},averageRating:s.rating,ratingDistribution:{5:Math.floor(s.reviewCount*.6),4:Math.floor(s.reviewCount*.25),3:Math.floor(s.reviewCount*.1),2:Math.floor(s.reviewCount*.03),1:Math.floor(s.reviewCount*.02)}}}async checkAvailability(e,r=1){try{const a=await this.getProduct(e);if(!a)throw new Error("Product not found");return{available:a.stock>=r,stock:a.stock,maxQuantity:Math.min(a.stock,K.MAX_CART_ITEMS)}}catch(a){throw console.error("Error checking product availability:",a),new Error("Product not found")}}async getRelatedProducts(e,r=4){if(this.useFirebase)try{const a=await we.getAllProducts(),s=a.find(n=>{var o,l;return((o=n.firebaseId)==null?void 0:o.toString())===(e==null?void 0:e.toString())||((l=n.id)==null?void 0:l.toString())===(e==null?void 0:e.toString())});return s?a.filter(n=>n.firebaseId!==e&&n.id!==e&&(n.category===s.category||n.brand===s.brand||n.tags&&s.tags&&n.tags.some(o=>s.tags.includes(o)))).slice(0,r):[]}catch(a){console.error("Error fetching related products from Firebase, falling back to local:",a),this.useFirebase=!1}return Dt(e,r)}async getRecommendations(e,r,a="similar"){switch(await new Promise(s=>setTimeout(s,200)),a){case"similar":return await this.getRelatedProducts(r,6);case"frequently_bought":if(this.useFirebase)try{return(await we.getAllProducts()).filter(n=>n.firebaseId!==r&&n.id!==r).sort(()=>.5-Math.random()).slice(0,4)}catch(s){console.error("Error fetching products for recommendations:",s)}return this.products.filter(s=>s.id!==r).sort(()=>.5-Math.random()).slice(0,4);case"recently_viewed":if(this.useFirebase)try{return(await we.getAllProducts()).sort(()=>.5-Math.random()).slice(0,6)}catch(s){console.error("Error fetching products for recommendations:",s)}return this.products.sort(()=>.5-Math.random()).slice(0,6);default:return[]}}}const Q=new il;class bt{static async getUserCart(e){try{if(!e)return null;const r=Z(F,this.collectionName),a=J(r,H("userId","==",e)),s=await ne(a);if(s.empty)return await this.createUserCart(e);const n=s.docs[0];return{id:n.id,...n.data()}}catch(r){throw console.error("Error getting user cart:",r),r}}static async createUserCart(e){try{const r={userId:e,items:[],totalItems:0,totalPrice:0,createdAt:new Date,updatedAt:new Date};return{id:(await ct(Z(F,this.collectionName),r)).id,...r}}catch(r){throw console.error("Error creating user cart:",r),r}}static async addItem(e,r,a=1,s={}){try{const n=await this.getUserCart(e),o=n.items.findIndex(l=>l.productId===r&&JSON.stringify(l.selectedVariants)===JSON.stringify(s));return o>=0?n.items[o].quantity+=a:n.items.push({productId:r,quantity:a,selectedVariants:s,addedAt:new Date}),n.totalItems=n.items.reduce((l,c)=>l+c.quantity,0),n.updatedAt=new Date,await Re(re(F,this.collectionName,n.id),{items:n.items,totalItems:n.totalItems,updatedAt:n.updatedAt}),n}catch(n){throw console.error("Error adding item to cart:",n),n}}static async updateItemQuantity(e,r,a,s={}){try{const n=await this.getUserCart(e),o=n.items.findIndex(l=>l.productId===r&&JSON.stringify(l.selectedVariants)===JSON.stringify(s));return o>=0&&(a<=0?n.items.splice(o,1):n.items[o].quantity=a,n.totalItems=n.items.reduce((l,c)=>l+c.quantity,0),n.updatedAt=new Date,await Re(re(F,this.collectionName,n.id),{items:n.items,totalItems:n.totalItems,updatedAt:n.updatedAt})),n}catch(n){throw console.error("Error updating item quantity:",n),n}}static async removeItem(e,r,a={}){try{return await this.updateItemQuantity(e,r,0,a)}catch(s){throw console.error("Error removing item from cart:",s),s}}static async clearCart(e){try{const r=await this.getUserCart(e);return await Re(re(F,this.collectionName,r.id),{items:[],totalItems:0,totalPrice:0,updatedAt:new Date}),{...r,items:[],totalItems:0,totalPrice:0,updatedAt:new Date}}catch(r){throw console.error("Error clearing cart:",r),r}}static async getCartWithProducts(e,r){try{const a=await this.getUserCart(e);if(!a||!a.items.length)return{...a,items:[],populatedItems:[]};const s=[...new Set(a.items.map(c=>c.productId))];console.log(`📦 Batch fetching ${s.length} products for cart`);let n={};try{if(r.getProductsBatch)n=await r.getProductsBatch(s);else{const c=s.map(u=>r.getProduct(u,{minimal:!0}).catch(h=>(console.warn(`Failed to fetch product ${u}:`,h),null))),d=await Promise.all(c);s.forEach((u,h)=>{d[h]&&(n[u]=d[h])})}}catch(c){console.error("Error batch fetching products:",c),n={}}const o=a.items.map(c=>{const d=n[c.productId];return d?{key:`${c.productId}_${JSON.stringify(c.selectedVariants)}`,productId:c.productId,name:d.name,slug:d.slug,price:d.price,originalPrice:d.originalPrice,discount:d.discount,image:d.images&&d.images[0]?d.images[0]:"",quantity:c.quantity,selectedVariants:c.selectedVariants||{},addedAt:c.addedAt,isAvailable:d.stock>=c.quantity,stockAvailable:d.stock,product:d,totalPrice:d.price*c.quantity}:(console.warn(`Product ${c.productId} not found or failed to load`),{key:`${c.productId}_${JSON.stringify(c.selectedVariants)}`,productId:c.productId,name:"Product not found",slug:"",price:0,originalPrice:0,discount:0,image:"",quantity:c.quantity,selectedVariants:c.selectedVariants||{},addedAt:c.addedAt,isAvailable:!1,stockAvailable:0,product:null,totalPrice:0})}),l=o.reduce((c,d)=>c+(d.totalPrice||0),0);return{...a,populatedItems:o,totalPrice:l}}catch(a){throw console.error("Error getting cart with products:",a),a}}static subscribeToCart(e,r){try{const a=Z(F,this.collectionName),s=J(a,H("userId","==",e));return wr(s,n=>{if(n.empty)r(null);else{const o=n.docs[0];r({id:o.id,...o.data()})}})}catch(a){throw console.error("Error subscribing to cart:",a),a}}static async applyCoupon(e,r){try{const a=await this.getUserCart(e),n={WELCOME10:{discount:.1,type:"percentage"},SAVE20:{discount:.2,type:"percentage"},FLAT50:{discount:50,type:"fixed"}}[r.toUpperCase()];if(!n)throw new Error("Invalid coupon code");return await Re(re(F,this.collectionName,a.id),{coupon:{code:r.toUpperCase(),...n,appliedAt:new Date},updatedAt:new Date}),{...a,coupon:{code:r.toUpperCase(),...n,appliedAt:new Date}}}catch(a){throw console.error("Error applying coupon:",a),a}}static async removeCoupon(e){try{const r=await this.getUserCart(e);return await Re(re(F,this.collectionName,r.id),{coupon:null,updatedAt:new Date}),{...r,coupon:null}}catch(r){throw console.error("Error removing coupon:",r),r}}}$e(bt,"collectionName","carts");class nl{constructor(){this.storageKey=`${ya.CART||"ecommerce-cart"}`,this.useFirebase=!0,this.currentUserId=null,this.cart=this.loadCart()}setUserId(e){this.currentUserId!==e&&(console.log("🔄 CartService: Switching to user:",e),this.currentUserId=e,this.storageKey=`${ya.CART||"ecommerce-cart"}-${e||"anonymous"}`,this.cart=this.loadCart())}loadCart(){var e;try{const r=localStorage.getItem(this.storageKey);if(r){const a=JSON.parse(r);return console.log("📦 CartService: Loaded cart with",((e=a.items)==null?void 0:e.length)||0,"items"),{items:a.items||[],coupon:a.coupon||null,lastUpdated:a.lastUpdated||new Date().toISOString()}}}catch(r){console.error("Error loading cart from localStorage:",r)}return console.log("🆕 CartService: Creating new empty cart"),{items:[],coupon:null,lastUpdated:new Date().toISOString()}}saveCart(){try{this.cart.lastUpdated=new Date().toISOString(),localStorage.setItem(this.storageKey,JSON.stringify(this.cart))}catch(e){console.error("Error saving cart to localStorage:",e)}}async addItem(e,r=1,a={}){try{console.log("🛒 CartService: Adding item to cart",{productId:e,quantity:r,selectedVariants:a});const s=await Q.getProduct(e);console.log("✅ Product found:",s==null?void 0:s.name);const n=await Q.checkAvailability(e,r);if(!n.available)throw new Error("Product is out of stock");if(console.log("✅ Product availability checked:",n),this.useFirebase)try{console.log("🔥 Using Firebase cart for user:",this.currentUserId);const c=await bt.addItem(this.currentUserId,e,r,a);console.log("✅ Firebase cart updated:",c);const d=await this.calculateCartSummary(c,Q);return console.log("✅ Cart summary calculated:",d),d}catch(c){console.error("❌ Firebase cart error, falling back to localStorage:",c),this.useFirebase=!1}const o=this.generateItemKey(e,a),l=this.cart.items.findIndex(c=>c.key===o);if(l>=0){const d=this.cart.items[l].quantity+r;if(d>s.stock)throw new Error(`Only ${s.stock} items available in stock`);if(d>K.MAX_CART_ITEMS)throw new Error(`Maximum ${K.MAX_CART_ITEMS} items allowed per product`);this.cart.items[l].quantity=d}else{const c={key:o,productId:s.id,name:s.name,slug:s.slug,price:s.price,originalPrice:s.originalPrice,discount:s.discount,image:s.images[0],quantity:r,selectedVariants:a,addedAt:new Date().toISOString()};this.cart.items.push(c)}return this.saveCart(),await this.getCartSummary()}catch(s){throw new Error(`Failed to add item to cart: ${s.message}`)}}async removeItem(e){if(this.useFirebase)try{console.log("🔥 Removing item from Firebase cart:",e);const[a,s]=e.split("_");let n={};if(s&&s!=="undefined")try{const o=s.split("|").filter(l=>l);for(const l of o){const[c,d]=l.split(":");c&&d&&(n[c]=d)}}catch(o){console.error("Error parsing variants from itemKey:",o)}return await bt.removeItem(this.currentUserId,a,n),await this.getCartSummary()}catch(a){console.error("❌ Firebase remove item error, falling back to localStorage:",a),this.useFirebase=!1}const r=this.cart.items.findIndex(a=>a.key===e);return r>=0&&(this.cart.items.splice(r,1),this.saveCart()),await this.getCartSummary()}async updateItemQuantity(e,r){if(this.useFirebase)try{console.log("🔥 Updating item quantity in Firebase cart:",e,r);const[o,l]=e.split("_");let c={};if(l&&l!=="undefined")try{const d=l.split("|").filter(u=>u);for(const u of d){const[h,g]=u.split(":");h&&g&&(c[h]=g)}}catch(d){console.error("Error parsing variants from itemKey:",d)}return await bt.updateItemQuantity(this.currentUserId,o,r,c),await this.getCartSummary()}catch(o){console.error("❌ Firebase update quantity error, falling back to localStorage:",o),this.useFirebase=!1}const a=this.cart.items.findIndex(o=>o.key===e);if(a<0)throw new Error("Item not found in cart");const s=this.cart.items[a];if(r<=0)return await this.removeItem(e);const n=await Q.checkAvailability(s.productId,r);if(!n.available)throw new Error(`Only ${n.stock} items available in stock`);if(r>K.MAX_CART_ITEMS)throw new Error(`Maximum ${K.MAX_CART_ITEMS} items allowed per product`);return this.cart.items[a].quantity=r,this.saveCart(),await this.getCartSummary()}async clearCart(){console.log("🧹 CartService: Clearing cart..."),this.cart.items=[],this.cart.coupon=null,this.saveCart(),console.log("✅ CartService: Cart cleared and saved to localStorage");const e=await this.getCartSummary();return console.log("📊 CartService: New cart summary:",{itemCount:e.itemCount,isEmpty:e.isEmpty}),e}clearAllCartData(){Object.keys(localStorage).filter(a=>a.includes("ecommerce-cart")).forEach(a=>{console.log("🗑️ Removing cart data:",a),localStorage.removeItem(a)}),this.cart={items:[],coupon:null,lastUpdated:new Date().toISOString()}}async applyCoupon(e){const a={WELCOME10:{type:"percentage",value:10,minAmount:100},SAVE20:{type:"percentage",value:20,minAmount:200},FLAT50:{type:"fixed",value:50,minAmount:300},FREESHIP:{type:"free_shipping",value:0,minAmount:0}}[e.toUpperCase()];if(!a)throw new Error("Invalid coupon code");if(this.calculateSubtotal()<a.minAmount)throw new Error(`Minimum order amount ₺${a.minAmount} required for this coupon`);return this.cart.coupon={code:e.toUpperCase(),...a,appliedAt:new Date().toISOString()},this.saveCart(),await this.getCartSummary()}async removeCoupon(){return this.cart.coupon=null,this.saveCart(),await this.getCartSummary()}async getCartWithProducts(){const e=await Promise.all(this.cart.items.map(async r=>{try{const a=await Q.getProduct(r.productId);return{...r,product:a,isAvailable:a.stock>=r.quantity,currentPrice:a.price,stockAvailable:a.stock}}catch{return{...r,isAvailable:!1,error:"Product not available"}}}));return{...this.cart,items:e}}calculateSubtotal(){return this.cart.items.reduce((e,r)=>e+r.price*r.quantity,0)}calculateDiscount(){if(!this.cart.coupon)return 0;const e=this.calculateSubtotal(),r=this.cart.coupon;switch(r.type){case"percentage":return Math.min(e*(r.value/100),e);case"fixed":return Math.min(r.value,e);default:return 0}}calculateShipping(e="standard"){if(this.calculateSubtotal()>=K.FREE_SHIPPING_THRESHOLD||this.cart.coupon&&this.cart.coupon.type==="free_shipping")return 0;const a={standard:15,express:25,overnight:50};return a[e]||a.standard}calculateTax(){const e=this.calculateSubtotal(),r=this.calculateDiscount(),a=e-r;return Math.max(0,a*K.TAX_RATE)}async getCartSummary(e="standard"){if(this.useFirebase)try{return await this.calculateCartSummary(null,Q)}catch(l){console.error("Firebase cart summary error, falling back to localStorage:",l),this.useFirebase=!1}const r=this.calculateSubtotal(),a=this.calculateDiscount(),s=this.calculateShipping(e),n=this.calculateTax(),o=r-a+s+n;return{items:this.cart.items,itemCount:this.cart.items.reduce((l,c)=>l+c.quantity,0),coupon:this.cart.coupon,totals:{subtotal:r,discount:a,shipping:s,tax:n,total:o},lastUpdated:this.cart.lastUpdated,isEmpty:this.cart.items.length===0,qualifiesForFreeShipping:r>=K.FREE_SHIPPING_THRESHOLD,freeShippingThreshold:K.FREE_SHIPPING_THRESHOLD}}generateItemKey(e,r={}){const a=Object.entries(r).sort(([s],[n])=>s.localeCompare(n)).map(([s,n])=>`${s}:${n}`).join("|");return`${e}_${a}`}async saveForLater(e){const r=this.cart.items.findIndex(n=>n.key===e);if(r<0)throw new Error("Item not found in cart");const a=this.cart.items[r],s=JSON.parse(localStorage.getItem("saved-items")||"[]");return s.push({...a,savedAt:new Date().toISOString()}),localStorage.setItem("saved-items",JSON.stringify(s)),this.cart.items.splice(r,1),this.saveCart(),await this.getCartSummary()}async moveToCart(e){const r=JSON.parse(localStorage.getItem("saved-items")||"[]"),a=r.findIndex(o=>o.key===e);if(a<0)throw new Error("Item not found in saved items");const s=r[a];if(!(await Q.checkAvailability(s.productId,s.quantity)).available)throw new Error("Product is no longer available");return this.cart.items.push({...s,addedAt:new Date().toISOString()}),r.splice(a,1),localStorage.setItem("saved-items",JSON.stringify(r)),this.saveCart(),await this.getCartSummary()}getSavedItems(){try{return JSON.parse(localStorage.getItem("saved-items")||"[]")}catch(e){return console.error("Error loading saved items:",e),[]}}async calculateCartSummary(e,r){try{const a=await bt.getCartWithProducts(this.currentUserId,r),s=a.totalPrice||0,n=a.coupon?this.calculateDiscount(s,a.coupon):0,o=s>=K.FREE_SHIPPING_THRESHOLD?0:15,l=(s-n)*K.TAX_RATE,c=s-n+o+l;return{items:a.populatedItems||[],itemCount:a.totalItems||0,coupon:a.coupon,totals:{subtotal:s,discount:n,shipping:o,tax:l,total:c},lastUpdated:a.updatedAt,isEmpty:!a.items||a.items.length===0,qualifiesForFreeShipping:s>=K.FREE_SHIPPING_THRESHOLD,freeShippingThreshold:K.FREE_SHIPPING_THRESHOLD}}catch(a){return console.error("Error calculating Firebase cart summary:",a),{items:[],itemCount:0,coupon:null,totals:{subtotal:0,discount:0,shipping:0,tax:0,total:0},isEmpty:!0,qualifiesForFreeShipping:!1,freeShippingThreshold:K.FREE_SHIPPING_THRESHOLD}}}}const Ae=new nl,Xe=({product:i,showQuickView:e=!0,className:r=""})=>{var T,D,I;const{state:a,dispatch:s,actionTypes:n}=ae(),[o,l]=p.useState(!1),[c,d]=p.useState(!1),[u,h]=p.useState(!1),g=((D=(T=a.user)==null?void 0:T.wishlist)==null?void 0:D.some(v=>v.id===i.id))||!1,x=i.discount,k=async v=>{var w,y;v.preventDefault(),v.stopPropagation(),l(!0);try{(y=(w=a.user)==null?void 0:w.profile)!=null&&y.id&&Ae.setUserId(a.user.profile.id);const P=i.firebaseId||i.id,N=await Ae.addItem(P,1);s({type:n.SET_CART,payload:N}),s({type:n.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:`${i.name} sepete eklendi`,duration:3e3}})}catch(P){s({type:n.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:P.message||"Ürün sepete eklenirken hata oluştu",duration:5e3}})}finally{l(!1)}},f=v=>{v.preventDefault(),v.stopPropagation(),s(g?{type:n.REMOVE_FROM_WISHLIST,payload:i.id}:{type:n.ADD_TO_WISHLIST,payload:i})},E=v=>{v.preventDefault(),v.stopPropagation(),d(!0)},j=v=>Array.from({length:5},(w,y)=>t.jsx(De,{className:`w-4 h-4 ${y<Math.floor(v)?"fill-yellow-400 text-yellow-400":y<v?"fill-yellow-200 text-yellow-400":"text-gray-300"}`},y));return t.jsxs(t.Fragment,{children:[t.jsx(m.div,{className:`group relative bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden ${r}`,whileHover:{y:-4},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:t.jsxs(ie,{to:`/product/${i.slug}`,className:"block",children:[t.jsxs("div",{className:"relative aspect-square overflow-hidden bg-gray-100 dark:bg-gray-700",children:[x>0&&t.jsxs(m.div,{className:"absolute top-3 left-3 z-10 bg-red-500 text-white px-2 py-1 rounded-lg text-sm font-semibold",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:["%",x," İndirim"]}),((I=i.aiGenerated)==null?void 0:I.description)&&t.jsx(m.div,{className:"absolute top-3 right-3 z-10 bg-purple-500 text-white p-1.5 rounded-lg",initial:{scale:0},animate:{scale:1},transition:{delay:.3},title:"AI Generated Content",children:t.jsx(qe,{className:"w-3 h-3"})}),t.jsxs("div",{className:"relative w-full h-full",children:[!u&&t.jsx("div",{className:"absolute inset-0 bg-gray-200 dark:bg-gray-700 animate-pulse"}),t.jsx("img",{src:i.images[0],alt:i.name,className:`w-full h-full object-cover transition-transform duration-300 group-hover:scale-105 ${u?"opacity-100":"opacity-0"}`,onLoad:()=>h(!0),loading:"lazy"})]}),t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300"}),t.jsxs("div",{className:"absolute bottom-3 left-3 right-3 flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[t.jsxs(m.button,{onClick:k,disabled:o||i.stock===0,className:"flex-1 bg-primary-600 hover:bg-primary-700 disabled:bg-gray-400 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center justify-center space-x-1",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(at,{className:"w-4 h-4"}),t.jsx("span",{children:o?"Ekleniyor...":"Sepete Ekle"})]}),e&&t.jsx(m.button,{onClick:E,className:"bg-white hover:bg-gray-100 text-gray-700 p-2 rounded-lg transition-colors duration-200",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Hızlı Görünüm",children:t.jsx(vt,{className:"w-4 h-4"})}),t.jsx(m.button,{onClick:f,className:`p-2 rounded-lg transition-colors duration-200 ${g?"bg-red-500 hover:bg-red-600 text-white":"bg-white hover:bg-gray-100 text-gray-700"}`,whileHover:{scale:1.05},whileTap:{scale:.95},title:g?"Favorilerden Çıkar":"Favorilere Ekle",children:t.jsx(ge,{className:`w-4 h-4 ${g?"fill-current":""}`})})]})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:i.brand}),t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2 line-clamp-2 group-hover:text-primary-600 transition-colors",children:i.name}),t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx("div",{className:"flex items-center space-x-1",children:j(i.rating)}),t.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",i.reviewCount,")"]})]}),t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsxs("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[K.CURRENCY_SYMBOL,i.price.toLocaleString("tr-TR")]}),i.originalPrice>i.price&&t.jsxs("span",{className:"text-sm text-gray-500 line-through",children:[K.CURRENCY_SYMBOL,i.originalPrice.toLocaleString("tr-TR")]})]}),i.tags&&i.tags.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1",children:i.tags.slice(0,3).map((v,w)=>t.jsx("span",{className:"inline-block bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-xs px-2 py-1 rounded-full",children:v},w))}),i.stock<=5&&i.stock>0&&t.jsxs("p",{className:"text-sm text-orange-500 mt-2",children:["Son ",i.stock," adet!"]}),i.stock===0&&t.jsx("p",{className:"text-sm text-red-500 mt-2",children:"Stokta yok"})]})]})}),c&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:t.jsx(m.div,{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Hızlı Görünüm"}),t.jsx("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"✕"})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsx("div",{children:t.jsx("img",{src:i.images[0],alt:i.name,className:"w-full h-64 object-cover rounded-lg"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold mb-2",children:i.name}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:i.shortDescription}),t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsxs("span",{className:"text-2xl font-bold text-primary-600",children:[K.CURRENCY_SYMBOL,i.price.toLocaleString("tr-TR")]}),i.originalPrice>i.price&&t.jsxs("span",{className:"text-lg text-gray-500 line-through",children:[K.CURRENCY_SYMBOL,i.originalPrice.toLocaleString("tr-TR")]})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:k,disabled:o,className:"flex-1 bg-primary-600 hover:bg-primary-700 text-white py-2 px-4 rounded-lg font-medium transition-colors",children:o?"Ekleniyor...":"Sepete Ekle"}),t.jsx(ie,{to:`/product/${i.slug}`,className:"bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium transition-colors",onClick:()=>d(!1),children:"Detayları Gör"})]})]})]})]})})})]})},xa={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},lt={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}},ol={animate:{y:[-10,10,-10],transition:{duration:6,repeat:1/0,ease:"easeInOut"}}},ll=()=>{var d,u,h,g;const{state:i,dispatch:e,actionTypes:r}=ae(),{isDarkMode:a}=i,[s,n]=p.useState([]),[o,l]=p.useState(!0),c=[{id:"products",title:"Ürün Kataloğu",description:"Binlerce kaliteli ürünü keşfedin",icon:rt,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20",link:"/products",stats:"1000+ Ürün",badge:"Popüler"},{id:"cart",title:"Sepetim",description:"Sepetinizdeki ürünleri yönetin",icon:at,color:"text-green-600 dark:text-green-400",bgColor:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20",link:"/cart",stats:`${((u=(d=i.cart)==null?void 0:d.items)==null?void 0:u.length)||0} Ürün`,badge:((g=(h=i.cart)==null?void 0:h.items)==null?void 0:g.length)>0?"Dolu":null},{id:"visual-search",title:"Görsel Arama",description:"Fotoğraf ile ürün bulun",icon:Je,color:"text-purple-600 dark:text-purple-400",bgColor:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20",link:"/visual-search",stats:"AI Destekli",badge:"Yeni"},{id:"recommendations",title:"Kişisel Öneriler",description:"Size özel seçilmiş ürünler",icon:ge,color:"text-pink-600 dark:text-pink-400",bgColor:"bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-900/20 dark:to-pink-800/20",link:"/recommendations",stats:"Sizin İçin",badge:"AI"},{id:"complementary-products",title:"Tamamlayıcı Ürünler",description:"AI ile uyumlu ürün önerileri alın",icon:xe,color:"text-indigo-600 dark:text-indigo-400",bgColor:"bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900/20 dark:to-indigo-800/20",link:"/complementary-products",stats:"AI Eşleştirme",badge:"Yeni"},{id:"ai-profile",title:"AI Profil Anketi",description:"Kişiliğinizi tanımlayarak özel öneriler alın",icon:We,color:"text-orange-600 dark:text-orange-400",bgColor:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20",link:"/profile/questionnaire",stats:"Kişiselleştir",badge:"Akıllı"}];return p.useEffect(()=>{(async()=>{try{l(!0);const k=await Q.getFeaturedProducts(6);n(k)}catch(k){console.error("Error loading featured products:",k)}finally{l(!1)}})()},[]),t.jsxs(m.div,{className:"max-w-7xl mx-auto",variants:xa,initial:"hidden",animate:"visible",children:[t.jsx(m.div,{className:"mb-12",variants:lt,children:t.jsxs("div",{className:"text-center mb-8 relative",children:[t.jsx(m.div,{className:"absolute -top-4 left-1/2 transform -translate-x-1/2 w-24 h-24 bg-gradient-to-r from-primary-400/20 to-accent-400/20 rounded-full blur-xl",variants:ol,animate:"animate"}),t.jsxs(m.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.8,ease:"easeOut"},className:"relative z-10",children:[t.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 dark:text-white mb-6 leading-tight",children:[t.jsx(m.span,{className:"bg-gradient-to-r from-primary-600 via-accent-500 to-primary-600 bg-clip-text text-transparent",animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:3,repeat:1/0,ease:"linear"},style:{backgroundSize:"200% 200%"},children:"ShopSmart"}),t.jsx("br",{}),t.jsx("span",{className:"text-2xl md:text-3xl font-normal text-gray-700 dark:text-gray-300",children:"Akıllı Alışverişin Yeni Adresi"})]}),t.jsxs(m.p,{className:"text-lg md:text-xl text-gray-600 dark:text-gray-400 max-w-2xl mx-auto leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.6},children:["AI destekli kişisel öneriler, görsel arama ve hızlı teslimat ile"," ",t.jsx(m.span,{className:"font-semibold text-primary-600 dark:text-primary-400",whileHover:{scale:1.05},children:"alışveriş deneyiminizi dönüştürün"})]})]})]})}),t.jsx(m.div,{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",variants:xa,children:c.map((x,k)=>{const f=ie,E={to:x.link,className:"group block h-full"};return t.jsx(m.div,{variants:lt,whileHover:{scale:1.02,y:-4},transition:{duration:.3,ease:"easeOut"},children:t.jsx(f,{...E,children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-lg hover:shadow-xl transition-all duration-300 h-full relative overflow-hidden group-hover:border-primary-300 dark:group-hover:border-primary-600",children:[x.badge&&t.jsx("div",{className:"absolute top-4 right-4 z-20",children:t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-300 rounded-full",children:x.badge})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary-50/30 via-transparent to-accent-50/30 dark:from-primary-900/5 dark:via-transparent dark:to-accent-900/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsxs("div",{className:"relative z-10 h-full flex flex-col",children:[t.jsx("div",{className:"flex items-start justify-between mb-4",children:t.jsx(m.div,{className:`${x.bgColor} ${x.color} p-3 rounded-xl shadow-sm`,whileHover:{scale:1.1,rotate:5},transition:{duration:.2},children:t.jsx(x.icon,{className:"w-6 h-6"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors duration-300",children:x.title}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 leading-relaxed",children:x.description}),t.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:x.stats}),t.jsx(m.div,{className:"text-primary-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300",whileHover:{x:4},children:t.jsx(Nt,{className:"w-5 h-5 text-primary-500"})})]})]})]})]})})},x.id)})}),!1,t.jsxs(m.div,{variants:lt,className:"mt-16",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx(m.h2,{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",variants:lt,children:"⭐ Popüler Ürünler"}),t.jsx(m.p,{className:"text-gray-600 dark:text-gray-400 max-w-2xl mx-auto",variants:lt,children:"En çok beğenilen ve satın alınan ürünlerimizi keşfedin"})]}),o?t.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((x,k)=>t.jsx("div",{className:"animate-pulse",children:t.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-2xl h-64"})},k))}):s.length>0?t.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map((x,k)=>t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:k*.1,duration:.3},children:t.jsx(Xe,{product:x})},x.firebaseId||x.id))}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx(rt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Henüz öne çıkan ürün bulunmuyor"})]}),t.jsx("div",{className:"text-center mt-8",children:t.jsx(m.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:t.jsxs(ie,{to:"/products",className:"inline-flex items-center px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-xl transition-colors shadow-lg hover:shadow-xl",children:["Tüm Ürünleri Gör",t.jsx(Nt,{className:"w-4 h-4 ml-2"})]})})})]}),t.jsx(m.div,{variants:lt,className:"mt-8 text-center",children:t.jsxs(m.div,{className:"inline-flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-gray-100/50 via-primary-50/30 to-gray-100/50 dark:from-gray-800/50 dark:via-primary-900/20 dark:to-gray-800/50 rounded-2xl backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50",whileHover:{scale:1.02,y:-2},transition:{duration:.2},children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"ShopSmart v1.0 - BTK Akademi Hackathon 2025 Projesi"}),t.jsx(xe,{className:"w-4 h-4 text-primary-500"})]})})]})},cl=({onClose:i})=>{const{state:e,dispatch:r,actionTypes:a}=ae(),[s,n]=p.useState([]),[o,l]=p.useState([]),[c,d]=p.useState([0,1e5]),[u,h]=p.useState([0,1e5]),[g,x]=p.useState(!0),{filters:k}=e.products;p.useEffect(()=>{f()},[]),p.useEffect(()=>{d(k.priceRange),h(k.priceRange)},[k.priceRange]);const f=async()=>{try{const[N,S,b]=await Promise.all([Q.getCategories(),Q.getBrands(),Q.getPriceRange()]);n(N),l(S),d([b.min,b.max]),h([b.min,b.max])}catch(N){console.error("Error loading filter options:",N)}finally{x(!1)}},E=N=>{const S=k.category===N?null:N;r({type:a.SET_PRODUCT_FILTERS,payload:{category:S}})},j=N=>{const S=k.brand===N?null:N;r({type:a.SET_PRODUCT_FILTERS,payload:{brand:S}})},T=N=>{const S=k.rating===N?0:N;r({type:a.SET_PRODUCT_FILTERS,payload:{rating:S}})},D=N=>{h(N)},I=()=>{r({type:a.SET_PRODUCT_FILTERS,payload:{priceRange:u}})},v=N=>{r({type:a.SET_PRODUCT_FILTERS,payload:{inStock:N}})},w=()=>{r({type:a.SET_PRODUCT_FILTERS,payload:{category:null,brand:null,priceRange:[0,1e5],rating:0,inStock:!0}})},y=k.category||k.brand||k.rating>0||k.priceRange[0]>0||k.priceRange[1]<1e5||!k.inStock,P=(N,S=!1)=>Array.from({length:5},(b,A)=>t.jsx(De,{className:`w-4 h-4 ${S&&A<N?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},A));return g?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg",children:t.jsxs("div",{className:"animate-pulse space-y-4",children:[t.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),t.jsx("div",{className:"space-y-2",children:Array.from({length:5}).map((N,S)=>t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"},S))})]})}):t.jsxs(m.div,{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg sticky top-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(fr,{className:"w-5 h-5 text-primary-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Filtreler"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[y&&t.jsx("button",{onClick:w,className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Temizle"}),i&&t.jsx("button",{onClick:i,className:"lg:hidden text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:t.jsx(Ar,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Kategoriler"}),t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:s.map(N=>t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded-lg transition-colors",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"checkbox",checked:k.category===N.id,onChange:()=>E(N.id),className:"sr-only"}),t.jsx("div",{className:`w-4 h-4 rounded border-2 flex items-center justify-center transition-colors ${k.category===N.id?"bg-primary-600 border-primary-600":"border-gray-300 dark:border-gray-600"}`,children:k.category===N.id&&t.jsx(Mt,{className:"w-3 h-3 text-white"})})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-lg",children:N.icon}),t.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N.name})]}),t.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[N.productCount," ürün"]})]})]},N.id))})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Markalar"}),t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:o.map(N=>t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded-lg transition-colors",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"checkbox",checked:k.brand===N.name,onChange:()=>j(N.name),className:"sr-only"}),t.jsx("div",{className:`w-4 h-4 rounded border-2 flex items-center justify-center transition-colors ${k.brand===N.name?"bg-primary-600 border-primary-600":"border-gray-300 dark:border-gray-600"}`,children:k.brand===N.name&&t.jsx(Mt,{className:"w-3 h-3 text-white"})})]}),t.jsxs("div",{className:"flex-1 flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N.name}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:N.productCount})]})]},N.name))})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Fiyat Aralığı"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:u[0],onChange:N=>D([parseInt(N.target.value)||0,u[1]]),className:"w-24 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Min"}),t.jsx("span",{className:"text-gray-500",children:"-"}),t.jsx("input",{type:"number",value:u[1],onChange:N=>D([u[0],parseInt(N.target.value)||1e5]),className:"w-24 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Max"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"range",min:0,max:1e5,step:100,value:u[0],onChange:N=>D([parseInt(N.target.value),u[1]]),className:"absolute w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 z-10",style:{pointerEvents:"none"}}),t.jsx("input",{type:"range",min:0,max:1e5,step:100,value:u[1],onChange:N=>D([u[0],parseInt(N.target.value)]),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"})]}),t.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[t.jsxs("span",{children:[K.CURRENCY_SYMBOL,"0"]}),t.jsxs("span",{children:[K.CURRENCY_SYMBOL,"100,000+"]})]}),(u[0]!==k.priceRange[0]||u[1]!==k.priceRange[1])&&t.jsx("button",{onClick:I,className:"w-full bg-primary-600 hover:bg-primary-700 text-white py-2 px-4 rounded-lg text-sm font-medium transition-colors",children:"Fiyat Filtresi Uygula"})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Değerlendirme"}),t.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map(N=>t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded-lg transition-colors",children:[t.jsx("input",{type:"radio",name:"rating",checked:k.rating===N,onChange:()=>T(N),className:"text-primary-600 focus:ring-primary-500"}),t.jsxs("div",{className:"flex items-center space-x-1",children:[P(N,!0),t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-2",children:[N," yıldız ve üzeri"]})]})]},N))})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Stok Durumu"}),t.jsx("div",{className:"space-y-2",children:t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded-lg transition-colors",children:[t.jsx("input",{type:"checkbox",checked:k.inStock,onChange:N=>v(N.target.checked),className:"text-primary-600 focus:ring-primary-500 rounded"}),t.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Sadece stokta olanlar"})]})})]})]})]})},ir=({products:i,showFilters:e=!0,showSort:r=!0,showViewToggle:a=!0,className:s="",itemsPerPage:n=K.ITEMS_PER_PAGE})=>{const{state:o,dispatch:l,actionTypes:c}=ae(),[d,u]=p.useState(i||[]),[h,g]=p.useState("grid"),[x,k]=p.useState("name"),[f,E]=p.useState("asc"),[j,T]=p.useState(!1),[D,I]=p.useState(!1),[v,w]=p.useState(1),[y,P]=p.useState(1),{filters:N,searchQuery:S}=o.products;p.useEffect(()=>{i?u(i):b()},[N,S,x,f,v,i]);const b=async()=>{I(!0);try{console.log("ProductGrid: Fetching products with options:",{page:v,limit:n,category:N.category,brand:N.brand,minPrice:N.priceRange[0],maxPrice:N.priceRange[1],sortBy:x,sortOrder:f,search:S});const R={page:v,limit:n,category:N.category,brand:N.brand,minPrice:N.priceRange[0],maxPrice:N.priceRange[1],sortBy:x,sortOrder:f,search:S},O=await Q.getProducts(R);console.log("ProductGrid: Received response:",O),console.log("ProductGrid: Pagination info:",{totalPages:O.pagination.totalPages,totalItems:O.pagination.totalItems,currentPage:O.pagination.currentPage,limit:O.pagination.itemsPerPage}),u(O.products),P(O.pagination.totalPages)}catch(R){console.error("ProductGrid: Error fetching products:",R),l({type:c.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Ürünler yüklenirken hata oluştu",duration:5e3}})}finally{I(!1)}},A=R=>{w(R),window.scrollTo({top:0,behavior:"smooth"})},C=[{value:"name",label:"İsim"},{value:"price",label:"Fiyat"},{value:"rating",label:"Değerlendirme"},{value:"createdAt",label:"Yeni Eklenenler"}],_={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},L={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};return t.jsxs("div",{className:`${s}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-6 flex-wrap gap-4",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[d.length," ürün gösteriliyor"]}),e&&t.jsxs("button",{onClick:()=>T(!j),className:"lg:hidden flex items-center space-x-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-3 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[t.jsx(fr,{className:"w-4 h-4"}),t.jsx("span",{children:"Filtreler"})]})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[r&&t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sıralama:"}),t.jsx("select",{value:`${x}-${f}`,onChange:R=>{const[O,$]=R.target.value.split("-");k(O),E($)},className:"bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:C.map(R=>t.jsxs(Kt.Fragment,{children:[t.jsxs("option",{value:`${R.value}-asc`,children:[R.label," (A-Z)"]}),t.jsxs("option",{value:`${R.value}-desc`,children:[R.label," (Z-A)"]})]},R.value))})]}),a&&t.jsxs("div",{className:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>g("grid"),className:`p-2 rounded ${h==="grid"?"bg-white dark:bg-gray-600 text-primary-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,title:"Grid View",children:t.jsx(Cr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded ${h==="list"?"bg-white dark:bg-gray-600 text-primary-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,title:"List View",children:t.jsx(Ds,{className:"w-4 h-4"})})]})]})]}),t.jsxs("div",{className:"flex gap-6",children:[e&&t.jsx("div",{className:`lg:block ${j?"block":"hidden"} w-full lg:w-64 flex-shrink-0`,children:t.jsx(cl,{})}),t.jsxs("div",{className:"flex-1",children:[D?t.jsx("div",{className:`grid gap-6 ${h==="grid"?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,children:Array.from({length:n}).map((R,O)=>t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 aspect-square rounded-2xl mb-4"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),t.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/4"})]})]},O))}):d.length===0?t.jsxs(m.div,{className:"text-center py-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[t.jsx(fr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Ürün bulunamadı"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Arama kriterlerinizle eşleşen ürün bulunamadı. Filtreleri değiştirmeyi deneyin."}),t.jsx("button",{onClick:()=>{l({type:c.SET_PRODUCT_FILTERS,payload:{category:null,brand:null,priceRange:[0,1e5],rating:0}}),l({type:c.CLEAR_SEARCH})},className:"bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg transition-colors",children:"Filtreleri Temizle"})]}):t.jsx(m.div,{className:`grid gap-6 ${h==="grid"?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,variants:_,initial:"hidden",animate:"visible",children:t.jsx(oe,{children:d.map((R,O)=>t.jsx(m.div,{variants:L,layout:!0,children:t.jsx(Xe,{product:R,className:h==="list"?"flex":""})},R.id||`product-${O}`))})}),console.log("ProductGrid render: totalPages =",y,"products.length =",d.length),t.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-8",children:[t.jsx("button",{onClick:()=>A(v-1),disabled:v===1,className:"px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Önceki"}),Array.from({length:y},(R,O)=>{const $=O+1;return $===1||$===y||$>=v-2&&$<=v+2?t.jsx("button",{onClick:()=>A($),className:`px-3 py-2 text-sm rounded-lg ${v===$?"bg-primary-600 text-white":"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:$},$):$===v-3||$===v+3?t.jsx("span",{className:"px-2 text-gray-500",children:"..."},$):null}),t.jsx("button",{onClick:()=>A(v+1),disabled:v===y,className:"px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Sonraki"})]})]})]})]})},nr=()=>{const{category:i}=Da(),{state:e,dispatch:r,actionTypes:a}=ae(),[s,n]=p.useState(""),[o,l]=p.useState([]),[c,d]=p.useState([]),[u,h]=p.useState(!0),[g,x]=p.useState(null),{products:{searchResults:k}}=e;p.useEffect(()=>{f()},[]),p.useEffect(()=>{i?E():(d([]),x(null))},[i]);const f=async()=>{try{const[v,w,y]=await Promise.all([Q.getFeaturedProducts(8),Q.getCategories(),Q.getBrands()]);l(v),r({type:a.SET_CATEGORIES,payload:w}),r({type:a.SET_BRANDS,payload:y})}catch{r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Ürünler yüklenirken hata oluştu",duration:5e3}})}finally{h(!1)}},E=async()=>{try{h(!0);const[v,w]=await Promise.all([Q.getProducts({category:i,limit:50}),Q.getCategories()]);d(v.products);const y=w.find(P=>P.id===i);x(y)}catch(v){console.error("Error loading category products:",v),r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Kategori ürünleri yüklenirken hata oluştu",duration:5e3}})}finally{h(!1)}},j=async v=>{if(v.preventDefault(),!!s.trim())try{r({type:a.SET_LOADING,payload:!0});const w=await Q.searchProducts(s);r({type:a.SET_SEARCH_QUERY,payload:s}),r({type:a.SET_SEARCH_RESULTS,payload:w})}catch{r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Arama sırasında hata oluştu",duration:5e3}})}finally{r({type:a.SET_LOADING,payload:!1})}},T=()=>{n(""),r({type:a.CLEAR_SEARCH})},D={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},I={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}};return t.jsxs(m.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",variants:D,initial:"hidden",animate:"visible",children:[t.jsxs(m.div,{className:"text-center mb-12",variants:I,children:[t.jsx(m.div,{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-3xl bg-gradient-to-br from-primary-500 to-accent-500 mb-6 shadow-xl",whileHover:{scale:1.05,rotate:5},transition:{duration:.3},children:g?t.jsx("span",{className:"text-3xl",children:g.icon}):t.jsx(rt,{className:"h-8 w-8 text-white"})}),t.jsx(m.h1,{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",variants:I,children:g?g.name:"Ürünler"}),t.jsx(m.p,{className:"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-3xl mx-auto leading-relaxed",variants:I,children:g?g.description:"ShopSmart'ta binlerce kaliteli ürünü keşfedin ve AI destekli akıllı önerilerden faydalanın"}),t.jsx(m.form,{onSubmit:j,className:"max-w-2xl mx-auto",variants:I,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx(Gt,{className:"h-5 w-5 text-gray-400"})}),t.jsx("input",{type:"text",value:s,onChange:v=>n(v.target.value),className:"block w-full pl-10 pr-12 py-4 border border-gray-300 dark:border-gray-600 rounded-2xl leading-5 bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent text-lg",placeholder:"Ürün ara... (örn: iPhone, laptop, ayakkabı)"}),t.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center",children:[e.products.searchQuery&&t.jsx("button",{type:"button",onClick:T,className:"p-2 text-gray-400 hover:text-gray-600 mr-2",children:"✕"}),t.jsx("button",{type:"submit",className:"bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-xl mr-2 transition-colors font-medium",children:"Ara"})]})]})})]}),e.products.searchQuery?t.jsxs(m.div,{variants:I,children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:['"',e.products.searchQuery,'" için arama sonuçları']}),t.jsx("button",{onClick:T,className:"text-primary-600 hover:text-primary-700 font-medium",children:"Aramayı temizle"})]}),t.jsx(ir,{products:k,showFilters:!1})]}):t.jsx(t.Fragment,{children:i?c&&c.length>0?t.jsxs(m.div,{variants:I,children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[g==null?void 0:g.name," Ürünleri"]}),t.jsxs("span",{className:"text-sm text-gray-500",children:[c.length," ürün bulundu"]})]}),t.jsx(ir,{products:c,showFilters:!0})]}):u?t.jsxs(m.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),t.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Kategori ürünleri yükleniyor..."})]}):t.jsx(m.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},children:t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Bu kategoride henüz ürün bulunmuyor."})}):t.jsxs(t.Fragment,{children:[!u&&o.length>0&&t.jsxs(m.div,{className:"mb-16",variants:I,children:[t.jsx("div",{className:"flex items-center justify-between mb-8",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(m.div,{className:"w-8 h-8 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(xe,{className:"w-4 h-4 text-white"})}),t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Öne Çıkan Ürünler"})]})}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:o.map((v,w)=>t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:w*.1,duration:.3},children:t.jsx(Xe,{product:v})},v.firebaseId||v.id||`featured-${w}`))})]}),t.jsxs(m.div,{variants:I,children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-8",children:[t.jsx(m.div,{className:"w-8 h-8 bg-gradient-to-br from-primary-500 to-accent-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(rt,{className:"w-4 h-4 text-white"})}),t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Tüm Ürünler"})]}),t.jsx(ir,{showFilters:!0})]})]})}),u&&t.jsxs(m.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),t.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Ürünler yükleniyor..."})]})]})},dl="modulepreload",ul=function(i){return"/"+i},fa={},ye=function(e,r,a){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=ul(c),c in fa)return;fa[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":dl,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((g,x)=>{h.addEventListener("load",g),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&n(l.reason);return e().catch(n)})},ml=({reviews:i,productName:e})=>{const[r,a]=p.useState(new Set),[s,n]=p.useState("date");if(!i||i.length===0)return t.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[t.jsx(_s,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Henüz yorum bulunmuyor."})]});const o=u=>{const h=new Set(r);h.has(u)?h.delete(u):h.add(u),a(h)},l=[...i].sort((u,h)=>{switch(s){case"rating":return h.rating-u.rating;case"helpful":return(h.helpful||0)-(u.helpful||0);case"date":default:return new Date(h.createdAt||h.date)-new Date(u.createdAt||u.date)}}),c=i.reduce((u,h)=>u+h.rating,0)/i.length,d=[1,2,3,4,5].map(u=>({rating:u,count:i.filter(h=>h.rating===u).length,percentage:i.filter(h=>h.rating===u).length/i.length*100}));return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Müşteri Yorumları"}),t.jsx("div",{className:"flex items-center space-x-4",children:t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"flex",children:[1,2,3,4,5].map(u=>t.jsx(De,{className:`w-5 h-5 ${u<=Math.round(c)?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600"}`},u))}),t.jsx("span",{className:"text-xl font-bold text-gray-900 dark:text-white",children:c.toFixed(1)})]}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[i.length," değerlendirme"]})]})})]}),t.jsx("div",{className:"grid grid-cols-5 gap-2 mb-6",children:d.reverse().map(({rating:u,count:h,percentage:g})=>t.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[t.jsx("span",{className:"w-4 text-gray-600 dark:text-gray-400",children:u}),t.jsx(De,{className:"w-3 h-3 text-yellow-400 fill-current"}),t.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:"bg-yellow-400 h-full rounded-full transition-all duration-300",style:{width:`${g}%`}})}),t.jsx("span",{className:"w-8 text-xs text-gray-500 dark:text-gray-400",children:h})]},u))})]}),t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[t.jsx("strong",{children:e})," için ",i.length," detaylı değerlendirme"]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sırala:"}),t.jsxs("select",{value:s,onChange:u=>n(u.target.value),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[t.jsx("option",{value:"date",children:"En Yeni"}),t.jsx("option",{value:"rating",children:"En Yüksek Puan"}),t.jsx("option",{value:"helpful",children:"En Faydalı"})]})]})]}),t.jsx("div",{className:"space-y-6",children:l.map((u,h)=>{const g=r.has(u.id||h),x=u.enhanced&&(u.pros||u.cons);return t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:h*.1},className:"border border-gray-200 dark:border-gray-700 rounded-lg p-6 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[u.userAvatar?t.jsx("img",{src:u.userAvatar,alt:u.userName,className:"w-10 h-10 rounded-full"}):t.jsx("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900 rounded-full flex items-center justify-center",children:t.jsx(Ke,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:u.userName}),u.verified&&t.jsx(Ms,{className:"w-4 h-4 text-green-500",title:"Doğrulanmış Alıcı"}),x&&t.jsx(qr,{className:"w-4 h-4 text-blue-500",title:"Detaylı İnceleme"})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[t.jsx(Ls,{className:"w-3 h-3"}),t.jsx("span",{children:u.date||new Date(u.createdAt).toLocaleDateString("tr-TR")})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"flex",children:[1,2,3,4,5].map(k=>t.jsx(De,{className:`w-4 h-4 ${k<=u.rating?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600"}`},k))}),t.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[u.rating,"/5"]})]})]}),t.jsx("div",{className:"mb-4",children:t.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:u.comment})}),x&&t.jsx(oe,{children:g&&t.jsxs(m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[u.usageContext&&t.jsxs("div",{className:"mt-4",children:[t.jsxs("h5",{className:"flex items-center space-x-2 font-semibold text-blue-700 dark:text-blue-400 mb-2",children:[t.jsx(zs,{className:"w-4 h-4"}),t.jsx("span",{children:"Kullanım Deneyimi"})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:u.usageContext})]}),u.recommendation&&t.jsxs("div",{className:"mt-4",children:[t.jsxs("h5",{className:"flex items-center space-x-2 font-semibold text-purple-700 dark:text-purple-400 mb-2",children:[t.jsx(Aa,{className:"w-4 h-4"}),t.jsx("span",{children:"Tavsiye"})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 bg-purple-50 dark:bg-purple-900/20 p-3 rounded-lg",children:u.recommendation})]})]})}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("button",{className:"flex items-center space-x-1 text-sm text-gray-500 hover:text-green-600 dark:text-gray-400 dark:hover:text-green-400 transition-colors",children:[t.jsx(Us,{className:"w-4 h-4"}),t.jsx("span",{children:u.helpful||0})]}),t.jsx("button",{className:"flex items-center space-x-1 text-sm text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 transition-colors",children:t.jsx(Fs,{className:"w-4 h-4"})})]}),x&&t.jsxs("button",{onClick:()=>o(u.id||h),className:"flex items-center space-x-1 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors",children:[t.jsx("span",{children:g?"Daha Az":"Detayları Göster"}),g?t.jsx($s,{className:"w-4 h-4"}):t.jsx(Bs,{className:"w-4 h-4"})]})]})]},u.id||h)})}),t.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center space-x-2 text-blue-800 dark:text-blue-200",children:[t.jsx(qr,{className:"w-5 h-5"}),t.jsx("span",{className:"font-semibold",children:"Geliştirilmiş Yorum Sistemi"})]}),t.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:"Yorumlarımız AI teknolojisi ile detaylandırılarak avantaj/dezavantaj analizi, kullanım senaryoları ve tavsiyeler içeriyor. Bu sayede daha bilinçli alışveriş kararları verebilirsiniz."})]})]})};class hl{constructor(){this.cache=new Map,this.maxCacheSize=100,this.defaultTTL=5*60*1e3,this.requestTimes=[],this.maxRequestsPerMinute=15,this.minRequestInterval=4e3,this.lastRequestTime=0}generateKey(e,r=null,a={}){const s={prompt:e==null?void 0:e.substring(0,200),hasImage:!!r,temperature:a.temperature||.7,model:a.model||"gemini-1.5-flash"};return JSON.stringify(s)}get(e){const r=this.cache.get(e);return r?Date.now()>r.expiry?(this.cache.delete(e),null):(console.log("🎯 Cache hit for key:",e.substring(0,50)+"..."),r.data):null}set(e,r,a=this.defaultTTL){this.cache.size>=this.maxCacheSize&&Array.from(this.cache.keys()).slice(0,10).forEach(n=>this.cache.delete(n)),this.cache.set(e,{data:r,expiry:Date.now()+a,created:Date.now()}),console.log("📦 Cached response for key:",e.substring(0,50)+"...")}canMakeRequest(){const e=Date.now();if(e-this.lastRequestTime<this.minRequestInterval){const a=this.minRequestInterval-(e-this.lastRequestTime);return console.log(`⏰ Rate limit: ${Math.ceil(a/1e3)} saniye beklenmeli`),{canRequest:!1,waitTime:a}}const r=e-6e4;return this.requestTimes=this.requestTimes.filter(a=>a>r),this.requestTimes.length>=this.maxRequestsPerMinute?(console.log("⏰ Dakikalık rate limit aşıldı, bekleniyor..."),{canRequest:!1,waitTime:6e4}):{canRequest:!0}}recordRequest(){const e=Date.now();this.requestTimes.push(e),this.lastRequestTime=e}clear(){this.cache.clear(),console.log("🧹 Gemini cache temizlendi")}getStats(){const e=Array.from(this.cache.values()).filter(r=>Date.now()<r.expiry);return{totalItems:this.cache.size,validItems:e.length,recentRequests:this.requestTimes.length,lastRequestTime:this.lastRequestTime,nextRequestAllowed:this.lastRequestTime+this.minRequestInterval}}findSimilarCached(e,r=.8){for(const[a,s]of this.cache.entries())if(!(Date.now()>s.expiry))try{const n=JSON.parse(a);if(n.prompt&&this.calculateSimilarity(e,n.prompt)>r)return console.log("🔍 Benzer cached response bulundu"),s.data}catch{}return null}calculateSimilarity(e,r){if(e===r)return 1;const a=e.length>r.length?e:r,s=e.length>r.length?r:e;return a.length===0?1:(a.length-this.levenshteinDistance(a,s))/a.length}levenshteinDistance(e,r){const a=[];for(let s=0;s<=r.length;s++)a[s]=[s];for(let s=0;s<=e.length;s++)a[0][s]=s;for(let s=1;s<=r.length;s++)for(let n=1;n<=e.length;n++)r.charAt(s-1)===e.charAt(n-1)?a[s][n]=a[s-1][n-1]:a[s][n]=Math.min(a[s-1][n-1]+1,a[s][n-1]+1,a[s-1][n]+1);return a[r.length][e.length]}}const Te=new hl;class Ur{constructor(e=null,r="gemini-1.5-flash"){this.apiKey=e,this.model=r,this.baseURL="https://generativelanguage.googleapis.com/v1beta/models",this.requestQueue=[],this.activeRequests=0,this.maxConcurrentRequests=2,this.requestDelay=4e3}setApiKey(e){this.apiKey=e}setModel(e){this.model=e}validateApiKey(e=this.apiKey){if(!e)throw new Error(Le.API_KEY_MISSING);if(e.length<10)throw new Error(Le.INVALID_API_KEY);return!0}buildUrl(e,r=this.model){return`${this.baseURL}/${r}:${e}?key=${this.apiKey}`}async executeWithQueue(e){return new Promise((r,a)=>{const s={requestFn:e,resolve:r,reject:a};this.requestQueue.push(s),this.processQueue()})}async processQueue(){if(this.activeRequests>=this.maxConcurrentRequests||this.requestQueue.length===0)return;this.activeRequests++;const{requestFn:e,resolve:r,reject:a}=this.requestQueue.shift();try{const s=await e();r(s)}catch(s){a(s)}finally{this.activeRequests--,setTimeout(()=>this.processQueue(),this.requestDelay)}}async generateContent(e,r={}){if(pe.shouldUseOfflineMode())return console.log("🔄 Offline mode: Yerel response kullanılıyor"),e.includes("ürün açıklama")||e.includes("product description")?pe.generateOfflineDescription(r.product||{}):e.includes("etiket")||e.includes("tag")?pe.generateOfflineTags(r.product||{}):e.includes("öneri")||e.includes("recommendation")?pe.generateOfflineRecommendations(r.userProfile||{}):{text:"Şu anda AI servisi yoğunluk nedeniyle kullanılamıyor. Lütfen birkaç dakika sonra tekrar deneyin.",isOffline:!0,finishReason:"STOP"};if(!this.apiKey)throw new Error("Gemini API key is required");this.validateApiKey();const a=Te.generateKey(e,null,r),s=Te.get(a);if(s)return s;const n=Te.findSimilarCached(e,.85);if(n)return n;const o=Te.canMakeRequest();if(!o.canRequest)throw pe.recordFailure(),new Error(`Rate limit: ${Math.ceil(o.waitTime/1e3)} saniye bekleyip tekrar deneyin. API limitlerini aştınız.`);const{model:l=this.model,temperature:c=de.TEMPERATURE,maxOutputTokens:d=de.MAX_TOKENS,topP:u=de.TOP_P,topK:h=de.TOP_K,candidateCount:g=1}=r,x=async()=>{var D,I,v,w,y,P;Te.recordRequest();const k=this.buildUrl("generateContent",l),E=await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}],generationConfig:{temperature:c,maxOutputTokens:d,topP:u,topK:h,candidateCount:g},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]})});if(!E.ok){const N=await E.json().catch(()=>({})),S=((D=N.error)==null?void 0:D.message)||`HTTP ${E.status}: ${E.statusText}`;throw console.error("🚨 Gemini API Error:",{status:E.status,statusText:E.statusText,errorData:N,errorMessage:S,url:E.url}),E.status===429||S.includes("overloaded")?new Error("API istek limiti aşıldı. Lütfen birkaç dakika bekleyip tekrar deneyin."):E.status===401?new Error(Le.INVALID_API_KEY):E.status===404?new Error(Le.MODEL_NOT_AVAILABLE):E.status===503||S.includes("overloaded")?new Error("Gemini AI servisi şu anda aşırı yüklü. Lütfen 10-15 saniye bekleyip tekrar deneyin. (Free tier limiti)"):new Error(S)}const j=await E.json();if(!((P=(y=(w=(v=(I=j==null?void 0:j.candidates)==null?void 0:I[0])==null?void 0:v.content)==null?void 0:w.parts)==null?void 0:y[0])!=null&&P.text))throw new Error("Invalid response format from Gemini API");const T={text:j.candidates[0].content.parts[0].text,finishReason:j.candidates[0].finishReason,safetyRatings:j.candidates[0].safetyRatings,usageMetadata:j.usageMetadata};return pe.recordSuccess(),Te.set(a,T),T};return this.executeWithQueue(()=>yt(x,1,1e4))}async generateContentWithImage(e,r,a={}){if(pe.shouldUseOfflineMode())return console.log("🔄 Offline mode: Görsel analizi yerel olarak yapılıyor"),pe.generateOfflineVisualSearch(a.products||[]);this.validateApiKey();const s=Te.generateKey(e,r,a),n=Te.get(s);if(n)return n;const o=Te.canMakeRequest();if(!o.canRequest)throw pe.recordFailure(),new Error(`Rate limit: ${Math.ceil(o.waitTime/1e3)} saniye bekleyip tekrar deneyin. API limitlerini aştınız.`);const{model:l="gemini-1.5-flash",temperature:c=de.TEMPERATURE,maxOutputTokens:d=de.MAX_TOKENS,topP:u=de.TOP_P,topK:h=de.TOP_K,mimeType:g="image/jpeg"}=a,x=async()=>{var D,I,v,w,y,P;Te.recordRequest();const k=this.buildUrl("generateContent",l),E=await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e},{inline_data:{mime_type:g,data:r}}]}],generationConfig:{temperature:c,maxOutputTokens:d,topP:u,topK:h},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]})});if(!E.ok){const N=await E.json().catch(()=>({})),S=((D=N.error)==null?void 0:D.message)||`HTTP ${E.status}: ${E.statusText}`;throw console.error("🚨 Gemini API Error:",{status:E.status,statusText:E.statusText,errorData:N,errorMessage:S,url:E.url}),E.status===429||S.includes("overloaded")?new Error("API istek limiti aşıldı. Lütfen birkaç dakika bekleyip tekrar deneyin."):E.status===401?new Error(Le.INVALID_API_KEY):E.status===404?new Error(Le.MODEL_NOT_AVAILABLE):E.status===503||S.includes("overloaded")?new Error("Gemini AI servisi şu anda aşırı yüklü. Lütfen 10-15 saniye bekleyip tekrar deneyin. (Free tier limiti)"):new Error(S)}const j=await E.json();if(!((P=(y=(w=(v=(I=j==null?void 0:j.candidates)==null?void 0:I[0])==null?void 0:v.content)==null?void 0:w.parts)==null?void 0:y[0])!=null&&P.text))throw new Error("Invalid response format from Gemini API");const T={text:j.candidates[0].content.parts[0].text,finishReason:j.candidates[0].finishReason,safetyRatings:j.candidates[0].safetyRatings,usageMetadata:j.usageMetadata};return pe.recordSuccess(),Te.set(s,T,2*60*1e3),T};return this.executeWithQueue(()=>yt(x,1,1e4))}async streamContent(e,r,a={}){this.validateApiKey();const{model:s=this.model,temperature:n=de.TEMPERATURE,maxOutputTokens:o=de.MAX_TOKENS,topP:l=de.TOP_P,topK:c=de.TOP_K}=a,d=async()=>{var E,j,T,D,I,v;const u=this.buildUrl("streamGenerateContent",s),g=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}],generationConfig:{temperature:n,maxOutputTokens:o,topP:l,topK:c},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]})});if(!g.ok){const w=await g.json().catch(()=>({}));throw new Error(((E=w.error)==null?void 0:E.message)||`HTTP ${g.status}: ${g.statusText}`)}const x=g.body.getReader(),k=new TextDecoder;let f="";try{for(;;){const{done:w,value:y}=await x.read();if(w)break;f+=k.decode(y,{stream:!0});const P=f.split(`
`);f=P.pop()||"";for(const N of P){const S=N.trim();if(S&&S!=="data: [DONE]")try{const b=S.startsWith("data: ")?S.slice(6):S;if(b){const A=JSON.parse(b),C=(v=(I=(D=(T=(j=A.candidates)==null?void 0:j[0])==null?void 0:T.content)==null?void 0:D.parts)==null?void 0:I[0])==null?void 0:v.text;C&&await r({text:C,finishReason:A.candidates[0].finishReason,safetyRatings:A.candidates[0].safetyRatings})}}catch(b){console.warn("Error parsing streaming response:",b)}}}}finally{x.releaseLock()}};return this.executeWithQueue(()=>yt(d,2,2e3))}async countTokens(e,r=this.model){this.validateApiKey();const a=async()=>{var c;const s=this.buildUrl("countTokens",r),o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}]})});if(!o.ok){const d=await o.json().catch(()=>({}));throw new Error(((c=d.error)==null?void 0:c.message)||`HTTP ${o.status}: ${o.statusText}`)}const l=await o.json();return{totalTokens:l.totalTokens||0,totalBillableCharacters:l.totalBillableCharacters||0}};return this.executeWithQueue(()=>yt(a,1,1e4))}async generateConversationResponse(e,r={}){this.validateApiKey();const{model:a=this.model,temperature:s=de.TEMPERATURE,maxOutputTokens:n=de.MAX_TOKENS,topP:o=de.TOP_P,topK:l=de.TOP_K}=r,c=async()=>{var k,f,E,j,T,D;const d=this.buildUrl("generateContent",a),h={contents:e.map(I=>({role:I.role==="assistant"?"model":"user",parts:[{text:I.content}]})),generationConfig:{temperature:s,maxOutputTokens:n,topP:o,topK:l},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]},g=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(!g.ok){const I=await g.json().catch(()=>({})),v=((k=I.error)==null?void 0:k.message)||`HTTP ${g.status}: ${g.statusText}`;throw console.error("🚨 Gemini API Error:",{status:g.status,statusText:g.statusText,errorData:I,errorMessage:v,url:g.url}),g.status===429||v.includes("overloaded")?new Error("API istek limiti aşıldı. Lütfen birkaç dakika bekleyip tekrar deneyin."):g.status===401?new Error(Le.INVALID_API_KEY):g.status===404?new Error(Le.MODEL_NOT_AVAILABLE):g.status===503||v.includes("overloaded")?new Error("Gemini AI servisi şu anda aşırı yüklü. Lütfen 10-15 saniye bekleyip tekrar deneyin. (Free tier limiti)"):new Error(v)}const x=await g.json();if(!((D=(T=(j=(E=(f=x==null?void 0:x.candidates)==null?void 0:f[0])==null?void 0:E.content)==null?void 0:j.parts)==null?void 0:T[0])!=null&&D.text))throw new Error("Invalid response format from Gemini API");return{text:x.candidates[0].content.parts[0].text,finishReason:x.candidates[0].finishReason,safetyRatings:x.candidates[0].safetyRatings,usageMetadata:x.usageMetadata}};return this.executeWithQueue(()=>yt(c,1,1e4))}async testConnection(){try{return this.validateApiKey(),{success:!0,message:"Connection successful",response:(await this.generateContent("Say 'Hello' if you can hear me.",{maxOutputTokens:10,temperature:0})).text}}catch(e){return{success:!1,message:q(e),error:e}}}async getAvailableModels(){return[{name:"gemini-1.5-flash",displayName:"Gemini 1.5 Flash",description:"Fast and efficient model for text and images",capabilities:["text","vision"]},{name:"gemini-1.5-pro",displayName:"Gemini 1.5 Pro",description:"Most capable model for complex tasks",capabilities:["text","vision"]}]}}let wt=null;function ht(i,e){return wt=new Ur(i,e),wt}function Ve(){return wt||(wt=new Ur),wt}const gl=Ve(),pl=Object.freeze(Object.defineProperty({__proto__:null,createGeminiService:ht,default:Ur,geminiAPI:gl,getGeminiService:Ve},Symbol.toStringTag,{value:"Module"}));class ks{constructor(){this.geminiService=Ve()}async getMatchingProducts(e,r,a={}){try{const{maxRecommendations:s=6,includeComplementary:n=!0,priceRange:o="all"}=a;console.log("🔍 Getting matching products for visual analysis:",e);let l=[];try{l=(await Q.getProducts({limit:100})).products}catch{const{getAllProducts:d}=await ye(async()=>{const{getAllProducts:u}=await Promise.resolve().then(()=>He);return{getAllProducts:u}},void 0);l=d()}return r?(this.geminiService.setApiKey(r),await this.getMatchingProductsWithAI(e,l,s)):this.getMatchingProductsWithAlgorithm(e,l,s)}catch(s){throw console.error("Error in visual search matching:",s),new Error(`Görsel eşleştirme hatası: ${q(s)}`)}}async getMatchingProductsWithAI(e,r,a){try{const s=`Sen akıllı bir moda ve stil uzmanısın. Kullanıcının yüklediği görsel analizi sonuçlarına göre, mevcut ürün kataloğundan en uygun ${a} ürünü seç.

GÖRSEL ANALİZ SONUCU:
${e}

MEVCUT ÜRÜN KATALOĞU:
${r.map(u=>`
- ID: ${u.id}
- İsim: ${u.name}
- Kategori: ${u.category}
- Marka: ${u.brand||"Bilinmiyor"}
- Renk/Açıklama: ${u.description}
- Fiyat: ₺${u.price}
- Puan: ${u.rating}/5
- Stok: ${u.stock}
`).join("")}

EŞLEŞTIRME KRİTERLERİ:
1. 🎨 RENK UYUMU: Görseldeki renklere uygun veya tamamlayıcı renkler
2. 👔 STİL UYUMU: Görseldeki stil ve kategoriye uygun ürünler  
3. 🏷️ KATEGORİ UYUMU: Aynı veya tamamlayıcı kategorilerden seçim
4. 💰 FİYAT UYUMU: Benzer fiyat segmentinden tercih
5. ⭐ KALİTE: Yüksek puanlı ürünleri öncelik ver
6. 📦 STOK: Stokta olan ürünleri seç

ÖZEL TALEPLER:
- Eğer görsel bir gömlek ise → pantolon, ayakkabı, aksesuar öner
- Eğer görsel bir elbise ise → ayakkabı, çanta, takı öner  
- Eğer görsel bir ayakkabı ise → uyumlu kıyafetler öner
- Renk uyumunu çok önemse (tamamlayıcı renkler dahil)
- Stil bütünlüğünü koru

YANIT FORMATI:
Sadece seçilen ürün ID'lerini JSON array olarak ver. ID'ler string veya sayısal olabilir:
["1", "2", "3"] veya [1, 2, 3] formatında

ÖNEMLİ: ID'ler yukarıdaki listeden birebir alınmalı
Başka açıklama ekleme, sadece JSON array döndür.`,n=await this.geminiService.generateContent(s,{temperature:.7,maxOutputTokens:500});console.log("🤖 AI Visual Matching response:",n.text),console.log("🤖 AI Response length:",n.text.length),console.log("🤖 AI Response first 100 chars:",n.text.substring(0,100));let o=n.text.trim().replace(/```json|```/g,"");const l=o.match(/\[([\s\S]*?)\]/);l&&(o=l[0]);let c;try{c=JSON.parse(o)}catch{console.log("JSON parse failed, extracting IDs manually from:",o);const h=o.match(/"([^"]+)"/g);if(h&&h.length>0)c=h.map(g=>g.replace(/"/g,"")),console.log("Extracted string IDs:",c);else{const g=o.match(/\d+/g);c=g?g.map(x=>parseInt(x)):[],console.log("Extracted numeric IDs:",c)}}const d=c.map(u=>{let h=r.find(g=>g.id===u);return!h&&typeof u=="string"&&!isNaN(u)&&(h=r.find(g=>g.id===parseInt(u))),!h&&typeof u=="number"&&(h=r.find(g=>g.id===u.toString())),h}).filter(Boolean).slice(0,a);return console.log("✅ AI Visual Matching products:",d.length),d.length<a*.5?(console.log("⚠️ AI matching found insufficient products, using algorithm fallback"),this.getMatchingProductsWithAlgorithm(e,r,a)):{products:d,matchingMethod:"ai",confidence:d.length>=a*.8?"high":"medium"}}catch(s){return console.warn("AI visual matching failed, using algorithm fallback:",s),console.log("AI Response that failed to parse:",s.response||s.message),this.getMatchingProductsWithAlgorithm(e,r,a)}}getMatchingProductsWithAlgorithm(e,r,a){console.log("🔧 Using algorithm-based visual matching");try{const s=this.extractKeywords(e),n=this.extractColors(e),o=this.extractCategories(e);console.log("Extracted:",{keywords:s,colors:n,categories:o});let c=r.filter(d=>d.stock>0).map(d=>{var k,f,E;let u=0,h=[];return o.forEach(j=>{var w,y,P;const T=j.toLowerCase(),D=((w=d.name)==null?void 0:w.toLowerCase())||"",I=((y=d.category)==null?void 0:y.toLowerCase())||"",v=((P=d.description)==null?void 0:P.toLowerCase())||"";(I.includes(T)||D.includes(T)||v.includes(T))&&(u+=30,h.push(`Kategori: ${j}`))}),n.forEach(j=>{var v,w;const T=j.toLowerCase(),D=((v=d.name)==null?void 0:v.toLowerCase())||"",I=((w=d.description)==null?void 0:w.toLowerCase())||"";(D.includes(T)||I.includes(T))&&(u+=25,h.push(`Renk: ${j}`))}),s.forEach(j=>{var v,w;const T=j.toLowerCase(),D=((v=d.name)==null?void 0:v.toLowerCase())||"",I=((w=d.description)==null?void 0:w.toLowerCase())||"";(D.includes(T)||I.includes(T))&&(u+=15,h.push(`Keyword: ${j}`))}),["shirt","gömlek","dress","elbise","pants","pantolon","jacket","ceket"].some(j=>e.toLowerCase().includes(j))&&((k=d.category)!=null&&k.toLowerCase().includes("giyim")||(f=d.category)!=null&&f.toLowerCase().includes("moda")||(E=d.category)!=null&&E.toLowerCase().includes("clothing"))&&(u+=20,h.push("Giyim kategorisi")),u+=(d.rating||0)*5,d.stock>10&&(u+=5),u===0&&(u=Math.random()*20,h.push("Genel öneri")),{...d,matchScore:u,matchReasons:h}}).sort((d,u)=>u.matchScore-d.matchScore).slice(0,a);if(c.length<3){const d=r.filter(u=>u.stock>0&&!c.some(h=>h.id===u.id)).sort((u,h)=>(h.rating||0)-(u.rating||0)).slice(0,a-c.length);c=[...c,...d]}return console.log("Algorithm matching results:",c.map(d=>({name:d.name,score:d.matchScore,reasons:d.matchReasons}))),{products:c,matchingMethod:"algorithm",confidence:c.length>=a*.7?"medium":"low"}}catch(s){return console.error("Algorithm matching failed:",s),{products:r.filter(o=>o.stock>0).sort((o,l)=>(l.rating||0)-(o.rating||0)).slice(0,a),matchingMethod:"fallback",confidence:"low"}}}extractKeywords(e){const r=e.toLowerCase(),a=[];return["shirt","gömlek","tshirt","tişört","dress","elbise","pants","pantolon","jeans","jacket","ceket","sweater","kazak","hoodie","sweatshirt"].forEach(l=>{r.includes(l)&&a.push(l)}),["casual","günlük","formal","resmi","elegant","şık","sporty","spor","vintage","modern","relaxed","fitted","slim"].forEach(l=>{r.includes(l)&&a.push(l)}),["cotton","pamuk","linen","keten","denim","kot","silk","ipek","wool","yün","polyester"].forEach(l=>{r.includes(l)&&a.push(l)}),[...new Set(a)]}extractColors(e){const r=e.toLowerCase(),a=[];return Object.entries({beige:["beige","bej","krem","cream"],white:["white","beyaz","off-white"],black:["black","siyah"],blue:["blue","mavi","navy","lacivert"],red:["red","kırmızı"],green:["green","yeşil"],brown:["brown","kahverengi","tan"],gray:["gray","grey","gri"],pink:["pink","pembe"],yellow:["yellow","sarı"]}).forEach(([n,o])=>{o.forEach(l=>{r.includes(l)&&a.push(n)})}),[...new Set(a)]}extractCategories(e){const r=e.toLowerCase(),a=[];return Object.entries({Gömlek:["shirt","gömlek","button-down","collar"],"T-shirt":["t-shirt","tshirt","tişört"],Pantolon:["pants","pantolon","trousers","jeans"],Elbise:["dress","elbise"],Ceket:["jacket","ceket","blazer"],Ayakkabı:["shoe","ayakkabı","sneaker","boot"],Aksesuar:["accessory","aksesuar","bag","çanta","watch","saat"]}).forEach(([n,o])=>{o.forEach(l=>{r.includes(l)&&a.push(n)})}),[...new Set(a)]}getComplementaryCategories(e){return{Gömlek:["Pantolon","Ayakkabı","Aksesuar","Ceket"],"T-shirt":["Pantolon","Ayakkabı","Ceket","Aksesuar"],Pantolon:["Gömlek","T-shirt","Ayakkabı","Ceket"],Elbise:["Ayakkabı","Aksesuar","Ceket"],Ayakkabı:["Pantolon","Gömlek","T-shirt","Elbise"],Ceket:["Gömlek","T-shirt","Pantolon"]}[e]||[]}}let or=null;function Fr(){return or||(or=new ks),or}const yl=Object.freeze(Object.defineProperty({__proto__:null,default:ks,getVisualSearchService:Fr},Symbol.toStringTag,{value:"Module"})),xl=({reviews:i})=>{if(!i||i.length===0)return t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-6 text-center",children:[t.jsx(Gs,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Henüz değerlendirme yok"})]});const e=i.reduce((o,l)=>o+l.rating,0)/i.length,r=i.length,a=[5,4,3,2,1].map(o=>i.filter(l=>l.rating===o).length),n=(()=>{const o=i.filter(c=>c.rating>=4).length;i.filter(c=>c.rating<=2).length;const l=o/r*100;return l>=80?{sentiment:"Çok Olumlu",color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20",summary:"Müşteriler bu ürünü çok beğeniyor. Kalite ve performans övgü topluyor."}:l>=60?{sentiment:"Olumlu",color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20",summary:"Genel olarak memnun müşteriler. Bazı küçük eksiklikler belirtilmiş."}:l>=40?{sentiment:"Karışık",color:"text-yellow-600",bgColor:"bg-yellow-50 dark:bg-yellow-900/20",summary:"Karışık yorumlar var. Satın almadan önce dikkatli değerlendirin."}:{sentiment:"Olumsuz",color:"text-red-600",bgColor:"bg-red-50 dark:bg-red-900/20",summary:"Müşteri memnuniyeti düşük. Alternatif ürünlere bakmanızı öneririz."}})();return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Müşteri Değerlendirmeleri"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(De,{className:"w-5 h-5 text-yellow-400 fill-current"}),t.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.toFixed(1)}),t.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["(",r," değerlendirme)"]})]})]}),t.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map((o,l)=>{const c=a[l],d=r>0?c/r*100:0;return t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("span",{className:"text-sm w-8",children:o}),t.jsx(De,{className:"w-4 h-4 text-yellow-400 fill-current"}),t.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:t.jsx(m.div,{className:"bg-yellow-400 h-2 rounded-full",initial:{width:0},animate:{width:`${d}%`},transition:{duration:.8,delay:l*.1}})}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 w-12",children:c})]},o)})})]}),t.jsx("div",{className:`p-6 ${n.bgColor}`,children:t.jsxs("div",{className:"flex items-start space-x-4",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-500 rounded-xl flex items-center justify-center flex-shrink-0",children:t.jsx(Er,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"AI Analizi"}),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${n.color} bg-white dark:bg-gray-800`,children:n.sentiment})]}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:n.summary})]})]})}),t.jsxs("div",{className:"p-6",children:[t.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white mb-4 flex items-center space-x-2",children:[t.jsx(Aa,{className:"w-4 h-4"}),t.jsx("span",{children:"Son Değerlendirmeler"})]}),t.jsx("div",{className:"space-y-4",children:i.slice(0,3).map((o,l)=>t.jsxs(m.div,{className:"border-l-4 border-primary-200 pl-4 py-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:l*.1},children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm",children:o.userName}),t.jsx("div",{className:"flex space-x-1",children:[...Array(5)].map((c,d)=>t.jsx(De,{className:`w-3 h-3 ${d<o.rating?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600"}`},d))})]}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:['"',o.comment,'"']})]},l))})]})]})};class fl{constructor(e){this.geminiService=ht(e)}async generateProductDescription(e){var r;try{const a=e.features?e.features.join(", "):"",s=e.specifications?Object.entries(e.specifications).map(([c,d])=>`${c}: ${d}`).join(", "):"",n=`Aşağıdaki ürün için detaylı ve çekici bir Türkçe ürün açıklaması oluştur:

📦 ÜRÜN BİLGİLERİ:
• İsim: ${e.name}
• Kategori: ${e.category}
• Marka: ${e.brand||"Belirtilmemiş"}
• Fiyat: ₺${((r=e.price)==null?void 0:r.toLocaleString("tr-TR"))||"Belirtilmemiş"}
• Mevcut Açıklama: ${e.description||"Yok"}
• Temel Özellikler: ${a||"Belirtilmemiş"}
• Teknik Özellikler: ${s||"Belirtilmemiş"}
• Puan: ${e.rating||"Henüz puanlanmamış"}/5
• Stok Durumu: ${e.stock>0?`${e.stock} adet mevcut`:"Stokta yok"}

🎯 GÖREVİN:
3-4 paragraf halinde, pazarlama odaklı ama samimi bir Türkçe açıklama yaz. Şunları mutlaka dahil et:

1️⃣ **Ürün Tanıtımı**: Ürünün ne olduğu ve temel faydaları
2️⃣ **Hedef Kitle**: Kim için ideal, hangi ihtiyaçları karşılıyor
3️⃣ **Üstün Özellikler**: Diğer alternatiflerden farkı, öne çıkan özellikleri
4️⃣ **Değer Önerisi**: Neden bu ürünü seçmeli, fiyat-performans değerlendirmesi

📝 **Yazım Kuralları:**
- Türkçe karakter kullan (ğ, ü, ş, ı, ç, ö)
- Samimi ama profesyonel dil
- Abartısız, gerçekçi ifadeler
- Müşteriye direkt hitap et ("Bu ürün ile...")
- Teknik terimleri açıkla

Sadece açıklamayı ver, başka açıklama ekleme.`;let l=(await this.geminiService.generateContent(n)).text.trim();return l=l.replace(/^#+\s*/,"").replace(/\*\*/g,"").trim(),l||e.description||"Bu harika ürün hakkında detaylı bilgi yakında eklenecek."}catch(a){if(console.error("Error generating product description:",a),e.description)return e.description;const s=e.category||"ürün",n=e.brand?` ${e.brand} markasından`:"",o=e.price?` ₺${e.price.toLocaleString("tr-TR")} fiyatında`:"",l=e.rating?` ${e.rating}/5 yıldız puana sahip`:"";return`${n} kaliteli ${s}${o}${l}. Bu ürün size uygun mu? Detayları inceleyin ve size en uygun seçimi yapın.`}}async generateProductTags(e){try{const r=`Aşağıdaki ürün için SEO dostu Türkçe etiketler (taglar) oluştur:

Ürün: ${e.name}
Kategori: ${e.category}
Marka: ${e.brand||"Belirtilmemiş"}
Açıklama: ${e.description||"Yok"}

10-15 adet kısa, arama dostu etiket oluştur. Etiketleri virgülle ayırarak ver.
Örnekler: "yüksek kalite", "uygun fiyat", "trend", "popüler", "dayanıklı" vb.`;return(await this.geminiService.generateContent(r)).text.trim().split(",").map(n=>n.trim()).filter(n=>n.length>0)}catch(r){console.error("Error generating product tags:",r);const a=[];return e.category&&a.push(e.category.toLowerCase()),e.brand&&a.push(e.brand.toLowerCase()),e.price&&(e.price<100?a.push("uygun fiyat"):e.price>500&&a.push("premium")),e.rating&&e.rating>=4&&a.push("yüksek puan"),a.push("kaliteli","önerilen"),a.length>0?a:["kaliteli","uygun fiyat","önerilen"]}}async generateProductComparison(e,r){try{const a=`Bu iki ürünü karşılaştır ve Türkçe detaylı bir karşılaştırma metni oluştur:

ÜRÜN 1:
- İsim: ${e.name}
- Fiyat: ${e.price} TRY
- Kategori: ${e.category}
- Puan: ${e.rating||"Yok"}

ÜRÜN 2:
- İsim: ${r.name}
- Fiyat: ${r.price} TRY
- Kategori: ${r.category}
- Puan: ${r.rating||"Yok"}

Karşılaştırmada şunları içer:
1. Fiyat-performans analizi
2. Hangi durumda hangisinin tercih edilebileceği
3. Her ürünün artıları ve eksileri
4. Tavsiye notu

Objektif ve yardımcı bir ton kullan.`;return(await this.geminiService.generateContent(a)).text.trim()}catch(a){return console.error("Error generating product comparison:",a),"Ürün karşılaştırması şu anda mevcut değil."}}async generateCategoryDescription(e,r){try{const a=r.length,s=r.length>0?Math.round(r.reduce((c,d)=>c+d.price,0)/r.length):0,n=[...new Set(r.map(c=>c.brand).filter(Boolean))],o=`"${e}" kategorisi için çekici ve bilgilendirici bir Türkçe kategori açıklaması yaz:

Kategori İstatistikleri:
- Ürün sayısı: ${a}
- Ortalama fiyat: ${s} TRY
- Mevcut markalar: ${n.join(", ")}

2-3 paragraf halinde şunları içer:
1. Bu kategorideki ürünlerin genel özellikleri
2. Müşteriler için ne tür faydalar sağladığı
3. Alışveriş yaparken dikkat edilmesi gerekenler
4. Bu kategorideki ürün çeşitliliği hakkında bilgi

Kategori sayfası için uygun, SEO dostu bir ton kullan.`;return(await this.geminiService.generateContent(o)).text.trim()}catch(a){return console.error("Error generating category description:",a),`${e} kategorisinde kaliteli ürünler bulabilirsiniz.`}}async generateRecommendationText(e,r,a="general"){var s,n,o,l;try{const c=`Kullanıcı için kişiselleştirilmiş ürün önerisi metni oluştur:

Önerilen Ürünler:
${e.map((u,h)=>`${h+1}. ${u.name} - ${u.price} TRY`).join(`
`)}

Kullanıcı Tercihleri:
- Favori kategoriler: ${((s=r.favoriteCategories)==null?void 0:s.join(", "))||"Yok"}
- Tercih edilen markalar: ${((n=r.preferredBrands)==null?void 0:n.join(", "))||"Yok"}
- Fiyat aralığı: ${((o=r.priceRange)==null?void 0:o[0])||0}-${((l=r.priceRange)==null?void 0:l[1])||5e4} TRY

Bağlam: ${a}

Bu önerileri neden yaptığını açıklayan, kişiselleştirilmiş ve ikna edici bir metin yaz.
2-3 cümle olsun ve kullanıcıya samimi bir şekilde seslenen bir ton kullan.`;return(await this.geminiService.generateContent(c)).text.trim()}catch(c){return console.error("Error generating recommendation text:",c),"Size özel seçilmiş bu ürünler beğeninizi kazanacak!"}}async generatePromotionText(e){try{const r=`Aşağıdaki promosyon için çekici pazarlama metni oluştur:

Promosyon Detayları:
- Başlık: ${e.title||"Özel Fırsat"}
- İndirim: ${e.discount||"0"}%
- Geçerlilik: ${e.validUntil||"Sınırlı süre"}
- Ürün/Kategori: ${e.target||"Seçili ürünler"}

Aciliyet hissi uyandıran, çekici ve aksiyon odaklı bir metin yaz.
1-2 cümle olsun, satışa yönlendirici olsun.`;return(await this.geminiService.generateContent(r)).text.trim()}catch(r){return console.error("Error generating promotion text:",r),"Kaçırılmayacak özel fırsat! Sınırlı süre geçerli."}}}const bl=i=>new fl(i),kl=async(i,e)=>{if(!e)return i;try{const r=bl(e),[a,s]=await Promise.all([r.generateProductDescription(i),r.generateProductTags(i)]);return{...i,aiDescription:a,aiTags:s,aiEnhanced:!0,aiGeneratedAt:new Date().toISOString()}}catch(r){return console.error("Error enhancing product with AI:",r),i}},wl=()=>{var Ne,Br;const{slug:i}=Da();Ht();const{state:e,dispatch:r,actionTypes:a}=ae(),[s,n]=p.useState(null),[o,l]=p.useState([]),[c,d]=p.useState(0),[u,h]=p.useState({}),[g,x]=p.useState(1),[k,f]=p.useState(!0),[E,j]=p.useState(!1),[T,D]=p.useState("description"),[I,v]=p.useState(null),[w,y]=p.useState(!1),[P,N]=p.useState([]),[S,b]=p.useState(!1),[A,C]=p.useState(null),[_,L]=p.useState([]),[R,O]=p.useState(!1),$=s&&e.user.wishlist.some(z=>z.id===s.id);p.useEffect(()=>{V()},[i]);const W=async()=>{if(s!=null&&s.id){O(!0);try{const{collection:z,query:Y,where:me,orderBy:Ze,getDocs:Jt}=await ye(async()=>{const{collection:Ee,query:Fe,where:nt,orderBy:pt,getDocs:ot}=await import("./firebase-BTrwVOnm.js").then(Tt=>Tt.a2);return{collection:Ee,query:Fe,where:nt,orderBy:pt,getDocs:ot}},[]),{db:Ns}=await ye(async()=>{const{db:Ee}=await Promise.resolve().then(()=>Oo);return{db:Ee}},void 0),js=Y(z(Ns,"reviews"),me("productId","==",s.id)),Gr=(await Jt(js)).docs.map(Ee=>{var Fe,nt,pt;return{id:Ee.id,...Ee.data(),date:((pt=(nt=(Fe=Ee.data().createdAt)==null?void 0:Fe.toDate)==null?void 0:nt.call(Fe))==null?void 0:pt.toLocaleDateString("tr-TR"))||Ee.data().date}});Gr.sort((Ee,Fe)=>{var ot,Tt,It,Kr;const nt=((Tt=(ot=Ee.createdAt)==null?void 0:ot.toDate)==null?void 0:Tt.call(ot))||new Date(Ee.date);return(((Kr=(It=Fe.createdAt)==null?void 0:It.toDate)==null?void 0:Kr.call(It))||new Date(Fe.date))-nt}),L(Gr)}catch(z){console.error("Error loading reviews:",z),r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Yorumlar yüklenirken hata oluştu",duration:5e3}})}finally{O(!1)}}};p.useEffect(()=>{s!=null&&s.id&&W()},[s==null?void 0:s.id]);const ee=async()=>{if(!(!s||w)){if(!e.settings.geminiApiKey){r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"warning",message:"AI özelliklerini kullanmak için ayarlardan Gemini API anahtarınızı girin.",duration:5e3}});return}y(!0);try{r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"info",message:"AI destekli açıklama oluşturuluyor...",duration:3e3}});const z=await kl(s,e.settings.geminiApiKey);v(z),r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:"AI destekli açıklama başarıyla oluşturuldu!",duration:4e3}})}catch(z){console.error("Error generating AI content:",z),console.error("Error details:",{message:z.message,status:z.status,response:z.response});let Y="AI açıklama oluşturulurken hata oluştu. Lütfen tekrar deneyin.";z.message.includes("overloaded")?Y="AI servisi şu anda aşırı yüklü. Lütfen birkaç saniye sonra tekrar deneyin.":z.message.includes("Rate limit")?Y="API kullanım limiti aşıldı. Lütfen bir dakika bekleyin.":z.message.includes("Invalid API key")&&(Y="API anahtarı geçersiz. Lütfen ayarlardan kontrol edin."),r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:Y,duration:5e3}})}finally{y(!1)}}},G=async()=>{if(!(!s||S)){b(!0);try{const z=`
Product Analysis:

**1. Product Type/Category:** ${s.category} - ${s.name}

**2. Key Visual Features:**
* **Brand:** ${s.brand}
* **Price Range:** ₺${s.price} (${s.price<1e3?"Budget":s.price<5e3?"Mid-range":"Premium"})
* **Style:** ${s.description}
* **Category:** ${s.category}

**3. Product Description:** ${s.description}

**4. Features:** ${s.features?s.features.join(", "):"Standard features"}

**5. Target Matching:**
* Find complementary products that work well with this ${s.category.toLowerCase()}
* Consider similar price range and style
* Look for products that complement this brand and category
* Focus on creating a complete look or setup

**Suggested Compatible Categories:**
${s.category.toLowerCase().includes("gömlek")||s.category.toLowerCase().includes("shirt")?"* Pantolon, Ayakkabı, Ceket, Aksesuar":s.category.toLowerCase().includes("pantolon")||s.category.toLowerCase().includes("pants")?"* Gömlek, T-shirt, Ayakkabı, Ceket":s.category.toLowerCase().includes("ayakkabı")||s.category.toLowerCase().includes("shoe")?"* Pantolon, Gömlek, Aksesuar":"* Complementary accessories and matching items"}
      `.trim();console.log("🔍 Finding compatible products for:",s.name),console.log("📝 Product analysis:",z);const me=await Fr().getMatchingProducts(z,e.settings.geminiApiKey,{maxRecommendations:6,includeComplementary:!0}),Ze=me.products.filter(Jt=>Jt.id!==s.id);N(Ze),C(me.matchingMethod),console.log("✅ Compatible products found:",{method:me.matchingMethod,confidence:me.confidence,products:Ze.length})}catch(z){console.error("Error finding compatible products:",z),r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Uyumlu ürünler yüklenirken hata oluştu",duration:5e3}})}finally{b(!1)}}},V=async()=>{var z;try{f(!0);const Y=await Q.getProductBySlug(i);n(Y),l(Y.relatedProducts);const me={};(z=Y.variants)==null||z.forEach(Ze=>{Ze.options.length>0&&(me[Ze.id]=Ze.options[0])}),h(me)}catch{r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Ürün yüklenirken hata oluştu",duration:5e3}})}finally{f(!1)}},se=async()=>{if(s){j(!0);try{const z=await Ae.addItem(s.id,g,u);r({type:a.SET_CART,payload:z}),r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:`${s.name} sepete eklendi`,duration:3e3}})}catch(z){r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:z.message||"Ürün sepete eklenirken hata oluştu",duration:5e3}})}finally{j(!1)}}},be=()=>{s&&r($?{type:a.REMOVE_FROM_WISHLIST,payload:s.id}:{type:a.ADD_TO_WISHLIST,payload:s})},ue=z=>{z>=1&&z<=((s==null?void 0:s.stock)||1)&&x(z)},Ye=(z,Y)=>{h(me=>({...me,[z]:Y}))},M=async()=>{if(navigator.share)try{await navigator.share({title:s.name,text:s.shortDescription,url:window.location.href})}catch(z){console.log("Error sharing:",z)}else navigator.clipboard.writeText(window.location.href),r({type:a.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:"Link panoya kopyalandı",duration:3e3}})},X=z=>Array.from({length:5},(Y,me)=>t.jsx(De,{className:`w-5 h-5 ${me<Math.floor(z)?"fill-yellow-400 text-yellow-400":me<z?"fill-yellow-200 text-yellow-400":"text-gray-300"}`},me));return k?t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsx("div",{className:"animate-pulse",children:t.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[t.jsx("div",{className:"aspect-square bg-gray-200 dark:bg-gray-700 rounded-2xl"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),t.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"}),t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3"})]})]})})}):s?t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400 mb-8",children:[t.jsx(ie,{to:"/",className:"hover:text-primary-600",children:"Ana Sayfa"}),t.jsx("span",{children:"/"}),t.jsx(ie,{to:"/products",className:"hover:text-primary-600",children:"Ürünler"}),t.jsx("span",{children:"/"}),t.jsx("span",{className:"text-gray-900 dark:text-white",children:s.name})]}),t.jsxs(ie,{to:"/products",className:"inline-flex items-center space-x-2 text-primary-600 hover:text-primary-700 mb-6 font-medium",children:[t.jsx(Ea,{className:"w-4 h-4"}),t.jsx("span",{children:"Ürünlere geri dön"})]}),t.jsxs("div",{className:"grid lg:grid-cols-2 gap-12",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs(m.div,{className:"aspect-square overflow-hidden rounded-2xl bg-gray-100 dark:bg-gray-700 relative",layoutId:`product-image-${s.id}`,children:[s.discount>0&&t.jsxs("div",{className:"absolute top-4 left-4 z-10 bg-red-500 text-white px-3 py-1 rounded-lg font-semibold",children:["%",s.discount," İndirim"]}),((Ne=s.aiGenerated)==null?void 0:Ne.description)&&t.jsx("div",{className:"absolute top-4 right-4 z-10 bg-purple-500 text-white p-2 rounded-lg",title:"AI Generated Content",children:t.jsx(qe,{className:"w-4 h-4"})}),t.jsx("img",{src:s.images[c],alt:s.name,className:"w-full h-full object-cover"})]}),s.images.length>1&&t.jsx("div",{className:"flex space-x-2",children:s.images.map((z,Y)=>t.jsx("button",{onClick:()=>d(Y),className:`flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-colors ${c===Y?"border-primary-500":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:t.jsx("img",{src:z,alt:`${s.name} ${Y+1}`,className:"w-full h-full object-cover"})},Y))})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-primary-600 font-medium mb-2",children:s.brand}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:s.name}),t.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[t.jsx("div",{className:"flex items-center space-x-1",children:X(s.rating)}),t.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["(",s.reviewCount," değerlendirme)"]})]}),t.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[t.jsxs("span",{className:"text-3xl font-bold text-primary-600",children:[K.CURRENCY_SYMBOL,s.price.toLocaleString("tr-TR")]}),s.originalPrice>s.price&&t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("span",{className:"text-xl text-gray-500 line-through",children:[K.CURRENCY_SYMBOL,s.originalPrice.toLocaleString("tr-TR")]}),t.jsxs("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-lg text-sm font-medium",children:["%",s.discount," tasarruf"]})]})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 leading-relaxed",children:s.shortDescription})]}),s.variants&&s.variants.length>0&&t.jsx("div",{className:"space-y-4",children:s.variants.map(z=>t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:z.name}),t.jsx("div",{className:"flex flex-wrap gap-2",children:z.options.map(Y=>t.jsx("button",{onClick:()=>Ye(z.id,Y),className:`px-4 py-2 rounded-lg border-2 transition-colors font-medium ${u[z.id]===Y?"border-primary-500 bg-primary-50 text-primary-700 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"}`,children:Y},Y))})]},z.id))}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Miktar"}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"flex items-center border border-gray-300 dark:border-gray-600 rounded-lg",children:[t.jsx("button",{onClick:()=>ue(g-1),disabled:g<=1,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(Ta,{className:"w-4 h-4"})}),t.jsx("span",{className:"px-4 py-2 font-medium",children:g}),t.jsx("button",{onClick:()=>ue(g+1),disabled:g>=s.stock,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(Ia,{className:"w-4 h-4"})})]}),t.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[s.stock," adet stokta"]})]})]}),s.stock<=5&&s.stock>0&&t.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-3",children:t.jsxs("p",{className:"text-orange-800 dark:text-orange-200 font-medium",children:["⚠️ Son ",s.stock," adet! Hemen sipariş verin."]})}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsxs(m.button,{onClick:se,disabled:E||s.stock===0,className:"flex-1 bg-primary-600 hover:bg-primary-700 disabled:bg-gray-400 text-white py-4 px-6 rounded-xl font-semibold transition-colors flex items-center justify-center space-x-2",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(at,{className:"w-5 h-5"}),t.jsx("span",{children:E?"Ekleniyor...":s.stock===0?"Stokta Yok":"Sepete Ekle"})]}),t.jsx(m.button,{onClick:be,className:`p-4 rounded-xl border-2 transition-colors ${$?"border-red-500 bg-red-50 text-red-500 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:t.jsx(ge,{className:`w-5 h-5 ${$?"fill-current":""}`})}),t.jsx(m.button,{onClick:M,className:"p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 hover:border-gray-400 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:t.jsx(Ks,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-6 border-t border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"text-center",children:[t.jsx(Ra,{className:"w-6 h-6 text-primary-600 mx-auto mb-2"}),t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Ücretsiz Kargo"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"500₺ üzeri"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx(Hs,{className:"w-6 h-6 text-primary-600 mx-auto mb-2"}),t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Güvenli Ödeme"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"SSL korumalı"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx(qs,{className:"w-6 h-6 text-primary-600 mx-auto mb-2"}),t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"İade Garantisi"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"30 gün"})]})]})]})]}),t.jsxs("div",{className:"mt-16",children:[t.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:t.jsx("nav",{className:"flex space-x-8",children:[{id:"description",label:"Açıklama"},{id:"specifications",label:"Özellikler"},{id:"reviews",label:"Yorumlar"}].map(z=>t.jsx("button",{onClick:()=>D(z.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${T===z.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:z.label},z.id))})}),t.jsx("div",{className:"py-8",children:t.jsxs(oe,{mode:"wait",children:[T==="description"&&t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"prose dark:prose-invert max-w-none",children:[e.settings.geminiApiKey&&!I&&t.jsx(m.div,{className:"mb-6 p-4 bg-gradient-to-r from-blue-50 via-purple-50 to-blue-50 dark:from-blue-900/20 dark:via-purple-900/10 dark:to-blue-900/20 rounded-2xl border border-blue-200/50 dark:border-blue-800/50",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(m.div,{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(xe,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"AI Destekli Açıklama"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Bu ürün için AI ile geliştirilmiş detaylı açıklama oluştur"})]})]}),t.jsxs(m.button,{onClick:ee,disabled:w,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50",whileHover:{scale:w?1:1.02},whileTap:{scale:w?1:.98},children:[t.jsx(m.div,{animate:w?{rotate:360}:{},transition:w?{duration:1,repeat:1/0,ease:"linear"}:{},children:t.jsx(Vs,{className:"w-4 h-4"})}),t.jsx("span",{children:w?"Oluşturuluyor...":"AI Açıklama Oluştur"})]})]})}),I&&t.jsx(m.div,{className:"mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:t.jsxs("div",{className:"bg-gradient-to-r from-green-50 via-blue-50 to-green-50 dark:from-green-900/20 dark:via-blue-900/10 dark:to-green-900/20 rounded-2xl p-6 border border-green-200/50 dark:border-green-800/50",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(m.div,{className:"w-6 h-6 bg-gradient-to-br from-green-500 to-blue-500 rounded-lg flex items-center justify-center",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:t.jsx(xe,{className:"w-3 h-3 text-white"})}),t.jsx("span",{className:"font-semibold text-green-800 dark:text-green-200",children:"AI Destekli Açıklama"})]}),t.jsx("div",{className:"text-gray-800 dark:text-gray-200 leading-relaxed",children:(Br=I.aiDescription)==null?void 0:Br.split(`
`).map((z,Y)=>t.jsx("p",{className:"mb-3 last:mb-0",children:z},Y))}),I.aiTags&&I.aiTags.length>0&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-green-200/50 dark:border-green-700/50",children:[t.jsx("p",{className:"text-sm font-medium text-green-700 dark:text-green-300 mb-2",children:"AI Etiketler:"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:I.aiTags.map((z,Y)=>t.jsx(m.span,{className:"px-3 py-1 bg-green-100 dark:bg-green-800/30 text-green-800 dark:text-green-200 text-xs font-medium rounded-full",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:Y*.1},whileHover:{scale:1.05},children:z},Y))})]})]})}),t.jsxs("div",{className:I?"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700":"",children:[t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:I?"Temel Açıklama":"Ürün Açıklaması"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 leading-relaxed text-lg",children:s.description})]}),s.features&&t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Öne Çıkan Özellikler"}),t.jsx("ul",{className:"space-y-2",children:s.features.map((z,Y)=>t.jsxs("li",{className:"flex items-start space-x-2",children:[t.jsx("span",{className:"text-primary-600 mt-1",children:"•"}),t.jsx("span",{children:z})]},Y))})]})]},"description"),T==="specifications"&&t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-2xl p-6",children:[t.jsx("h3",{className:"text-xl font-semibold mb-6",children:"Teknik Özellikler"}),t.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:Object.entries(s.specifications||{}).map(([z,Y])=>t.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:z}),t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:Y})]},z))})]})},"specifications"),T==="reviews"&&t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:R?t.jsx("div",{className:"text-center py-8",children:t.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-600 dark:text-gray-400",children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-primary-600 border-t-transparent rounded-full"}),t.jsx("span",{children:"Yorumlar yükleniyor..."})]})}):t.jsxs("div",{className:"space-y-8",children:[_.length>0&&t.jsx(xl,{reviews:_}),t.jsx(ml,{reviews:_,productName:(s==null?void 0:s.name)||""})]})},"reviews")]})})]}),t.jsx("div",{className:"mt-16",children:P.length===0&&!S?t.jsx("div",{className:"text-center",children:t.jsxs("div",{className:"bg-gradient-to-r from-pink-50 via-purple-50 to-pink-50 dark:from-pink-900/20 dark:via-purple-900/10 dark:to-pink-900/20 rounded-3xl p-12 border border-pink-200/50 dark:border-pink-800/50",children:[t.jsx(m.div,{className:"mx-auto w-20 h-20 bg-gradient-to-br from-pink-500 to-purple-500 rounded-3xl flex items-center justify-center mb-8 shadow-xl",whileHover:{scale:1.05,rotate:5},transition:{duration:.3},children:t.jsx(ge,{className:"h-10 w-10 text-white"})}),t.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Bu Ürünle Uyumlu Olanları Keşfedin"}),t.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-2xl mx-auto leading-relaxed",children:"AI destekli akıllı sistem ile bu ürüne mükemmel uyum sağlayacak diğer ürünleri keşfedin. Stil bütünlüğü için özel önerilerimizi görün."}),t.jsxs(m.button,{onClick:G,className:"inline-flex items-center px-8 py-4 bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-700 hover:to-purple-700 text-white font-semibold rounded-2xl transition-all duration-300 shadow-lg hover:shadow-xl group",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(Gt,{className:"w-5 h-5 mr-3 group-hover:rotate-12 transition-transform duration-300"}),"Uyumlu Ürünleri Keşfet",t.jsx(Nt,{className:"w-4 h-4 ml-3 group-hover:translate-x-1 transition-transform duration-300"})]})]})}):S?t.jsxs("div",{className:"text-center py-16",children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"mx-auto w-16 h-16 bg-gradient-to-br from-pink-500 to-purple-500 rounded-full flex items-center justify-center mb-6 shadow-xl",children:t.jsx(ge,{className:"w-8 h-8 text-white"})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Uyumlu Ürünler Bulunuyor..."}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"AI sistemi bu ürüne en uygun olanları analiz ediyor"})]}):P.length>0?t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(m.div,{className:"w-8 h-8 bg-gradient-to-br from-pink-500 to-purple-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(ge,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Bu Ürünle Uyumlu Olanlar (",P.length,")"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:A==="ai"?"🤖 AI ile önerilen uyumlu ürünler":A==="algorithm"?"🔧 Akıllı algoritma ile seçilen ürünler":"Size özel ürün önerileri"})]})]}),t.jsxs(m.button,{onClick:G,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white font-medium rounded-xl transition-all duration-300",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(Qe,{className:"w-4 h-4"}),t.jsx("span",{children:"Yenile"})]})]}),t.jsxs("div",{className:"bg-gradient-to-r from-pink-50 via-purple-50 to-pink-50 dark:from-pink-900/20 dark:via-purple-900/10 dark:to-pink-900/20 rounded-2xl p-4 border border-pink-200/50 dark:border-pink-800/50 mb-8",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx(xe,{className:"w-4 h-4 text-pink-600"}),t.jsx("span",{className:"font-medium text-pink-800 dark:text-pink-200",children:"Öneriler Hazır!"})]}),t.jsxs("p",{className:"text-pink-700 dark:text-pink-300 text-sm",children:[P.length," ürün bu ürününüzle mükemmel uyum sağlayacak.",A==="ai"?" AI ile analiz edildi.":" Akıllı algoritma ile seçildi."]})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:P.map((z,Y)=>t.jsx(m.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},transition:{delay:Y*.1,duration:.3},children:t.jsx(Xe,{product:z})},z.id))})]}):null})]}):t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Ürün bulunamadı"}),t.jsx(ie,{to:"/products",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Ürünlere geri dön"})]})})},vl=()=>{const{dispatch:i,actionTypes:e}=ae(),[r,a]=p.useState([]),[s,n]=p.useState(!0);p.useEffect(()=>{o()},[]);const o=async()=>{try{const d=await Q.getCategories();a(d)}catch{i({type:e.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Kategoriler yüklenirken hata oluştu",duration:5e3}})}finally{n(!1)}},l={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},c={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}};return t.jsxs(m.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",variants:l,initial:"hidden",animate:"visible",children:[t.jsxs(m.div,{className:"text-center mb-12",variants:c,children:[t.jsx(m.div,{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-3xl bg-gradient-to-br from-primary-500 to-accent-500 mb-6 shadow-xl",whileHover:{scale:1.05,rotate:5},transition:{duration:.3},children:t.jsx(Cr,{className:"h-8 w-8 text-white"})}),t.jsx(m.h1,{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",variants:c,children:"Kategoriler"}),t.jsx(m.p,{className:"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-3xl mx-auto leading-relaxed",variants:c,children:"İhtiyacınız olan ürünleri kategoriler halinde keşfedin"})]}),s?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((d,u)=>t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 aspect-video rounded-2xl mb-4"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})]},u))}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map((d,u)=>t.jsx(m.div,{variants:c,whileHover:{y:-4},transition:{duration:.2},children:t.jsxs(ie,{to:`/categories/${d.id}`,className:"group block bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsxs("div",{className:"aspect-video bg-gradient-to-br from-primary-100 to-accent-100 dark:from-primary-900/30 dark:to-accent-900/30 flex items-center justify-center relative",children:[t.jsx("span",{className:"text-6xl",children:d.icon}),t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white group-hover:text-primary-600 transition-colors",children:d.name}),t.jsx(Nt,{className:"w-5 h-5 text-gray-400 group-hover:text-primary-600 group-hover:translate-x-1 transition-all duration-200"})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:d.description}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm font-medium text-primary-600",children:[d.productCount," ürün"]}),t.jsx("span",{className:"text-sm text-gray-500 group-hover:text-primary-600 transition-colors",children:"Keşfet →"})]})]})]})},d.id))})]})};class Nl{constructor(){this.ordersCollection="orders"}async processAutomaticCheckout(e,r){var a,s,n,o,l,c,d,u,h,g;try{console.log("🛒 Processing automatic checkout...",{items:e.items.length,total:((a=e.totals)==null?void 0:a.total)||0,user:((s=r==null?void 0:r.profile)==null?void 0:s.displayName)||"Anonymous"});const x={orderId:zo(),userId:((n=r==null?void 0:r.profile)==null?void 0:n.id)||(r==null?void 0:r.id)||(r==null?void 0:r.uid)||"anonymous",userEmail:((o=r==null?void 0:r.profile)==null?void 0:o.email)||(r==null?void 0:r.email)||null,userName:((l=r==null?void 0:r.profile)==null?void 0:l.displayName)||(r==null?void 0:r.displayName)||"Anonymous User",items:e.items.map(E=>({productId:E.productId,productName:E.productName||`Ürün ${E.productId}`,quantity:E.quantity,price:E.price||0,total:(E.price||0)*E.quantity})),subtotal:((c=e.totals)==null?void 0:c.subtotal)||0,tax:((d=e.totals)==null?void 0:d.tax)||0,shipping:((u=e.totals)==null?void 0:u.shipping)||0,discount:((h=e.totals)==null?void 0:h.discount)||0,total:((g=e.totals)==null?void 0:g.total)||0,paymentMethod:"auto-pay",paymentStatus:"completed",paymentDate:new Date().toISOString(),orderStatus:"confirmed",deliveryStatus:"preparing",estimatedDelivery:this.calculateEstimatedDelivery(),createdAt:te(),updatedAt:te(),orderSource:"web-app",isAutomatic:!0};console.log("📝 Order data prepared:",x);const k=await ct(Z(F,this.ordersCollection),x),f={...x,firebaseId:k.id,createdAt:new Date};return console.log("✅ Order saved to Firebase:",k.id),this.logOrderSuccess(f),{success:!0,order:f,message:"Siparişiniz başarıyla alındı!"}}catch(x){return console.error("❌ Automatic checkout failed:",x),{success:!1,error:x.message,message:"Sipariş işlemi sırasında hata oluştu. Lütfen tekrar deneyin."}}}async getUserOrderHistory(e,r=10){try{console.log("📋 Fetching order history for user:",e);const a=J(Z(F,this.ordersCollection),H("userId","==",e),Ge("createdAt","desc"),Ie(r)),s=await ne(a),n=[];return s.forEach(o=>{var l;n.push({id:o.id,...o.data(),createdAt:((l=o.data().createdAt)==null?void 0:l.toDate())||new Date})}),console.log("✅ Order history fetched:",n.length,"orders"),n}catch(a){return console.error("❌ Error fetching order history:",a),[]}}async getOrderById(e){var r;try{const a=J(Z(F,this.ordersCollection),H("orderId","==",e)),s=await ne(a);if(!s.empty){const n=s.docs[0];return{id:n.id,...n.data(),createdAt:((r=n.data().createdAt)==null?void 0:r.toDate())||new Date}}return null}catch(a){return console.error("❌ Error fetching order:",a),null}}prepareOrderDataForAI(e){var a;if(!e||e.length===0)return{summary:"Kullanıcının sipariş geçmişi bulunmuyor.",categories:[],averageOrderValue:0,totalOrders:0,preferences:{}};const r={totalOrders:e.length,totalSpent:0,categories:{},brands:{},priceRanges:{budget:0,mid:0,premium:0},orderFrequency:this.calculateOrderFrequency(e),lastOrderDate:((a=e[0])==null?void 0:a.createdAt)||new Date,favoriteCategories:[],averageOrderValue:0};return e.forEach(s=>{var n;r.totalSpent+=s.total||0,(n=s.items)==null||n.forEach(o=>{const l=this.extractCategoryFromProduct(o);r.categories[l]=(r.categories[l]||0)+o.quantity;const c=o.total||o.price*o.quantity;c<1e3?r.priceRanges.budget++:c<5e3?r.priceRanges.mid++:r.priceRanges.premium++})}),r.averageOrderValue=r.totalSpent/r.totalOrders,r.favoriteCategories=Object.entries(r.categories).sort(([,s],[,n])=>n-s).slice(0,3).map(([s])=>s),r}calculateEstimatedDelivery(){const e=new Date;return new Date(e.getTime()+3*24*60*60*1e3).toISOString()}calculateOrderFrequency(e){if(e.length<2)return"first-time";const r=new Date(e[e.length-1].createdAt),n=(new Date(e[0].createdAt)-r)/(1e3*60*60*24)/(e.length-1);return n<7?"very-frequent":n<30?"frequent":n<90?"regular":"occasional"}extractCategoryFromProduct(e){const r=(e.productName||"").toLowerCase();return r.includes("iphone")||r.includes("phone")||r.includes("telefon")?"Elektronik":r.includes("laptop")||r.includes("computer")||r.includes("bilgisayar")?"Bilgisayar":r.includes("shirt")||r.includes("gömlek")||r.includes("tshirt")?"Giyim":r.includes("shoe")||r.includes("ayakkab")?"Ayakkabı":r.includes("book")||r.includes("kitap")?"Kitap":r.includes("headphone")||r.includes("kulaklık")?"Aksesuar":"Genel"}logOrderSuccess(e){console.log("🎉 Order Success Summary:"),console.log(`   📦 Order ID: ${e.orderId}`),console.log(`   👤 Customer: ${e.userName}`),console.log(`   💰 Total: ₺${e.total}`),console.log(`   📱 Items: ${e.items.length} products`),console.log(`   ⏰ Date: ${new Date(e.paymentDate).toLocaleString("tr-TR")}`),console.log(`   🚀 Status: ${e.orderStatus}`)}async getOrderStats(e){try{const r=await this.getUserOrderHistory(e,100);if(r.length===0)return{totalOrders:0,totalSpent:0,averageOrderValue:0,lastOrderDate:null};const a=r.reduce((s,n)=>s+(n.total||0),0);return{totalOrders:r.length,totalSpent:a,averageOrderValue:a/r.length,lastOrderDate:r[0].createdAt}}catch(r){return console.error("❌ Error getting order stats:",r),{totalOrders:0,totalSpent:0,averageOrderValue:0,lastOrderDate:null}}}}let lr=null;function ws(){return lr||(lr=new Nl),lr}class jl{constructor(){this.geminiService=Ve(),this.orderService=ws()}async getRecommendationsBasedOnOrderHistory(e,r,a={}){try{const{maxRecommendations:s=6,includeAnalysis:n=!0,excludeRecentPurchases:o=!0}=a;if(console.log("🛍️ Getting AI recommendations based on order history for user:",e),!r)throw new Error("Gemini API key is required for AI recommendations");this.geminiService.setApiKey(r);const l=await this.orderService.getUserOrderHistory(e,20);if(l.length===0)return console.log("No order history found, returning general recommendations"),this.getNewUserRecommendations(s);const c=this.orderService.prepareOrderDataForAI(l);let d=[];try{d=(await Q.getProducts({limit:100})).products}catch{const{getAllProducts:f}=await ye(async()=>{const{getAllProducts:E}=await Promise.resolve().then(()=>He);return{getAllProducts:E}},void 0);d=f()}let u=d;if(o){const k=this.extractRecentProductIds(l,30);u=d.filter(f=>!k.includes(f.id))}const h=this.buildOrderBasedPrompt(c,l,u,s);console.log("🤖 Sending order history to Gemini for analysis...");const g=await this.geminiService.generateContent(h,{temperature:.7,maxOutputTokens:800});console.log("✅ Gemini response received:",g.text);const x=this.parseAIRecommendations(g.text,u);return{success:!0,recommendations:x,analysis:n?c:null,method:"ai-order-history",confidence:x.length>=s*.8?"high":"medium"}}catch(s){return console.error("❌ Error getting order-based recommendations:",s),this.getFallbackOrderRecommendations(e,maxRecommendations)}}buildOrderBasedPrompt(e,r,a,s){const n=r.slice(0,5);return`Sen akıllı bir e-ticaret öneri uzmanısın. Kullanıcının sipariş geçmişini analiz ederek ${s} ürün öner.

MÜŞTERİ ANALİZİ:
- Toplam Sipariş: ${e.totalOrders} adet
- Toplam Harcama: ₺${e.totalSpent.toFixed(2)}
- Ortalama Sipariş Değeri: ₺${e.averageOrderValue.toFixed(2)}
- Sipariş Sıklığı: ${e.orderFrequency}
- Favori Kategoriler: ${e.favoriteCategories.join(", ")}
- Son Sipariş: ${e.lastOrderDate.toLocaleDateString("tr-TR")}

FİYAT TERCİHLERİ:
- Budget (0-1000₺): ${e.priceRanges.budget} ürün
- Orta Segment (1000-5000₺): ${e.priceRanges.mid} ürün  
- Premium (5000₺+): ${e.priceRanges.premium} ürün

SON SİPARİŞLER:
${n.map(o=>`
📦 Sipariş: ${o.orderId} - ₺${o.total} (${new Date(o.createdAt).toLocaleDateString("tr-TR")})
Ürünler: ${o.items.map(l=>`${l.productName} x${l.quantity}`).join(", ")}
`).join("")}

MEVCUT ÜRÜNLER:
${a.slice(0,50).map(o=>`
- ID: ${o.id}
- İsim: ${o.name}
- Kategori: ${o.category}
- Fiyat: ₺${o.price}
- Puan: ${o.rating}/5
- Stok: ${o.stock}
`).join("")}

ÖNERME STRATEJİSİ:
1. 🎯 MÜŞTERİ PROFİLİ: Satın alma geçmişine göre tercihlerini belirle
2. 💰 FİYAT UYUMU: En çok satın aldığı fiyat aralığından seç
3. 📦 KATEGORİ ÇEŞİTLİLİĞİ: Favori kategorilerden + yeni kategoriler keşfet
4. ⭐ KALİTE ODAKLI: Yüksek puanlı ürünleri tercih et
5. 🔄 YENİLİK FAKTÖRÜ: Daha önce almadığı ama sevebileceği ürünler
6. 🛍️ TAMAMLAYICI: Son siparişlerle uyumlu ürünler

MÜŞTERİ PSİKOLOJİSİ:
- Eğer sık sipariş veriyor → Memnun, yeni kategoriler öner
- Eğer premium alıyor → Kaliteli, yeni çıkan ürünler öner  
- Eğer budget alıyor → Uygun fiyatlı, değerli ürünler öner
- Eğer düzenli alışveriş yapıyor → Seasonal/trend ürünler öner

YANIT FORMATI:
Sadece önerilen ürün ID'lerini (sayısal) JSON array olarak ver:
[1, 2, 3, 4, 5, 6]

ÖNEMLİ: Sadece yukarıdaki ürün listesinden ID'ler seç!
Başka açıklama ekleme, sadece JSON array döndür.`}parseAIRecommendations(e,r){try{console.log("🔍 Parsing AI recommendations:",e);const a=e.trim().replace(/```json|```/g,""),n=JSON.parse(a).map(o=>r.find(l=>l.id===o)).filter(Boolean).slice(0,6);return console.log("✅ Parsed recommendations:",n.map(o=>o.name)),n}catch(a){return console.error("❌ Error parsing AI recommendations:",a),r.slice(0,6)}}async getNewUserRecommendations(e){try{let r=[];try{r=(await Q.getProducts({limit:50})).products}catch{const{getAllProducts:n}=await ye(async()=>{const{getAllProducts:o}=await Promise.resolve().then(()=>He);return{getAllProducts:o}},void 0);r=n().slice(0,50)}return{success:!0,recommendations:r.sort((s,n)=>(n.rating||0)-(s.rating||0)).slice(0,e),analysis:{message:"Yeni kullanıcı - en popüler ürünler öneriliyor",totalOrders:0,isNewUser:!0},method:"new-user-popular",confidence:"medium"}}catch(r){return console.error("❌ Error getting new user recommendations:",r),{success:!1,recommendations:[],method:"error",confidence:"low"}}}async getFallbackOrderRecommendations(e,r){try{console.log("🔧 Using fallback algorithm for order-based recommendations");const a=await this.orderService.getUserOrderHistory(e,10);if(a.length===0)return this.getNewUserRecommendations(r);let s=[];try{s=(await Q.getProducts({limit:100})).products}catch{const{getAllProducts:d}=await ye(async()=>{const{getAllProducts:u}=await Promise.resolve().then(()=>He);return{getAllProducts:u}},void 0);s=d()}const n=this.extractCategoryPreferences(a),o=this.extractRecentProductIds(a,60);return{success:!0,recommendations:s.filter(c=>!o.includes(c.id)).map(c=>{let d=0;const u=c.category||"Genel";return n[u]&&(d+=n[u]*10),d+=(c.rating||0)*5,c.stock>0&&(d+=10),{...c,score:d}}).sort((c,d)=>d.score-c.score).slice(0,r),method:"fallback-algorithm",confidence:"medium"}}catch(a){return console.error("❌ Fallback algorithm failed:",a),this.getNewUserRecommendations(r)}}extractRecentProductIds(e,r=30){const a=new Date;a.setDate(a.getDate()-r);const s=[];return e.forEach(n=>{var l;new Date(n.createdAt)>a&&((l=n.items)==null||l.forEach(c=>{c.productId&&s.push(c.productId)}))}),[...new Set(s)]}extractCategoryPreferences(e){const r={};return e.forEach(a=>{var s;(s=a.items)==null||s.forEach(n=>{const o=this.orderService.extractCategoryFromProduct(n);r[o]=(r[o]||0)+n.quantity})}),r}async getUserInsights(e,r){try{if(!r)return{error:"API key required"};this.geminiService.setApiKey(r);const a=await this.orderService.getUserOrderHistory(e,20);if(a.length===0)return{insights:["Henüz sipariş geçmişi bulunmuyor"],recommendations:["İlk alışverişinizi yapmak için ürünleri keşfedin"],type:"new-user"};const s=this.orderService.prepareOrderDataForAI(a),n=`Kullanıcının alışveriş geçmişini analiz et ve kişisel öngörüler ver:

MÜŞTERİ VERİLERİ:
- ${s.totalOrders} sipariş, ₺${s.totalSpent.toFixed(2)} toplam harcama
- Ortalama: ₺${s.averageOrderValue.toFixed(2)} per sipariş
- Favori kategoriler: ${s.favoriteCategories.join(", ")}
- Sipariş sıklığı: ${s.orderFrequency}

GÖREV: Bu kullanıcı için 3-4 kişisel insight ve 3-4 öneri ver.

Örnek format:
{
  "insights": [
    "Teknoloji ürünlerine yoğun ilgi gösteriyorsunuz",
    "Premium kalite tercih ediyorsunuz",
    "Düzenli alışveriş yapan sadık müşterimizsiniz"
  ],
  "suggestions": [
    "Yeni çıkan teknoloji ürünlerini takip edin",
    "Premium kategorisindeki indirimlerden faydalanın",
    "Sadık müşteri avantajlarından yararlanın"
  ]
}

Sadece JSON döndür, başka açıklama ekleme.`,o=await this.geminiService.generateContent(n,{temperature:.8,maxOutputTokens:400});return{...JSON.parse(o.text.trim().replace(/```json|```/g,"")),type:"experienced-user",stats:s}}catch(a){return console.error("❌ Error generating user insights:",a),{insights:["Alışveriş geçmişiniz analiz edildi"],suggestions:["Size özel öneriler hazırlanıyor"],type:"error"}}}}let cr=null;function Sl(){return cr||(cr=new jl),cr}const Cl=()=>{var v,w;const{state:i,dispatch:e,actionTypes:r}=ae(),[a,s]=p.useState(null),[n,o]=p.useState(!0),[l,c]=p.useState(!1),[d,u]=p.useState(!1),[h,g]=p.useState(null),[x,k]=p.useState(!1);p.useEffect(()=>{var y,P;(P=(y=i.user)==null?void 0:y.profile)!=null&&P.id?Ae.setUserId(i.user.profile.id):Ae.setUserId(null),x||f()},[i.cart,(w=(v=i.user)==null?void 0:v.profile)==null?void 0:w.id,x]);const f=async()=>{try{const y=await Ae.getCartSummary();s(y)}catch{e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Sepet yüklenirken hata oluştu",duration:5e3}})}finally{o(!1)}},E=async(y,P)=>{try{const N=await Ae.updateItemQuantity(y,P);e({type:r.SET_CART,payload:N})}catch(N){e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:N.message,duration:5e3}})}},j=async y=>{try{const P=await Ae.removeItem(y);e({type:r.SET_CART,payload:P}),e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:"Ürün sepetten kaldırıldı",duration:3e3}})}catch{e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Ürün kaldırılırken hata oluştu",duration:5e3}})}},T=async y=>{try{const P=await Ae.saveForLater(y);e({type:r.SET_CART,payload:P}),e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:"Ürün daha sonra için kaydedildi",duration:3e3}})}catch{e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:"Ürün kaydedilirken hata oluştu",duration:5e3}})}},D=async()=>{if(!a||a.items.length===0){e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"warning",message:"Sepetiniz boş, ödeme yapılamaz",duration:3e3}});return}c(!0);try{console.log("🚀 Starting automatic checkout...");const P=await ws().processAutomaticCheckout(a,i.user);if(P.success)g(P.order),u(!0),console.log("🗑️ Clearing cart after successful payment..."),console.log("📊 Current cart before clearing:",a),await Ae.clearCart(),e({type:r.CLEAR_CART}),console.log("✅ CartService and Redux cleared"),s({items:[],itemCount:0,isEmpty:!0,totals:{subtotal:0,tax:0,shipping:0,discount:0,total:0},coupon:null,qualifiesForFreeShipping:!1,freeShippingThreshold:500}),k(!0),console.log("✅ Cart cleared successfully"),e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:`🎉 Siparişiniz başarıyla alındı! Sipariş No: ${P.order.orderId}`,duration:8e3}}),console.log("✅ Automatic checkout completed successfully"),setTimeout(()=>{I(P.order)},3e3);else throw new Error(P.message||"Ödeme işlemi başarısız")}catch(y){console.error("❌ Automatic checkout failed:",y),e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:y.message||"Ödeme işlemi sırasında hata oluştu",duration:5e3}})}finally{c(!1)}},I=async y=>{var P,N,S,b;try{if(!i.settings.geminiApiKey){console.log("No Gemini API key, skipping post-order recommendations");return}console.log("🤖 Getting post-order AI recommendations...");const A=Sl(),C=((N=(P=i.user)==null?void 0:P.profile)==null?void 0:N.id)||((S=i.user)==null?void 0:S.id)||((b=i.user)==null?void 0:b.uid);if(!C){console.log("No user ID, skipping recommendations");return}const _=await A.getRecommendationsBasedOnOrderHistory(C,i.settings.geminiApiKey,{maxRecommendations:4,excludeRecentPurchases:!1});_.success&&_.recommendations.length>0&&(console.log("✅ Post-order recommendations ready:",_.recommendations.length),e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"info",message:"🛍️ Sipariş geçmişinize göre yeni öneriler hazırlandı! Öneriler sayfasını ziyaret edin.",duration:6e3}}))}catch(A){console.error("❌ Error getting post-order recommendations:",A)}};return n?t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs("div",{className:"animate-pulse space-y-4",children:[t.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4"}),t.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((y,P)=>t.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 h-32 rounded-2xl"},P))})]})}):!a||a.isEmpty?t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs(m.div,{className:"text-center py-16",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[t.jsx(m.div,{className:"mx-auto flex items-center justify-center h-24 w-24 rounded-full bg-gray-100 dark:bg-gray-800 mb-8",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:t.jsx(at,{className:"h-12 w-12 text-gray-400"})}),t.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"Sepetiniz boş"}),t.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-8",children:"ShopSmart'taki harika ürünleri keşfetmeye başlayın"}),t.jsxs(ie,{to:"/products",className:"inline-flex items-center space-x-2 bg-primary-600 hover:bg-primary-700 text-white px-8 py-4 rounded-2xl font-semibold transition-colors text-lg",children:[t.jsx("span",{children:"Alışverişe Başla"}),t.jsx(Nt,{className:"w-5 h-5"})]})]})}):t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-8",children:[t.jsx(at,{className:"w-8 h-8 text-primary-600"}),t.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["Sepetim (",a.itemCount," ürün)"]})]}),t.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[t.jsx("div",{className:"lg:col-span-2 space-y-4",children:t.jsx(oe,{children:a.items.map(y=>t.jsx(m.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6",children:t.jsxs("div",{className:"flex items-start space-x-4",children:[t.jsx(ie,{to:`/product/${y.slug}`,className:"flex-shrink-0",children:t.jsx("img",{src:y.image,alt:y.name,className:"w-24 h-24 object-cover rounded-xl"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx(ie,{to:`/product/${y.slug}`,className:"text-lg font-semibold text-gray-900 dark:text-white hover:text-primary-600 transition-colors",children:y.name}),Object.keys(y.selectedVariants).length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Object.entries(y.selectedVariants).map(([P,N])=>t.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-sm px-2 py-1 rounded",children:N},P))}),!y.isAvailable&&t.jsx("p",{className:"text-red-500 text-sm mt-2",children:"Bu ürün artık mevcut değil"}),t.jsxs("div",{className:"flex items-center justify-between mt-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("span",{className:"text-xl font-bold text-primary-600",children:[K.CURRENCY_SYMBOL,y.price.toLocaleString("tr-TR")]}),y.originalPrice>y.price&&t.jsxs("span",{className:"text-sm text-gray-500 line-through",children:[K.CURRENCY_SYMBOL,y.originalPrice.toLocaleString("tr-TR")]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>E(y.key,y.quantity-1),disabled:y.quantity<=1,className:"p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:t.jsx(Ta,{className:"w-4 h-4"})}),t.jsx("span",{className:"w-12 text-center font-medium",children:y.quantity}),t.jsx("button",{onClick:()=>E(y.key,y.quantity+1),disabled:!y.isAvailable||y.quantity>=y.stockAvailable,className:"p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:t.jsx(Ia,{className:"w-4 h-4"})})]})]}),t.jsxs("div",{className:"flex items-center space-x-4 mt-4",children:[t.jsxs("button",{onClick:()=>T(y.key),className:"flex items-center space-x-1 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-600 transition-colors",children:[t.jsx(ge,{className:"w-4 h-4"}),t.jsx("span",{children:"Daha sonra için kaydet"})]}),t.jsxs("button",{onClick:()=>j(y.key),className:"flex items-center space-x-1 text-sm text-red-600 hover:text-red-700 transition-colors",children:[t.jsx(Ys,{className:"w-4 h-4"}),t.jsx("span",{children:"Kaldır"})]})]})]})]})},y.key))})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 sticky top-4",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6",children:"Sipariş Özeti"}),t.jsxs("div",{className:"space-y-3 pb-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Ara Toplam"}),t.jsxs("span",{className:"font-medium",children:[K.CURRENCY_SYMBOL,a.totals.subtotal.toLocaleString("tr-TR")]})]}),a.totals.discount>0&&t.jsxs("div",{className:"flex justify-between text-green-600",children:[t.jsx("span",{children:"İndirim"}),t.jsxs("span",{children:["-",K.CURRENCY_SYMBOL,a.totals.discount.toLocaleString("tr-TR")]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Kargo"}),t.jsx("span",{className:"font-medium",children:a.totals.shipping===0?t.jsx("span",{className:"text-green-600",children:"Ücretsiz"}):`${K.CURRENCY_SYMBOL}${a.totals.shipping.toLocaleString("tr-TR")}`})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"KDV"}),t.jsxs("span",{className:"font-medium",children:[K.CURRENCY_SYMBOL,a.totals.tax.toLocaleString("tr-TR")]})]})]}),t.jsxs("div",{className:"flex justify-between items-center py-4 text-xl font-bold",children:[t.jsx("span",{className:"text-gray-900 dark:text-white",children:"Toplam"}),t.jsxs("span",{className:"text-primary-600",children:[K.CURRENCY_SYMBOL,a.totals.total.toLocaleString("tr-TR")]})]}),!a.qualifiesForFreeShipping&&t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Ücretsiz kargo için"}),t.jsxs("span",{className:"font-medium",children:[K.CURRENCY_SYMBOL,(a.freeShippingThreshold-a.totals.subtotal).toLocaleString("tr-TR")," kaldı"]})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-500",style:{width:`${Math.min(a.totals.subtotal/a.freeShippingThreshold*100,100)}%`}})})]}),t.jsx(m.button,{onClick:D,disabled:l||a.items.length===0,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 disabled:from-gray-400 disabled:to-gray-500 text-white py-4 px-6 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center space-x-3 text-lg shadow-lg hover:shadow-xl",whileHover:{scale:l?1:1.02},whileTap:{scale:l?1:.98},children:l?t.jsxs(t.Fragment,{children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:t.jsx(qe,{className:"w-5 h-5"})}),t.jsx("span",{children:"Ödeme İşleniyor..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(Pa,{className:"w-5 h-5"}),t.jsx("span",{children:"Otomatik Öde"}),t.jsxs("span",{className:"bg-white/20 px-2 py-1 rounded text-sm",children:["₺",a.totals.total.toFixed(2)]})]})}),t.jsx(ie,{to:"/products",className:"block text-center text-primary-600 hover:text-primary-700 font-medium mt-4 transition-colors",children:"Alışverişe devam et"})]})})]}),t.jsx(oe,{children:d&&h&&t.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t.jsxs(m.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},className:"bg-white dark:bg-gray-800 rounded-3xl p-8 max-w-md w-full text-center shadow-2xl relative",children:[t.jsx("button",{onClick:()=>{u(!1),k(!1),s({items:[],itemCount:0,isEmpty:!0,totals:{subtotal:0,tax:0,shipping:0,discount:0,total:0},coupon:null,qualifiesForFreeShipping:!1,freeShippingThreshold:500}),console.log("✅ Empty cart set via X button")},className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:t.jsx(Ar,{className:"w-5 h-5"})}),t.jsx(m.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mx-auto w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center mb-6 shadow-lg",children:t.jsx(dt,{className:"w-10 h-10 text-white"})}),t.jsx(m.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"🎉 Sipariş Başarılı!"}),t.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"space-y-3 mb-6",children:[t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Siparişiniz başarıyla alındı ve işleme konuldu."}),t.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-2xl p-4 border border-green-200/50 dark:border-green-800/50",children:t.jsxs("div",{className:"text-sm space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Sipariş No:"}),t.jsx("span",{className:"font-mono font-semibold text-green-600 dark:text-green-400",children:h.orderId})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Toplam:"}),t.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:["₺",h.total.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Durum:"}),t.jsx("span",{className:"text-green-600 dark:text-green-400 font-semibold",children:"✅ Onaylandı"})]})]})}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"📧 Sipariş detayları e-posta adresinize gönderildi."})]}),t.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"space-y-3",children:[t.jsxs(ie,{to:"/recommendations",className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-3 px-6 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center space-x-2",onClick:()=>{u(!1),s({items:[],itemCount:0,isEmpty:!0,totals:{subtotal:0,tax:0,shipping:0,discount:0,total:0},coupon:null,qualifiesForFreeShipping:!1,freeShippingThreshold:500}),k(!1),console.log("✅ Empty cart set via AI button")},children:[t.jsx(ge,{className:"w-4 h-4"}),t.jsx("span",{children:"AI Önerilerini Gör"})]}),t.jsx("button",{onClick:()=>{u(!1),s({items:[],itemCount:0,isEmpty:!0,totals:{subtotal:0,tax:0,shipping:0,discount:0,total:0},coupon:null,qualifiesForFreeShipping:!1,freeShippingThreshold:500}),k(!1),console.log("✅ Empty cart set via continue shopping button")},className:"w-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 py-3 px-6 rounded-xl font-medium transition-colors",children:"Alışverişe Devam Et"})]})]})})})]})},ba={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},Be={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}},Al=()=>{const{state:i}=ae(),{settings:e}=i,[r,a]=p.useState(!1),[s,n]=p.useState(null),[o,l]=p.useState(!1),[c,d]=p.useState(null),[u,h]=p.useState([]),[g,x]=p.useState([]),[k,f]=p.useState(!1),[E,j]=p.useState(null),T=p.useCallback(b=>{b.preventDefault(),a(!0)},[]),D=p.useCallback(b=>{b.preventDefault(),a(!1)},[]),I=p.useCallback(async b=>{b.preventDefault(),a(!1);const C=Array.from(b.dataTransfer.files).find(_=>_.type.startsWith("image/"));C&&await w(C)},[]),v=p.useCallback(async b=>{const A=b.target.files[0];A&&A.type.startsWith("image/")&&await w(A)},[]),w=async b=>{const A=new FileReader;A.onload=C=>{n({file:b,preview:C.target.result,name:b.name,size:b.size})},A.readAsDataURL(b),e.geminiApiKey&&await y(b)},y=async b=>{l(!0);try{const A=ht(e.geminiApiKey,e.selectedModel),C=await new Promise(W=>{const ee=new FileReader;ee.onload=()=>{const G=ee.result.split(",")[1];W(G)},ee.readAsDataURL(b)}),R=(await A.generateContentWithImage(`Analyze this image and describe the product(s) you see. Focus on:
      1. Product type/category 
      2. Key visual features (color, style, design)
      3. Material or texture if visible
      4. Brand or distinctive characteristics
      5. Suggested search keywords for e-commerce

      Provide a detailed but concise analysis that would help find similar products.`,C,{mimeType:b.type})).text;d(R),await P(R);const O=S(R),$=$t(O.join(" "));h($)}catch(A){console.error("Error analyzing image:",A),d("Görsel analizi sırasında bir hata oluştu. Lütfen tekrar deneyin.")}finally{l(!1)}},P=async b=>{if(b){f(!0);try{console.log("🔍 Starting visual search matching...");const C=await Fr().getMatchingProducts(b,e.geminiApiKey,{maxRecommendations:6,includeComplementary:!0});console.log("🎯 Visual search matching completed:",{method:C.matchingMethod,confidence:C.confidence,products:C.products.length}),x(C.products||[]),j(C.matchingMethod)}catch(A){console.error("Error getting matching products:",A),x([]),j("error")}finally{f(!1)}}},N=async()=>{const b="Bu görselde bej renkli, casual bir gömlek görüyorum. Modern tasarımı ve rahat kesimiyle günlük kullanım için ideal.";d(b),await P(b);const A=S(b),C=$t(A.join(" "));h(C)},S=b=>{const A=["the","a","an","and","or","but","in","on","at","to","for","of","with","by","is","are","was","were","this","that","these","those"];return b.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(_=>_.length>3&&!A.includes(_)).slice(0,5)};return e.geminiApiKey?t.jsxs(m.div,{className:"max-w-6xl mx-auto",variants:ba,initial:"hidden",animate:"visible",children:[t.jsxs(m.div,{className:"text-center py-12 mb-8",variants:Be,children:[t.jsxs(m.div,{className:"mx-auto flex items-center justify-center h-20 w-20 rounded-3xl bg-gradient-to-br from-purple-500 to-pink-500 mb-8 shadow-xl relative",whileHover:{scale:1.05,rotate:5},transition:{duration:.3},children:[t.jsx(Je,{className:"h-10 w-10 text-white"}),t.jsx(m.div,{className:"absolute -top-1 -right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:t.jsx(xe,{className:"w-3 h-3 text-white"})})]}),t.jsx(m.h1,{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",variants:Be,children:"AI Görsel Arama"}),t.jsx(m.p,{className:"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-3xl mx-auto leading-relaxed",variants:Be,children:"ShopSmart - Akıllı Alışverişin Yeni Adresi'nde fotoğraf yükleyerek benzer ürünleri keşfedin. AI destekli görsel analiz ile istediğiniz ürünü hızlıca bulun."})]}),t.jsx(m.div,{className:"mb-12",variants:Be,children:t.jsx(m.div,{className:`relative border-2 border-dashed rounded-3xl p-12 transition-all duration-300 ${r?"border-purple-500 bg-purple-50/50 dark:bg-purple-900/20 scale-105":"border-gray-300 dark:border-gray-600 bg-white/50 dark:bg-gray-800/50 hover:border-purple-400 dark:hover:border-purple-500"} backdrop-blur-sm`,onDragOver:T,onDragLeave:D,onDrop:I,whileHover:{scale:1.01},animate:{scale:r?1.02:1,borderColor:r?"#a855f7":void 0},children:t.jsxs("div",{className:"relative z-10 text-center",children:[t.jsx(m.div,{className:"mx-auto w-16 h-16 mb-6",animate:{y:r?-10:0,rotate:r?5:0},transition:{duration:.3},children:t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center",children:t.jsx(Ws,{className:"w-8 h-8 text-white"})})}),t.jsx(m.h3,{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",animate:{color:r?"#a855f7":void 0},children:r?"Fotoğrafı Bırakın!":"Fotoğraf Yükle"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"JPG, PNG, WEBP formatlarında ürün fotoğrafları desteklenir"}),t.jsxs(m.label,{className:"inline-block px-8 py-3 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-semibold rounded-2xl transition-all duration-300 shadow-lg hover:shadow-xl cursor-pointer",whileHover:{scale:1.02},whileTap:{scale:.98},children:["Fotoğraf Seç",t.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"hidden"})]})]})})}),t.jsx(oe,{children:s&&t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-12",children:t.jsxs("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-3xl p-8 border border-gray-200/50 dark:border-gray-700/50 shadow-lg",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[t.jsx(m.div,{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(vt,{className:"w-4 h-4 text-white"})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Görsel Analizi"})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("img",{src:s.preview,alt:"Uploaded",className:"w-full h-64 object-cover rounded-2xl shadow-lg"}),t.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("p",{className:"font-medium",children:s.name}),t.jsxs("p",{children:[(s.size/1024/1024).toFixed(2)," MB"]})]})]}),t.jsx("div",{className:"space-y-4",children:o?t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:t.jsx(qe,{className:"w-6 h-6 text-purple-500"})}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"AI analizi yapılıyor..."})]}):c?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(dt,{className:"w-5 h-5 text-green-500"}),t.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Analiz Tamamlandı"})]}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-2xl p-4",children:t.jsx("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:c})}),c&&g.length===0&&!k&&t.jsxs(m.button,{onClick:()=>P(c),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl mt-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(tt,{className:"w-4 h-4"}),t.jsx("span",{children:"Uyumlu Ürünleri Bul"})]})]}):null})]})]})})}),t.jsx(oe,{children:g.length>0&&t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-12",children:t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 via-purple-50 to-blue-50 dark:from-blue-900/20 dark:via-purple-900/10 dark:to-blue-900/20 rounded-3xl p-8 border border-blue-200/50 dark:border-blue-800/50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(m.div,{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(tt,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Uyumlu Ürün Önerileri (",g.length,")"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:E==="ai"?"🤖 AI destekli akıllı eşleştirme":E==="algorithm"?"🔧 Akıllı algoritma ile eşleştirme":"📊 Popüler ürünler"})]})]}),k&&t.jsx(m.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:t.jsx(qe,{className:"w-6 h-6 text-purple-500"})})]}),k?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"mx-auto w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center mb-4",children:t.jsx(ge,{className:"w-6 h-6 text-white"})}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Görselinize uygun ürünler bulunuyor..."})]}):t.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((b,A)=>t.jsx(m.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},transition:{delay:A*.1,duration:.3},children:t.jsx(Xe,{product:b})},b.id))})]})})}),t.jsx(oe,{children:u.length>0&&t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-12",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[t.jsx(m.div,{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-blue-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(Gt,{className:"w-4 h-4 text-white"})}),t.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Benzer Ürünler (",u.length,")"]})]}),t.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map((b,A)=>t.jsx(m.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},transition:{delay:A*.1,duration:.3},children:t.jsx(Xe,{product:b})},b.id))})]})}),t.jsx(m.div,{className:"text-center",variants:Be,children:t.jsxs(m.div,{className:"inline-flex items-center space-x-3 px-8 py-4 bg-gradient-to-r from-purple-50 via-pink-50/50 to-purple-50 dark:from-purple-900/20 dark:via-pink-900/10 dark:to-purple-900/20 rounded-3xl border border-purple-200/50 dark:border-purple-800/50 backdrop-blur-sm",whileHover:{scale:1.02,y:-2},transition:{duration:.2},children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},children:t.jsx(xe,{className:"w-6 h-6 text-purple-500"})}),t.jsx("span",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:"AI destekli görsel arama aktif!"}),t.jsx(m.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:t.jsx(Je,{className:"w-6 h-6 text-pink-500"})})]})})]}):t.jsx(m.div,{className:"max-w-4xl mx-auto",variants:ba,initial:"hidden",animate:"visible",children:t.jsxs(m.div,{className:"text-center py-12",variants:Be,children:[t.jsx(m.div,{className:"mx-auto flex items-center justify-center h-20 w-20 rounded-3xl bg-gradient-to-br from-purple-500 to-pink-500 mb-8 shadow-xl",whileHover:{scale:1.05,rotate:5},transition:{duration:.3},children:t.jsx(Je,{className:"h-10 w-10 text-white"})}),t.jsx(m.h1,{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",variants:Be,children:"AI Görsel Arama"}),t.jsx(m.p,{className:"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-2xl mx-auto leading-relaxed",variants:Be,children:"Fotoğraf yükleyerek benzer ürünleri bulmak için önce API anahtarınızı yapılandırmanız gerekiyor."}),t.jsx(m.div,{variants:Be,whileHover:{scale:1.02},whileTap:{scale:.98},children:t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsx("div",{className:"inline-flex items-center px-8 py-4 bg-gray-400 text-white font-semibold rounded-2xl opacity-50 cursor-not-allowed",children:"API Yapılandırma Devre Dışı"}),t.jsxs(m.button,{onClick:N,className:"inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold rounded-2xl transition-all duration-300 shadow-lg hover:shadow-xl",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(vt,{className:"w-5 h-5 mr-3"}),"Demo: Bej Gömlek Analizi"]})]})})]})})};class El{constructor(e=null){e?this.geminiService=ht(e):this.geminiService=Ve()}updateApiKey(e){e&&(this.geminiService=ht(e))}async generateProductRecommendations(e,r={}){console.log("🔍 Starting recommendation generation for user:",e,"with options:",r);try{const{maxRecommendations:a=10,includeUserHistory:s=!0,includeBehaviorAnalysis:n=!0,useCache:o=!0}=r;console.log("🔄 Generating fresh recommendations (cache disabled)...");let l=null,c=[],d=[],u=[];try{l=await U.getUser(e)}catch(f){console.warn("Could not fetch user data:",f)}try{c=s?await U.getUserBehavior(e,50):[]}catch(f){console.warn("Could not fetch user behavior:",f)}try{d=await U.getCartItems(e)}catch(f){console.warn("Could not fetch cart items:",f)}try{u=await U.getSearchHistory(e,20)}catch(f){console.warn("Could not fetch search history:",f)}let h=[];try{h=await U.getProducts({limit:100})}catch{console.warn("Could not fetch products from Firebase, using local data");const{getAllProducts:E}=await ye(async()=>{const{getAllProducts:j}=await Promise.resolve().then(()=>He);return{getAllProducts:j}},void 0);h=E().slice(0,100)}const g={user:l?{id:l.id,preferences:l.preferences||{},demographics:{age:l.age,location:l.location,gender:l.gender}}:null,recentBehavior:c.slice(0,10).map(f=>({action:f.action,productId:f.productId,category:f.category,timestamp:f.timestamp})),cartItems:d.map(f=>({productId:f.productId,quantity:f.quantity})),searchHistory:u.slice(0,10).map(f=>({query:f.query,timestamp:f.timestamp})),availableProducts:h.map(f=>({id:f.id,name:f.name,category:f.category,price:f.price,rating:f.rating,tags:f.tags||[]}))},x=this.buildRecommendationPrompt(g,a);console.log("🤖 Calling Gemini API for recommendations...");let k=[];try{const f=await this.geminiService.generateContent(x,{temperature:.7,maxOutputTokens:1e3});console.log("✅ Gemini API response received"),console.log("🔍 Raw Gemini response:",f.text),k=this.parseRecommendationsResponse(f.text,h),console.log("✅ Parsed recommendations:",k.length)}catch(f){console.warn("⚠️ Gemini API failed, using fallback directly:",f.message),k=this.generateFallbackRecommendations(h,g,a)}return await U.saveRecommendations(e,k,"gemini"),await U.trackUserBehavior(e,{action:"recommendation_generated",count:k.length,source:"gemini"}),k}catch(a){console.error("❌ Error generating recommendations:",a);try{console.log("🔄 Using fallback recommendation system...");const s=this.generateFallbackRecommendations(products,promptData,maxRecommendations);return console.log("✅ Fallback recommendations generated:",s.length),s}catch(s){throw console.error("❌ Fallback recommendations also failed:",s),new Error(`Failed to generate recommendations: ${q(a)}`)}}}generateFallbackRecommendations(e,r,a){try{if(console.log("Generating fallback recommendations..."),!e||e.length===0)return[];const s=e.filter(n=>n&&n.id).sort((n,o)=>{const l=n.rating||0;return(o.rating||0)-l}).slice(0,a*2).sort(()=>Math.random()-.5).slice(0,a);return console.log(`Generated ${s.length} fallback recommendations`),s}catch(s){return console.error("Error in fallback recommendations:",s),[]}}async analyzeUserBehavior(e){try{const r=await U.getUserBehavior(e,100),a=await U.getUserOrders(e),s=await U.getUser(e);if(!r.length&&!a.length)return{insights:["New user - not enough data for analysis"],suggestions:["Explore our popular categories","Add items to your wishlist"],confidence:.1};const n={user:s,behaviorHistory:r.map(d=>({action:d.action,category:d.category,productId:d.productId,timestamp:d.timestamp})),orderHistory:a.map(d=>({items:d.items,total:d.total,category:d.category,timestamp:d.createdAt}))},o=`
Analyze this user's shopping behavior and provide insights:

User Data: ${JSON.stringify(n,null,2)}

Please provide:
1. Key behavioral patterns
2. Shopping preferences
3. Recommended categories
4. Best times to engage
5. Potential interests

Return response as JSON with this structure:
{
  "insights": ["insight1", "insight2"],
  "preferences": {
    "categories": ["category1", "category2"],
    "priceRange": "budget/mid/premium",
    "shoppingStyle": "impulsive/research-based/seasonal"
  },
  "suggestions": ["suggestion1", "suggestion2"],
  "engagement": {
    "bestTimes": ["morning", "evening"],
    "frequency": "weekly/monthly"
  },
  "confidence": 0.8
}
`,l=await this.geminiService.generateContent(o,{temperature:.3,maxOutputTokens:800}),c=this.parseJsonResponse(l.text);return await U.trackUserBehavior(e,{action:"behavior_analysis",insights:c.insights,confidence:c.confidence}),c}catch(r){throw console.error("Error analyzing user behavior:",r),new Error(`Failed to analyze user behavior: ${q(r)}`)}}async smartSearch(e,r,a={}){try{const{includePersonalization:s=!0,maxResults:n=20,categoryFilter:o=null}=a,l={};o&&(l.category=o);const c=await U.getProducts(l);let d={};if(s&&e){const k=await U.getUser(e),f=await U.getUserBehavior(e,10),E=await U.getSearchHistory(e,5);d={preferences:(k==null?void 0:k.preferences)||{},recentViews:f.filter(j=>j.action==="view_product"),searchHistory:E.map(j=>j.query)}}const u=`
You are a smart product search assistant. Given a search query and product catalog, find the most relevant products.

Search Query: "${r}"

User Context: ${JSON.stringify(d,null,2)}

Available Products: ${JSON.stringify(c.map(k=>({id:k.id,name:k.name,description:k.description,category:k.category,price:k.price,tags:k.tags||[],rating:k.rating})),null,2)}

Instructions:
1. Match products based on query relevance
2. Consider user preferences and history for personalization
3. Rank results by relevance score
4. Return maximum ${n} results

Return response as JSON array:
[
  {
    "productId": "id",
    "relevanceScore": 0.95,
    "matchReason": "why this product matches"
  }
]

Sort by relevanceScore (highest first).
`,h=await this.geminiService.generateContent(u,{temperature:.2,maxOutputTokens:1500}),x=this.parseJsonResponse(h.text).map(k=>{const f=c.find(E=>E.id===k.productId);return f?{...f,relevanceScore:k.relevanceScore,matchReason:k.matchReason}:null}).filter(Boolean).slice(0,n);return e&&(await U.saveSearchQuery(e,r,x),await U.trackUserBehavior(e,{action:"smart_search",query:r,resultsCount:x.length})),x}catch(s){throw console.error("Error in smart search:",s),new Error(`Smart search failed: ${q(s)}`)}}async generateProductDescription(e){try{const r=`
Create an engaging and informative product description for this product:

Product: ${JSON.stringify(e,null,2)}

Requirements:
- Highlight key features and benefits
- Use persuasive but honest language
- Include technical specifications if relevant
- Keep it concise but informative
- Make it SEO-friendly

Return only the description text, no additional formatting.
`;return(await this.geminiService.generateContent(r,{temperature:.6,maxOutputTokens:500})).text.trim()}catch(r){throw console.error("Error generating product description:",r),new Error(`Failed to generate description: ${q(r)}`)}}async generatePersonalizedContent(e,r="email"){try{const a=await U.getUser(e),s=await U.getUserBehavior(e,20),n=await U.getRecommendations(e),o=`
Generate personalized ${r} content for this user:

User: ${JSON.stringify(a,null,2)}
Recent Activity: ${JSON.stringify(s,null,2)}
Recommendations: ${JSON.stringify(n,null,2)}

Create engaging, personalized content that:
- Addresses the user by name
- References their interests/recent activity
- Includes relevant product recommendations
- Has a clear call-to-action
- Maintains professional tone

Return the content ready to use.
`;return(await this.geminiService.generateContent(o,{temperature:.7,maxOutputTokens:1e3})).text}catch(a){throw console.error("Error generating personalized content:",a),new Error(`Failed to generate content: ${q(a)}`)}}buildRecommendationPrompt(e,r){var l,c,d,u,h,g,x,k;const a=e.user?`
KULLANICI PROFİLİ:
- Yaş: ${((l=e.user.demographics)==null?void 0:l.age)||"Bilinmiyor"}
- Lokasyon: ${((c=e.user.demographics)==null?void 0:c.location)||"Bilinmiyor"}
- Favori kategoriler: ${((u=(d=e.user.preferences)==null?void 0:d.categories)==null?void 0:u.join(", "))||"Yok"}
- Fiyat aralığı tercihi: ${((h=e.user.preferences)==null?void 0:h.priceRange)||"Belirtilmemiş"}
`:"Kullanıcı profili: Anonim kullanıcı",s=((g=e.recentBehavior)==null?void 0:g.length)>0?`
SON DAVRANIŞLAR:
${e.recentBehavior.map(f=>`- ${f.action}: ${f.productId} (${f.category}) - ${f.timestamp}`).join(`
`)}
`:"Son davranış: Yok",n=((x=e.cartItems)==null?void 0:x.length)>0?`
SEPETTEKİ ÜRÜNLER:
${e.cartItems.map(f=>`- Ürün ID: ${f.productId} (Adet: ${f.quantity})`).join(`
`)}
`:"Sepet: Boş",o=((k=e.searchHistory)==null?void 0:k.length)>0?`
ARAMA GEÇMİŞİ:
${e.searchHistory.map(f=>`- "${f.query}" - ${f.timestamp}`).join(`
`)}
`:"Arama geçmişi: Yok";return`Sen akıllı bir e-ticaret ürün öneri sistemisin. Türkiye'deki kullanıcılar için en uygun ${r} ürün öner.

${a}

${s}

${n}

${o}

MEVCUT ÜRÜNLER:
${e.availableProducts.map(f=>{var E;return`
- ID: ${f.id}
- İsim: ${f.name}
- Kategori: ${f.category}
- Fiyat: ₺${f.price}
- Puan: ${f.rating}/5
- Etiketler: ${((E=f.tags)==null?void 0:E.join(", "))||"Yok"}
`}).join("")}

GÖREV:
1. Kullanıcının demografik bilgilerini dikkate al
2. Son davranışlarına göre ilgi alanlarını belirle
3. Sepetindeki ürünlerle uyumlu tamamlayıcı ürünler öner
4. Arama geçmişinden ilgi alanlarını çıkar
5. Farklı kategorilerden çeşitlilik sağla
6. Fiyat-performans dengesini koru
7. Yüksek puanlı ürünleri tercih et

TÜRKÇE DÜŞÜN:
- Kullanıcı hangi yaş grubunda?
- Hangi kategorilere ilgisi var?
- Bütçesi nasıl?
- Hangi markalar tercih edebilir?
- Sezonsal faktörler var mı?

YANIT FORMATI:
Sadece ürün ID'lerini JSON array olarak ver:
["id1", "id2", "id3", "id4", "id5", "id6"]

Başka açıklama ekleme, sadece JSON array döndür.`}parseRecommendationsResponse(e,r){try{const a=e.trim().replace(/```json|```/g,"");console.log("🔍 Cleaned response text:",a);const s=JSON.parse(a);console.log("🔍 Parsed product IDs:",s),console.log("🔍 Available product IDs:",r.map(o=>o.id).slice(0,10));const n=s.map(o=>{const l=r.find(c=>c.id===o||c.firebaseId===o||c.id===String(o)||c.firebaseId===String(o));return l||console.log(`⚠️ Product ID ${o} not found in products`),l}).filter(Boolean);return console.log("✅ Found products:",n.map(o=>o.name)),n}catch(a){return console.error("❌ Error parsing recommendations:",a),console.log("📄 Response text that failed to parse:",e),r.slice(0,5)}}parseJsonResponse(e){try{const r=e.trim().replace(/```json|```/g,"");return JSON.parse(r)}catch(r){throw console.error("Error parsing JSON response:",r),new Error("Invalid response format from AI service")}}async testIntegration(){try{const e=await U.checkConnection(),r=await this.geminiService.testConnection();return{firebase:e,gemini:r,integration:{success:e.success&&r.success,message:"Firebase + Gemini integration ready"}}}catch(e){return{success:!1,message:`Integration test failed: ${q(e)}`}}}}let Ot=null;function Tl(i=null){return Ot?i&&Ot.updateApiKey(i):Ot=new El(i),Ot}function Il(){const{state:i,dispatch:e,actionTypes:r}=ae(),[a,s]=p.useState(!1),[n,o]=p.useState(null),l=Tl(i.settings.geminiApiKey),c=p.useCallback(async(S,b)=>{try{return s(!0),o(null),await U.createUser(S,b)}catch(A){const C=q(A);throw o(C),new Error(C)}finally{s(!1)}},[]),d=p.useCallback(async S=>{try{return s(!0),o(null),await U.getUser(S)}catch(b){const A=q(b);throw o(A),new Error(A)}finally{s(!1)}},[]),u=p.useCallback(async(S,b)=>{try{return s(!0),o(null),await U.updateUser(S,b)}catch(A){const C=q(A);throw o(C),new Error(C)}finally{s(!1)}},[]),h=p.useCallback(async(S={})=>{try{s(!0),o(null);const b=await U.getProducts(S);return e({type:r.SET_PRODUCTS,payload:b}),b}catch(b){const A=q(b);throw o(A),new Error(A)}finally{s(!1)}},[e,r]),g=p.useCallback(async S=>{try{return s(!0),o(null),await U.getProduct(S)}catch(b){const A=q(b);throw o(A),new Error(A)}finally{s(!1)}},[]),x=p.useCallback(async(S,b,A={})=>{try{await U.trackUserBehavior(S,{action:b,...A,userAgent:navigator.userAgent,referrer:document.referrer})}catch(C){console.warn("Failed to track user behavior:",C)}},[]),k=p.useCallback(async S=>{try{return s(!0),o(null),await l.analyzeUserBehavior(S)}catch(b){const A=q(b);throw o(A),new Error(A)}finally{s(!1)}},[l]),f=p.useCallback(async(S,b={})=>{try{s(!0),o(null);const A=await l.generateProductRecommendations(S,b);return e({type:r.SET_RECOMMENDATIONS,payload:A}),A}catch(A){const C=q(A);throw o(C),new Error(C)}finally{s(!1)}},[l,e,r]),E=p.useCallback(async(S,b,A={})=>{try{s(!0),o(null);const C=await l.smartSearch(S,b,A);return await x(S,"search",{query:b,resultsCount:C.length}),C}catch(C){const _=q(C);throw o(_),new Error(_)}finally{s(!1)}},[l,x]),j=p.useCallback(async(S,b,A=1)=>{try{s(!0),o(null);const C=await U.addToCart(S,b,A);await x(S,"add_to_cart",{productId:b,quantity:A});const _=await U.getCartItems(S);return e({type:r.SET_CART_ITEMS,payload:_}),C}catch(C){const _=q(C);throw o(_),new Error(_)}finally{s(!1)}},[x,e,r]),T=p.useCallback(async S=>{try{s(!0),o(null);const b=await U.getCartItems(S);return e({type:r.SET_CART_ITEMS,payload:b}),b}catch(b){const A=q(b);throw o(A),new Error(A)}finally{s(!1)}},[e,r]),D=p.useCallback(async(S,b)=>{try{s(!0),o(null);const A=await U.removeFromCart(S,b);await x(S,"remove_from_cart",{productId:b});const C=await U.getCartItems(S);return e({type:r.SET_CART_ITEMS,payload:C}),A}catch(A){const C=q(A);throw o(C),new Error(C)}finally{s(!1)}},[x,e,r]),I=p.useCallback(async S=>{try{s(!0),o(null);const b=await U.createOrder(S);return await x(S.userId,"create_order",{orderId:b.id,total:S.total,itemCount:S.items.length}),b}catch(b){const A=q(b);throw o(A),new Error(A)}finally{s(!1)}},[x]),v=p.useCallback(async S=>{try{return s(!0),o(null),await U.getUserOrders(S)}catch(b){const A=q(b);throw o(A),new Error(A)}finally{s(!1)}},[]),w=p.useCallback((S,b)=>U.subscribeToUserCart(S,A=>{e({type:r.SET_CART_ITEMS,payload:A}),b(A)}),[e,r]),y=p.useCallback((S,b={})=>U.subscribeToProducts(A=>{e({type:r.SET_PRODUCTS,payload:A}),S(A)},b),[e,r]),P=p.useCallback(()=>{o(null)},[]),N=p.useCallback(async()=>{try{return s(!0),o(null),await l.testIntegration()}catch(S){const b=q(S);throw o(b),new Error(b)}finally{s(!1)}},[l]);return p.useEffect(()=>{const S=i.user;S&&x(S.id,"page_view",{page:window.location.pathname,timestamp:new Date().toISOString()})},[x,i.user]),{loading:a,error:n,createUser:c,getUser:d,updateUser:u,getProducts:h,getProduct:g,trackBehavior:x,getBehaviorAnalysis:k,getRecommendations:f,smartSearch:E,addToCart:j,getCartItems:T,removeFromCart:D,createOrder:I,getUserOrders:v,subscribeToCart:w,subscribeToProducts:y,clearError:P,testConnection:N}}function Rl(){const{state:i,dispatch:e,actionTypes:r}=ae(),[a,s]=p.useState(!1),[n,o]=p.useState(null),l=p.useRef(null),c=p.useCallback(()=>{const{settings:j}=i;if(!j.geminiApiKey)throw console.error("No Gemini API key found in settings:",j),new Error(Le.API_KEY_MISSING);return console.log("Initializing Gemini service with API key:",j.geminiApiKey.substring(0,10)+"..."),ht(j.geminiApiKey,j.selectedModel)},[i.settings]),d=p.useCallback(async(j,T={})=>{try{return s(!0),o(null),await c().generateContent(j,{...i.settings,...T})}catch(D){const I=q(D);throw o(I),new Error(I)}finally{s(!1)}},[i.settings,e,r,c]),u=p.useCallback(async(j,T,D,I={})=>{try{return s(!0),o(null),await c().generateContentWithImage(j,T,{...i.settings,mimeType:D,model:i.settings.selectedModel.includes("vision")?i.settings.selectedModel:"gemini-pro-vision",...I})}catch(v){const w=q(v);throw o(w),new Error(w)}finally{s(!1)}},[i.settings,e,r,c]),h=p.useCallback(async(j,T,D={})=>{try{s(!0),o(null);const I=c();l.current=new AbortController,await I.streamContent(j,T,{...i.settings,...D}),e({type:r.INCREMENT_REQUEST_COUNT,payload:{success:!0}})}catch(I){if(I.name==="AbortError")return;const v=q(I);throw o(v),new Error(v)}finally{s(!1),l.current=null}},[i.settings,e,r,c]),g=p.useCallback(async(j,T,D={})=>{try{s(!0),o(null);const I=Date.now(),v=i.conversations.find(C=>C.id===T);if(!v)throw new Error("Conversation not found");const w={id:Date.now().toString(),type:Pt.USER,content:j,timestamp:new Date().toISOString()};e({type:r.ADD_MESSAGE,payload:{conversationId:T,message:w}});const y=[...v.messages,w].map(C=>({role:C.type===Pt.USER?"user":"assistant",content:C.content})),N=await c().generateConversationResponse(y,{...i.settings,...D}),b=Date.now()-I,A={id:(Date.now()+1).toString(),type:Pt.ASSISTANT,content:N.text,timestamp:new Date().toISOString(),metadata:{finishReason:N.finishReason,safetyRatings:N.safetyRatings,responseTime:b}};return e({type:r.ADD_MESSAGE,payload:{conversationId:T,message:A}}),e({type:r.INCREMENT_REQUEST_COUNT,payload:{success:!0}}),e({type:r.ADD_RESPONSE_TIME,payload:b}),N.usageMetadata&&e({type:r.UPDATE_ANALYTICS,payload:{tokensUsed:i.analyticsData.tokensUsed+(N.usageMetadata.totalTokenCount||0)}}),A}catch(I){const v=q(I);o(v);const w={id:(Date.now()+2).toString(),type:Pt.ERROR,content:v,timestamp:new Date().toISOString()};throw e({type:r.ADD_MESSAGE,payload:{conversationId:T,message:w}}),new Error(v)}finally{s(!1)}},[i.conversations,i.settings,e,r,c]),x=p.useCallback(async(j,T=null)=>{try{return await c().countTokens(j,T||i.settings.selectedModel)}catch(D){const I=q(D);throw o(I),new Error(I)}},[i.settings,c]),k=p.useCallback(async()=>{try{return o(null),await c().testConnection()}catch(j){const T=q(j);return o(T),{success:!1,message:T,error:j}}},[c]),f=p.useCallback(()=>{l.current&&l.current.abort(),s(!1)},[]),E=p.useCallback(()=>{o(null)},[]);return{isGenerating:a,error:n,generateContent:d,generateContentWithImage:u,streamContent:h,sendMessage:g,countTokens:x,testConnection:k,abortGeneration:f,clearError:E}}class Pl{constructor(){this.geminiService=Ve()}async enhanceProduct(e,r){try{console.log("🧠 AI-enhancing product:",e.name),this.geminiService.setApiKey(r);const a=this.buildEnhancementPrompt(e),s=await this.geminiService.generateContent(a,{temperature:.7,maxOutputTokens:1500}),n=this.parseEnhancementResponse(s.text),o={...e,aiEnhanced:!0,aiAttributes:n,enhancedAt:new Date().toISOString(),semanticTags:n.semanticTags||[],emotionalTriggers:n.emotionalTriggers||[],useContexts:n.useContexts||[],styleAttributes:n.styleAttributes||{},targetPersonas:n.targetPersonas||[]};return console.log("✅ Product enhanced with AI attributes:",Object.keys(n)),o}catch(a){return console.error("❌ AI enhancement failed:",a),{...e,aiEnhanced:!1,enhancementError:a.message}}}buildEnhancementPrompt(e){return`Sen uzman bir ürün analisti ve pazarlama uzmanısın. Bu ürünü kapsamlı olarak analiz et ve zengin semantik özellikler çıkar.

ÜRÜN BİLGİLERİ:
- İsim: ${e.name}
- Kategori: ${e.category}
- Marka: ${e.brand||"Bilinmiyor"}
- Fiyat: ₺${e.price}
- Açıklama: ${e.description}
- Puan: ${e.rating}/5

GÖREV: Bu ürün için aşağıdaki kategorilerde detaylı analiz yap:

1. SEMANTİK ETIKETLER (semanticTags):
   - Ürünün temel özelliklerini tanımlayan 15-20 etiket
   - Örnek: ["premium", "minimalist", "çok_amaçlı", "dayanıklı", "şık"]

2. DUYGUSAL TETİKLEYİCİLER (emotionalTriggers):
   - Bu ürünün uyandırdığı duygular ve hisler
   - Örnek: ["güven", "prestij", "rahatlık", "özgürlük", "başarı_hissi"]

3. KULLANIM BAĞLAMLARI (useContexts):
   - Ürünün kullanılabileceği durumlar ve ortamlar
   - Örnek: ["iş_toplantısı", "günlük_hayat", "özel_davet", "spor", "seyahat"]

4. STİL ÖZELLİKLERİ (styleAttributes):
   - aesthetic: Modern/Klasik/Vintage/Minimalist
   - formality: Casual/Semi-formal/Formal
   - complexity: Basit/Orta/Karmaşık
   - uniqueness: Yaygın/Özel/Nadir

5. HEDEF KİŞİLİKLER (targetPersonas):
   - Bu ürünü tercih edecek kişilik tipleri
   - Örnek: ["profesyonel_çalışan", "spor_seven", "moda_takipçisi", "pratik_odaklı"]

6. YAŞAM TARZI UYUMU (lifestyleMatch):
   - Hangi yaşam tarzlarına uygun
   - Örnek: ["aktif_yaşam", "lüks_yaşam", "minimalist_yaşam", "aile_odaklı"]

7. FİYAT PSİKOLOJİSİ (pricePerception):
   - value_proposition: "premium", "budget", "mid_range"
   - price_sensitivity: "düşük", "orta", "yüksek"
   - quality_expectation: "temel", "standart", "premium", "lüks"

8. SEASONAL UYUM (seasonality):
   - Hangi mevsimlerde daha uygun
   - Örnek: ["ilkbahar", "yaz", "sonbahar", "kış", "tüm_mevsim"]

9. KOMBİNASYON ÖNERİLERİ (combinationSuggestions):
   - Bu ürünle iyi gidecek ürün kategorileri
   - Örnek: ["pantolon", "ayakkabı", "aksesuar", "çanta"]

10. REKABET ANALİZİ (competitivePosition):
    - Benzer ürünlerle karşılaştırıldığında güçlü yönler
    - Örnek: ["fiyat_avantajı", "kalite_üstünlüğü", "tasarım_farklılığı"]

YANIT FORMATI:
Sadece JSON formatında döndür:

{
  "semanticTags": ["tag1", "tag2", ...],
  "emotionalTriggers": ["emotion1", "emotion2", ...],
  "useContexts": ["context1", "context2", ...],
  "styleAttributes": {
    "aesthetic": "Modern",
    "formality": "Casual",
    "complexity": "Basit",
    "uniqueness": "Özel"
  },
  "targetPersonas": ["persona1", "persona2", ...],
  "lifestyleMatch": ["lifestyle1", "lifestyle2", ...],
  "pricePerception": {
    "value_proposition": "mid_range",
    "price_sensitivity": "orta",
    "quality_expectation": "standart"
  },
  "seasonality": ["mevsim1", "mevsim2", ...],
  "combinationSuggestions": ["kategori1", "kategori2", ...],
  "competitivePosition": ["avantaj1", "avantaj2", ...]
}

ÖNEMLİ: Sadece JSON döndür, başka açıklama ekleme!`}parseEnhancementResponse(e){try{const r=e.trim().replace(/```json|```/g,"");return JSON.parse(r)}catch(r){return console.error("❌ Failed to parse AI enhancement:",r),this.generateFallbackEnhancement()}}generateFallbackEnhancement(){return{semanticTags:["genel_ürün","standart_kalite","kullanışlı"],emotionalTriggers:["güven","memnuniyet"],useContexts:["günlük_kullanım"],styleAttributes:{aesthetic:"Modern",formality:"Casual",complexity:"Basit",uniqueness:"Yaygın"},targetPersonas:["genel_kullanıcı"],lifestyleMatch:["standart_yaşam"],pricePerception:{value_proposition:"mid_range",price_sensitivity:"orta",quality_expectation:"standart"},seasonality:["tüm_mevsim"],combinationSuggestions:["aksesuar"],competitivePosition:["standart_seçenek"]}}async enhanceProductBatch(e,r,a=8){console.log(`🚀 Batch enhancing ${e.length} products...`);const s=[];for(let n=0;n<e.length;n+=a){const o=e.slice(n,n+a);console.log(`Processing batch ${Math.floor(n/a)+1}/${Math.ceil(e.length/a)}`);const l=o.map(d=>this.enhanceProduct(d,r)),c=await Promise.all(l);s.push(...c),n+a<e.length&&await new Promise(d=>setTimeout(d,200))}return console.log(`✅ Batch enhancement completed: ${s.length} products`),s}calculateAISimilarity(e,r){if(!e.aiAttributes||!r.aiAttributes)return .5;let a=0,s=0;const n=new Set(e.aiAttributes.semanticTags||[]),o=new Set(r.aiAttributes.semanticTags||[]),l=new Set([...n].filter(v=>o.has(v))),c=new Set([...n,...o]);c.size>0&&(a+=l.size/c.size*.3,s+=.3);const d=e.aiAttributes.styleAttributes||{},u=r.aiAttributes.styleAttributes||{};let h=0,g=0;Object.keys({...d,...u}).forEach(v=>{d[v]&&u[v]&&(g++,d[v]===u[v]&&h++)}),g>0&&(a+=h/g*.25,s+=.25);const x=new Set(e.aiAttributes.useContexts||[]),k=new Set(r.aiAttributes.useContexts||[]),f=new Set([...x].filter(v=>k.has(v))),E=new Set([...x,...k]);E.size>0&&(a+=f.size/E.size*.25,s+=.25);const j=new Set(e.aiAttributes.targetPersonas||[]),T=new Set(r.aiAttributes.targetPersonas||[]),D=new Set([...j].filter(v=>T.has(v))),I=new Set([...j,...T]);return I.size>0&&(a+=D.size/I.size*.2,s+=.2),s>0?a/s:.5}}let dr=null;function Ol(){return dr||(dr=new Pl),dr}class Dl{constructor(){this.memoryCache=new Map,this.cacheTimeout=20*60*1e3,this.maxCacheSize=500}generateCacheKey(e,r,a,s={}){const n={userId:e,contextType:r,contextData:this.sanitizeContextData(a),profileHash:this.hashUserProfile(s)};return btoa(JSON.stringify(n)).replace(/[+/=]/g,"")}sanitizeContextData(e){if(!e)return{};const r={...e};return delete r.timestamp,delete r.sessionId,delete r.requestId,r.cartItems&&(r.cartItems=r.cartItems.map(a=>({id:a.id,quantity:a.quantity})).sort((a,s)=>a.id.localeCompare(s.id))),r}hashUserProfile(e){var a;if(!e||Object.keys(e).length===0)return"default";const r=JSON.stringify({age:e.age,gender:e.gender,interests:(a=e.interests)==null?void 0:a.sort(),preferences:e.preferences});return btoa(r).slice(0,16)}async getCachedRecommendations(e,r,a,s){const n=this.generateCacheKey(e,r,a,s),o=this.memoryCache.get(n);if(o&&!this.isExpired(o.timestamp))return console.log("✅ Cache hit (memory):",n.slice(0,16)),o.data;try{const l=localStorage.getItem(`ai_rec_${n}`);if(l){const c=JSON.parse(l);if(this.isExpired(c.timestamp))localStorage.removeItem(`ai_rec_${n}`);else return console.log("✅ Cache hit (localStorage):",n.slice(0,16)),this.memoryCache.set(n,c),this.cleanupMemoryCache(),c.data}}catch(l){console.warn("Cache read error:",l)}return console.log("❌ Cache miss:",n.slice(0,16)),null}async cacheRecommendations(e,r,a,s,n){const o=this.generateCacheKey(e,r,a,s),l={data:n,timestamp:Date.now(),userId:e,contextType:r};this.memoryCache.set(o,l),this.cleanupMemoryCache();try{localStorage.setItem(`ai_rec_${o}`,JSON.stringify(l)),console.log("💾 Cached recommendations:",o.slice(0,16))}catch(c){console.warn("Cache write error:",c),this.clearExpiredLocalStorage()}}isExpired(e){return Date.now()-e>this.cacheTimeout}cleanupMemoryCache(){if(this.memoryCache.size<=this.maxCacheSize)return;const e=Array.from(this.memoryCache.entries());e.sort((a,s)=>a[1].timestamp-s[1].timestamp);const r=e.slice(0,e.length-this.maxCacheSize);r.forEach(([a])=>this.memoryCache.delete(a)),console.log(`🧹 Cleaned up ${r.length} old cache entries`)}clearExpiredLocalStorage(){try{const e=[];for(let r=0;r<localStorage.length;r++){const a=localStorage.key(r);if(a&&a.startsWith("ai_rec_"))try{const s=JSON.parse(localStorage.getItem(a));this.isExpired(s.timestamp)&&e.push(a)}catch{e.push(a)}}e.forEach(r=>localStorage.removeItem(r)),console.log(`🧹 Cleared ${e.length} expired localStorage entries`)}catch(e){console.warn("Error clearing localStorage cache:",e)}}clearAllCache(){this.memoryCache.clear();try{const e=[];for(let r=0;r<localStorage.length;r++){const a=localStorage.key(r);a&&a.startsWith("ai_rec_")&&e.push(a)}e.forEach(r=>localStorage.removeItem(r)),console.log("🧹 Cleared all recommendation cache")}catch(e){console.warn("Error clearing all cache:",e)}}getCacheStats(){const e=this.memoryCache.size;let r=0;try{for(let a=0;a<localStorage.length;a++){const s=localStorage.key(a);s&&s.startsWith("ai_rec_")&&r++}}catch(a){console.warn("Error getting localStorage stats:",a)}return{memoryCache:e,localStorage:r,cacheTimeout:this.cacheTimeout/1e3/60}}}let ur=null;function _l(){return ur||(ur=new Dl),ur}class Ml{constructor(){this.geminiService=Ve(),this.productEnhancer=Ol(),this.cache=_l()}async getAdvancedRecommendations(e,r={}){try{const{apiKey:a,contextType:s="general",contextData:n={},maxRecommendations:o=6,userProfile:l={},currentTime:c=new Date}=r;if(console.log("🧠 Advanced AI Recommendations - Context:",s),!a)throw new Error("API key required for advanced AI recommendations");const d=await this.cache.getCachedRecommendations(e,s,n,l);if(d)return{...d,fromCache:!0,generatedAt:c.toISOString()};this.geminiService.setApiKey(a);const u=await this.getEnhancedProducts(a),h=await this.analyzeUserContext(e,n,l),x={success:!0,recommendations:await this.generateContextualRecommendations(u,h,s,o,c),userContext:h,method:"advanced-ai",confidence:"high",contextType:s,generatedAt:c.toISOString()};return await this.cache.cacheRecommendations(e,s,n,l,x),x}catch(a){return console.error("❌ Advanced AI recommendations failed:",a),this.getFallbackRecommendations(maxRecommendations)}}async getEnhancedProducts(e,r=!1){try{let s=(await Q.getProducts({limit:50})).products;const n=s.filter(o=>!o.aiEnhanced||r);if(n.length>0){console.log(`🔄 Enhancing ${n.length} products with AI...`);const o=await this.productEnhancer.enhanceProductBatch(n,e,5),l=new Map(o.map(c=>[c.id,c]));s=s.map(c=>l.get(c.id)||c)}return s.filter(o=>o.aiEnhanced)}catch(a){return console.error("❌ Failed to get enhanced products:",a),[]}}async analyzeUserContext(e,r,a){try{const s=await this.getStoredUserProfile(e),n=s?{...a,...s}:a;console.log("🧠 Using stored profile data:",s?"Yes":"No");const o=this.buildUserContextPrompt(e,r,n),l=await this.geminiService.generateContent(o,{temperature:.8,maxOutputTokens:800});return this.parseUserContextResponse(l.text)}catch(s){return console.error("❌ User context analysis failed:",s),this.getDefaultUserContext()}}async getStoredUserProfile(e){try{const{getUserProfileService:r}=await ye(async()=>{const{getUserProfileService:l}=await Promise.resolve().then(()=>Kl);return{getUserProfileService:l}},void 0),s=await r().getUserProfile(e);if(s.success)return console.log("📋 Using profile from Firebase"),{questionnaire:s.profile.responses,analysis:s.profile.analysis,createdAt:s.profile.createdAt};const n=localStorage.getItem("userProfile");if(!n)return null;const o=JSON.parse(n);return o.userId===e||o.userId==="anonymous"?(console.log("📋 Using profile from localStorage (fallback)"),{questionnaire:o.responses,analysis:o.analysis,createdAt:o.createdAt}):null}catch(r){return console.error("❌ Error reading stored profile:",r),null}}buildUserContextPrompt(e,r,a){new Date().getHours(),new Date().toLocaleDateString("tr-TR",{weekday:"long"}),this.getCurrentSeason();let s=`- Profil: ${JSON.stringify(a)}`;return a.analysis&&(s+=`
- AI Analiz Sonucu: ${JSON.stringify(a.analysis)}`),a.questionnaire&&(s+=`
- Anket Cevapları: ${JSON.stringify(a.questionnaire)}`),`Kullanıcı davranış analisti olarak bu kişiyi analiz et:

BİLGİLER:
${s}
- Bağlam: ${JSON.stringify(r)}

PROFIL ÇIKAR:

1. currentMood: ruh hali ("produktif", "rahat", "sosyal")  
2. purchaseIntent: satın alma niyeti ("düşük", "yüksek")
3. priceSensitivity: fiyat hassasiyeti ("düşük", "yüksek")
4. explorationPreference: keşif tercihi ("güvenli", "yeni")
5. socialInfluence: sosyal etki ("düşük", "yüksek")
6. timeConstraint: zaman kısıtı ("acil", "normal") 
7. lifestylePriority: yaşam tarzı ("konfor", "stil", "fonksiyon")
8. emotionalState: duygusal durum ("mutlu", "sakin", "stresli")

YANIT FORMATI (sadece JSON):
{
  "currentMood": "string",
  "purchaseIntent": "string", 
  "priceSensitivity": "string",
  "explorationPreference": "string",
  "socialInfluence": "string",
  "timeConstraint": "string",
  "lifestylePriority": "string",
  "emotionalState": "string",
  "confidence": 0.8
}`}parseUserContextResponse(e){try{const r=e.trim().replace(/```json|```/g,"");return JSON.parse(r)}catch(r){return console.error("❌ Failed to parse user context:",r),this.getDefaultUserContext()}}getDefaultUserContext(){return{currentMood:"neutral",purchaseIntent:"orta",priceSensitivity:"orta",explorationPreference:"kısmi_keşif",socialInfluence:"orta",timeConstraint:"normal",lifestylePriority:"konfor",emotionalState:"sakin",confidence:.5}}async generateContextualRecommendations(e,r,a,s,n){try{const o=this.buildAdvancedRecommendationPrompt(e,r,a,s,n),l=await this.geminiService.generateContent(o,{temperature:.7,maxOutputTokens:1200});return this.parseAdvancedRecommendations(l.text,e)}catch(o){return console.error("❌ Advanced recommendation generation failed:",o),this.getFallbackAIRecommendations(e,s)}}buildAdvancedRecommendationPrompt(e,r,a,s,n){const o=this.getCurrentSeason(),l=`${n.getHours()}:00, ${n.toLocaleDateString("tr-TR",{weekday:"long"})}`;return`Sen dünya çapında tanınan bir yapay zeka kişiselleştirme uzmanısın. Kullanıcı davranış psikolojisi, tüketici tercihleri ve bağlamsal faktörleri analiz ederek mükemmel öneriler sunuyorsun.

KULLANICI PSİKOLOJİK PROFİLİ:
${JSON.stringify(r,null,2)}

MEVCUT BAĞLAM:
- Zaman: ${l}
- Mevsim: ${o}
- Öneri Tipi: ${a}
- Hedef: En uygun ${s} ürün

ÜRÜN KATALOĞU (Optimized):
${e.slice(0,20).map(c=>{var d,u,h,g,x,k;return`
${c.id}: ${c.name} (₺${c.price}) | ${c.category}
AI: ${((u=(d=c.aiAttributes)==null?void 0:d.semanticTags)==null?void 0:u.slice(0,3).join(","))||"N/A"} | ${((g=(h=c.aiAttributes)==null?void 0:h.emotionalTriggers)==null?void 0:g[0])||"N/A"} | ${((k=(x=c.aiAttributes)==null?void 0:x.styleAttributes)==null?void 0:k.aesthetic)||"N/A"}`}).join("")}

ÖNERİ STRATEJİSİ:
- Ruh hali & duygusal tetikleyici eşleştir
- Satın alma niyeti & fiyat optimize et  
- ${a} bağlamında en uygun ürünleri seç
- Yaşam tarzı önceliği ile ürün özelliklerini match et

YANIT FORMATI:
{
  "recommendations": [
    {
      "productId": 123,
      "aiReasoningScore": 0.92,
      "reasoning": "Kısa neden açıklaması",
      "confidence": 0.91
    }
  ]
}

ÖNEMLİ: Sadece JSON formatında yanıt ver, başka açıklama ekleme!`}parseAdvancedRecommendations(e,r){try{const a=e.trim().replace(/```json|```/g,""),n=JSON.parse(a).recommendations.map(o=>{const l=r.find(c=>c.id===o.productId);return l?{...l,aiRecommendation:{score:o.aiReasoningScore||.5,psychologicalMatch:o.psychologicalMatch||{},contextualFit:o.contextualFit||{},reasoning:o.reasoning||"AI tarafından önerildi",confidence:o.confidence||.5}}:null}).filter(Boolean).slice(0,6);return console.log("✅ Advanced AI recommendations generated:",n.length),n}catch(a){return console.error("❌ Failed to parse advanced recommendations:",a),this.getFallbackAIRecommendations(r,6)}}getFallbackAIRecommendations(e,r){return console.log("🔧 Using fallback AI recommendations"),e.filter(a=>a.aiEnhanced).sort((a,s)=>{var l,c,d,u;const n=(a.rating||0)*.3+(((c=(l=a.aiAttributes)==null?void 0:l.semanticTags)==null?void 0:c.length)||0)*.2+(a.stock>0?.5:0);return(s.rating||0)*.3+(((u=(d=s.aiAttributes)==null?void 0:d.semanticTags)==null?void 0:u.length)||0)*.2+(s.stock>0?.5:0)-n}).slice(0,r).map(a=>({...a,aiRecommendation:{score:.6,psychologicalMatch:{general:.6},contextualFit:{general:.6},reasoning:"Fallback AI algoritması ile önerildi",confidence:.6}}))}getFallbackRecommendations(e){return{success:!1,recommendations:[],method:"failed",confidence:"low",error:"AI recommendations temporarily unavailable"}}getCurrentSeason(){const e=new Date().getMonth()+1;return e>=3&&e<=5?"ilkbahar":e>=6&&e<=8?"yaz":e>=9&&e<=11?"sonbahar":"kış"}calculateSemanticSimilarity(e,r){return!e.aiAttributes||!r.aiAttributes?.1:this.productEnhancer.calculateAISimilarity(e,r)}async getAIComplementaryProducts(e,r,a,s=4){try{console.log("🧠 Finding AI complementary products for:",e.name),this.geminiService.setApiKey(a);const n=`Sen ürün eşleştirme uzmanısın. Base ürüne en uyumlu tamamlayıcı ürünleri bul.

BASE ÜRÜN:
${e.name} - ${e.category}
AI Attributes: ${JSON.stringify(e.aiAttributes,null,1)}

ADAY ÜRÜNLER:
${r.slice(0,20).map(d=>{var u,h,g,x;return`
ID: ${d.id} - ${d.name} (${d.category})
AI Tags: ${((h=(u=d.aiAttributes)==null?void 0:u.semanticTags)==null?void 0:h.slice(0,3).join(", "))||"N/A"}
Use Contexts: ${((x=(g=d.aiAttributes)==null?void 0:g.useContexts)==null?void 0:x.slice(0,2).join(", "))||"N/A"}
`}).join("")}

Sadece en uyumlu ${s} ürün ID'sini döndür: [1, 2, 3, 4]`,l=(await this.geminiService.generateContent(n,{temperature:.6,maxOutputTokens:300})).text.trim().replace(/```json|```/g,"");return JSON.parse(l).map(d=>r.find(u=>u.id===d)).filter(Boolean).slice(0,s)}catch(n){return console.error("❌ AI complementary products failed:",n),r.filter(o=>o.id!==e.id&&o.aiEnhanced).sort(()=>.5-Math.random()).slice(0,s)}}}let mr=null;function Ll(){return mr||(mr=new Ml),mr}const ka={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},Me={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}},zl=()=>{var w;const{state:i}=ae(),{settings:e,cart:r,user:a,products:s}=i,{getRecommendations:n,trackBehavior:o}=Il(),{generateContent:l}=Rl(),[c,d]=p.useState(s.recommendations||[]),[u,h]=p.useState(!1),[g,x]=p.useState("trending"),[k,f]=p.useState(""),E=()=>({trending:"📈 Trend Analizi",personalized:"👤 Kişisel Analiz",similar:"🔍 Benzerlik Analizi","cart-based":"🛒 Sepet Analizi","advanced-ai":"🧠 Gelişmiş AI Analizi"})[g]||"🤖 AI Analizi",j=()=>({trending:"Popüler ürünler ve trendler analiz ediliyor...",personalized:"Sizin için özel öneriler hazırlanıyor...",similar:"Benzer ürünler ve tercihler inceleniyor...","cart-based":"Sepetinizdeki ürünlere uygun öneriler bulunuyor...","advanced-ai":"Psikolojik profil ve bağlamsal faktörler analiz ediliyor..."})[g]||"Öneriler hazırlanıyor...",T=async(y,P,N)=>{console.log("🛒🤖 Calling Gemini for cart-based recommendations...");try{const S=(a==null?void 0:a.profile)||{},b=N.map(R=>{const O=P.find($=>$.id===R.productId);return O?{id:O.id,name:O.name,category:O.category,price:O.price,quantity:R.quantity}:null}).filter(Boolean),A=`Sen akıllı bir e-ticaret sepet analizi uzmanısın. Kullanıcının sepetindeki ürünleri analiz ederek 6 tane mükemmel tamamlayıcı ürün öner.

KULLANICI: ${S.displayName||"Anonim kullanıcı"}

SEPETTEKİ ÜRÜNLER (${N.length} adet):
${b.map(R=>`📦 ${R.name} (${R.category}) - ₺${R.price} x${R.quantity} adet`).join(`
`)}

SEPET ANALİZİ GÖREVN:
1. 🎯 Sepet temasını belirle (spor, teknoloji, moda, vs.)
2. 🔗 Tamamlayıcı ürünler bul (aksesuarlar, benzer kategoriler)
3. 💰 Fiyat uyumluluğunu koru (benzer fiyat aralığı)
4. 🌟 Yüksek puanlı alternatifler seç
5. 🎨 Çeşitlilik sağla ama uyumlu kal

MEVCUT ÜRÜNLER (seçenekler):
${P.slice(0,25).map(R=>`- ID: ${R.id}, İsim: ${R.name}, Kategori: ${R.category}, Fiyat: ₺${R.price}, Puan: ${R.rating}/5`).join(`
`)}

AKILLI ÖNERİ STRATEJİSİ:
- Sepette Nike ayakkabı var → Adidas, spor kıyafeti, spor aksesuarları öner
- Sepette iPhone var → Apple aksesuarları, kablosuz şarj, kılıf öner  
- Sepette gömlek var → Pantolon, ayakkabı, kemer gibi kombinleyici öner
- Fiyat ortalaması ₺500 → ₺300-800 aralığından seç

ÖNEMLİ: Sadece JSON array formatında ürün ID'lerini döndür:
[1, 2, 3, 4, 5, 6]

Başka hiçbir açıklama ekleme, sadece sayısal ID'leri içeren JSON array döndür.`,C=await l(A);console.log("🛒🤖 Cart-based Gemini response:",C.text);let _=[];try{const R=C.text.trim().replace(/```json|```/g,"");console.log("🛒🔍 Cleaned response:",R),_=JSON.parse(R)}catch{console.log("🛒⚠️ Direct JSON parse failed, trying to extract array...");const O=C.text.match(/\[([\s\S]*?)\]/);if(O)try{_=JSON.parse(O[0]),console.log("🛒✅ Extracted array from response:",_)}catch{console.log("🛒❌ Array extraction failed, using fallback");const W=C.text.match(/\d+/g);_=W?W.slice(0,6):[]}else{const $=C.text.match(/\d+/g);_=$?$.slice(0,6):[]}}console.log("🛒📋 Final product IDs:",_);const L=_.map(R=>{const O=P.find($=>$.id===R||$.id===String(R)||$.id===Number(R)||$.firebaseId===R||$.firebaseId===String(R));return O||console.log(`🛒⚠️ Product not found for ID: ${R}`),O}).filter(Boolean).slice(0,6);return console.log("🛒✅ Cart-based Gemini recommendations:",L.map(R=>`${R.name} (${R.category})`)),L}catch(S){return console.error("🛒❌ Cart-based Gemini call failed:",S),[]}},D=async(y,P)=>{console.log("🤖 Calling Gemini directly for recommendations...");try{const N=(a==null?void 0:a.profile)||{},S=(r==null?void 0:r.items)||[],b=`Sen akıllı bir e-ticaret ürün öneri uzmanısın. Aşağıdaki kullanıcı için 6 ürün öner:

KULLANICI BİLGİLERİ:
- ID: ${y}
- Profil: ${N.displayName||"Anonim kullanıcı"}
- Email: ${N.email||"Bilinmiyor"}

SEPETTEKİ ÜRÜNLER:
${S.length>0?S.map(R=>`- Ürün ID: ${R.productId}, Miktar: ${R.quantity}`).join(`
`):"Sepet boş"}

MEVCUT ÜRÜNLER (${P.length} adet):
${P.slice(0,20).map(R=>`- ID: ${R.id}, İsim: ${R.name}, Kategori: ${R.category}, Fiyat: ₺${R.price}, Puan: ${R.rating}/5`).join(`
`)}

GÖREV:
1. Kullanıcının profiline uygun ürünler seç
2. Sepetindeki ürünlerle uyumlu tamamlayıcı ürünler öner
3. Farklı kategorilerden çeşitlilik sağla
4. Fiyat-performans dengesini koru
5. Yüksek puanlı ürünleri tercih et

YANITINI SADECE ÜRÜN ID'LERİ OLARAK VER:
Örnek: ["prod1", "prod2", "prod3", "prod4", "prod5", "prod6"]

Başka açıklama ekleme, sadece JSON array döndür.`,A=await l(b);console.log("🤖 Gemini raw response:",A.text);const C=A.text.trim().replace(/```json|```/g,""),L=JSON.parse(C).map(R=>P.find(O=>O.id===R)).filter(Boolean).slice(0,6);return console.log("✅ Gemini recommendations:",L.map(R=>R.name)),L}catch(N){return console.error("❌ Direct Gemini call failed:",N),[]}},I=[{id:"trending",title:"Trend Ürünler",description:"En popüler ve trend olan ürünler",icon:Er,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20"},{id:"personalized",title:"Kişiselleştirilmiş",description:"Alışveriş geçmişinize göre öneriler",icon:Ke,color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-100 dark:bg-purple-900/20"},{id:"cart-based",title:"Sepet Bazlı",description:"Sepetinizdeki ürünlere uygun öneriler",icon:tt,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/20"},{id:"advanced-ai",title:"Gelişmiş AI",description:"Psikoloji ve bağlam analizi ile akıllı öneriler",icon:We,color:"text-pink-600 dark:text-pink-400",bgColor:"bg-pink-100 dark:bg-pink-900/20"}];p.useEffect(()=>{var y;(y=a==null?void 0:a.profile)!=null&&y.id?Ae.setUserId(a.profile.id):Ae.setUserId(null),v()},[g,(w=a==null?void 0:a.profile)==null?void 0:w.id]);const v=async()=>{var y,P,N,S;h(!0);try{console.log("Current user state:",a),console.log("User ID:",((y=a==null?void 0:a.profile)==null?void 0:y.id)||(a==null?void 0:a.id)||"No user ID found");const b=((P=a==null?void 0:a.profile)==null?void 0:P.id)||(a==null?void 0:a.id)||(a==null?void 0:a.uid)||"anonymous";if(b&&await o(b,"view_recommendations",{type:g,page:"recommendations"}),g==="advanced-ai"&&b&&e.geminiApiKey){console.log("🧠 Using Advanced AI recommendation system...");try{const R=await Ll().getAdvancedRecommendations(b,{apiKey:e.geminiApiKey,contextType:"browsing",contextData:{currentPage:"recommendations",cartItems:(r==null?void 0:r.items)||[],recentViews:s.recentlyViewed||[]},userProfile:(a==null?void 0:a.profile)||{},maxRecommendations:6});if(R.success&&R.recommendations.length>0){d(R.recommendations),f(`🧠 Gelişmiş AI analizi: ${R.recommendations.length} ürün psikolojik profil ve bağlam analizine göre önerildi. Confidence: ${(((S=(N=R.recommendations[0])==null?void 0:N.aiRecommendation)==null?void 0:S.confidence)*100).toFixed(0)}%`),console.log("✅ Advanced AI recommendations:",R.recommendations.map(O=>O.name)),h(!1);return}}catch(L){console.error("❌ Advanced AI failed:",L),f("⚠️ Gelişmiş AI sistemi geçici olarak kullanılamıyor, standart öneriler gösteriliyor.")}}else if(g==="personalized"&&b){const L={maxRecommendations:6,includeUserHistory:!0,includeBehaviorAnalysis:!0,useCache:!1};console.log("🤖 Trying to get Gemini AI recommendations for user:",b);let R=[],O=!1;try{R=await n(b,L),console.log("📊 Firebase recommendations result:",R)}catch{console.warn("⚠️ Firebase failed, trying direct Gemini call..."),O=!0;let W=[];try{W=(await Q.getProducts({limit:50})).products}catch{const{getAllProducts:G}=await ye(async()=>{const{getAllProducts:V}=await Promise.resolve().then(()=>He);return{getAllProducts:V}},void 0);W=G().slice(0,50)}try{R=await D(b,W)}catch{throw new Error("AI services temporarily overloaded")}}if(R&&R.length>0)d(R),f(O?"🤖 Gemini AI kullanılarak profiliniz, sepetiniz ve tercihleriniz analiz edilerek özellikle sizin için seçildi. Gerçek zamanlı AI analizi!":"📊 Firebase ve Gemini AI kullanılarak kişisel tercihleriniz, alışveriş geçmişiniz ve davranış analiziniz dikkate alınarak özellikle sizin için seçildi.");else{console.log("No Firebase recommendations, generating smart local recommendations");try{const{products:$}=await Q.getProducts({limit:50});console.log("🔧 Using enhanced smart algorithm for personalized recommendations");const W=[...new Set($.map(se=>se.category))];let ee=[];W.forEach(se=>{const be=$.filter(ue=>ue.category===se&&ue.stock>0).map(ue=>({...ue,smartScore:(ue.rating||0)*10+(ue.stock>10?5:0)+(ue.discount>0?3:0)+Math.random()*2})).sort((ue,Ye)=>Ye.smartScore-ue.smartScore).slice(0,2);ee.push(...be)});const G=$.filter(se=>se.stock>0&&!ee.some(be=>be.id===se.id)).sort((se,be)=>(be.rating||0)*(be.reviewCount||1)-(se.rating||0)*(se.reviewCount||1)).slice(0,3);ee.push(...G);const V=ee.slice(0,12).sort(()=>Math.random()-.5).slice(0,6);d(V),f("🔧 Akıllı algoritma ile farklı kategorilerden en popüler ve yüksek puanlı ürünler seçildi. AI servisleri geçici olarak yoğun - yakında daha kişisel öneriler!")}catch{console.warn("Product service failed, using data/products fallback");const{getAllProducts:W}=await ye(async()=>{const{getAllProducts:V}=await Promise.resolve().then(()=>He);return{getAllProducts:V}},void 0),G=W().slice(0,50).sort((V,se)=>(se.rating||0)-(V.rating||0)).slice(0,6);d(G),f("Yerel ürün datası kullanılarak öneriler gösteriliyor.")}}return}let A=[];try{A=(await Q.getProducts({limit:50})).products}catch{console.warn("Product service failed, using data/products fallback");const{getAllProducts:R}=await ye(async()=>{const{getAllProducts:O}=await Promise.resolve().then(()=>He);return{getAllProducts:O}},void 0);A=R().slice(0,50)}let C=[],_="";if(g==="trending")C=A.sort((L,R)=>(R.rating||0)-(L.rating||0)).slice(0,6),_="En yüksek puanlı ve popüler ürünler seçildi. Bu ürünler diğer kullanıcılar tarafından en çok beğenilen ve satın alınan ürünlerdir.";else if(g==="cart-based"){const L=(r==null?void 0:r.items)||[];if(console.log("🛒 Cart-based recommendations - cart items:",L),L.length>0&&e.geminiApiKey){console.log("🤖 Using full Gemini AI for cart-based recommendations...");try{const R=await T(b||"anonymous",A,L);if(R.length>0)C=R,console.log("🎯 Sepet bazlı AI öneriler:"),console.log("  Normal öneriler: 0 ürün (Gemini AI tercih edildi)"),console.log("  + Gemini AI: "+C.length+" ürün (akıllı sepet analizi)"),console.log("  = Toplam: "+C.length+" mükemmel AI öneri"),console.log("✅ Tüm öneriler Gemini AI tarafından sepet analizine göre seçildi!"),_=`🤖 Sepetinizdeki ${L.length} ürün Gemini AI tarafından analiz edildi ve size özel tamamlayıcı ürünler seçildi. Tamamen AI destekli öneriler!`;else throw new Error("Gemini AI no recommendations")}catch{console.warn("⚠️ Gemini AI failed, using fallback algorithm"),console.log("🔧 Using enhanced smart algorithm for cart-based recommendations");const O=L.map(G=>{const V=A.find(se=>se.id===G.productId);return V?{category:V.category,brand:V.brand,priceRange:V.price}:null}).filter(Boolean),$=[...new Set(O.map(G=>G.category))],W=[...new Set(O.map(G=>G.brand))],ee=O.reduce((G,V)=>G+V.priceRange,0)/O.length;C=A.filter(G=>!L.some(V=>V.productId===G.id)).map(G=>{let V=0;return $.includes(G.category)&&(V+=40),W.includes(G.brand)&&(V+=20),Math.abs(G.price-ee)/ee<=.5&&(V+=20),V+=(G.rating||0)*4,G.stock>0&&(V+=10),{...G,smartScore:V}}).sort((G,V)=>V.smartScore-G.smartScore).slice(0,12).sort(()=>Math.random()-.5).slice(0,6),C.length<3&&(C=A.filter(G=>G.stock>0).sort((G,V)=>(V.rating||0)-(G.rating||0)).slice(0,6)),_=`Sepetinizdeki ${L.length} ürün analiz edildi. Kategori uyumu, marka tercihi ve fiyat aralığına göre akıllı öneriler seçildi. (AI geçici olarak kullanılamıyor)`}}else if(L.length>0){console.log("🔧 No API key, using simple cart-based algorithm");const R=L.map(O=>{const $=A.find(W=>W.id===O.productId);return $==null?void 0:$.category}).filter(Boolean);C=A.filter(O=>R.includes(O.category)&&!L.some($=>$.productId===O.id)).sort(()=>Math.random()-.5).slice(0,6),_=`Sepetinizdeki ${L.length} ürüne uygun kategorilerden öneriler. Gemini AI için API anahtarı gerekli.`}else C=A.sort(()=>Math.random()-.5).slice(0,6),_="Sepetiniz boş. Genel popüler ürünler gösteriliyor. Sepete ürün ekledikten sonra AI destekli öneriler alabilirsiniz."}else C=A.sort(()=>Math.random()-.5).slice(0,6),_="Kişiselleştirilmiş öneriler için kullanıcı girişi gerekli. Şu anda genel öneriler gösteriliyor.";d(C),f(_)}catch(b){console.error("Error generating recommendations:",b);try{const{products:A}=await Q.getProducts({limit:50});d(A.sort(()=>Math.random()-.5).slice(0,6)),f("Öneriler oluşturulurken bir hata oluştu. Genel ürün seçimi gösteriliyor.")}catch{console.warn("All services failed, using local data");const{getAllProducts:C}=await ye(async()=>{const{getAllProducts:L}=await Promise.resolve().then(()=>He);return{getAllProducts:L}},void 0),_=C();d(_.sort(()=>Math.random()-.5).slice(0,6)),f("Yerel ürün datası kullanılarak rastgele öneriler gösteriliyor.")}}finally{h(!1)}};return!e.geminiApiKey&&g==="personalized"?t.jsx(m.div,{className:"max-w-4xl mx-auto",variants:ka,initial:"hidden",animate:"visible",children:t.jsxs(m.div,{className:"text-center py-12",variants:Me,children:[t.jsx(m.div,{className:"mx-auto flex items-center justify-center h-20 w-20 rounded-3xl bg-gradient-to-br from-red-500 to-pink-500 mb-8 shadow-xl",whileHover:{scale:1.05,rotate:5},transition:{duration:.3},children:t.jsx(ge,{className:"h-10 w-10 text-white"})}),t.jsx(m.h1,{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",variants:Me,children:"AI Kişiselleştirilmiş Öneriler"}),t.jsx(m.p,{className:"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-2xl mx-auto leading-relaxed",variants:Me,children:"Kişiselleştirilmiş AI önerileri için API anahtarınızı yapılandırmanız gerekiyor."}),t.jsx(m.div,{variants:Me,whileHover:{scale:1.02},whileTap:{scale:.98},children:t.jsx("div",{className:"inline-flex items-center px-8 py-4 bg-gray-400 text-white font-semibold rounded-2xl opacity-50 cursor-not-allowed",children:"API Yapılandırma Devre Dışı"})})]})}):t.jsxs(m.div,{className:"max-w-6xl mx-auto",variants:ka,initial:"hidden",animate:"visible",children:[t.jsxs(m.div,{className:"text-center py-12 mb-8",variants:Me,children:[t.jsxs(m.div,{className:"mx-auto flex items-center justify-center h-20 w-20 rounded-3xl bg-gradient-to-br from-red-500 to-pink-500 mb-8 shadow-xl relative",whileHover:{scale:1.05,rotate:5},transition:{duration:.3},children:[t.jsx(ge,{className:"h-10 w-10 text-white"}),t.jsx(m.div,{className:"absolute -top-1 -right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:t.jsx(xe,{className:"w-3 h-3 text-white"})})]}),t.jsx(m.h1,{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",variants:Me,children:"Kişisel Öneriler"}),t.jsx(m.p,{className:"text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-3xl mx-auto leading-relaxed",variants:Me,children:"ShopSmart AI ile size özel seçilmiş ürün önerileri. Tercihlerinize göre kişiselleştirilmiş alışveriş deneyimi."})]}),t.jsx(m.div,{className:"mb-12",variants:Me,children:t.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:I.map(y=>t.jsxs(m.button,{onClick:()=>x(y.id),className:`p-6 rounded-2xl border-2 transition-all duration-300 ${g===y.id?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 bg-white/50 dark:bg-gray-800/50 hover:border-primary-300"}`,whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[t.jsx("div",{className:`${y.bgColor} ${y.color} p-3 rounded-xl`,children:t.jsx(y.icon,{className:"w-6 h-6"})}),t.jsx("div",{className:"text-left",children:t.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:y.title})})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-left",children:y.description})]},y.id))})}),k&&t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:t.jsx("div",{className:"bg-gradient-to-r from-blue-50 via-purple-50/50 to-blue-50 dark:from-blue-900/20 dark:via-purple-900/10 dark:to-blue-900/20 rounded-2xl p-6 border border-blue-200/50 dark:border-blue-800/50",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx(m.div,{className:"flex-shrink-0 w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(vt,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"AI Analizi"}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:k})]})]})})}),t.jsxs(m.div,{className:"mb-12",variants:Me,children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(m.div,{className:"w-8 h-8 bg-gradient-to-br from-red-500 to-pink-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(ge,{className:"w-4 h-4 text-white"})}),t.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Önerilen Ürünler (",c.length,")"]})]}),t.jsxs(m.button,{onClick:v,disabled:u,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-primary-600 to-accent-600 hover:from-primary-700 hover:to-accent-700 text-white font-semibold rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(m.div,{animate:u?{rotate:360}:{},transition:u?{duration:1,repeat:1/0,ease:"linear"}:{},children:t.jsx(Qe,{className:"w-4 h-4"})}),t.jsx("span",{children:u?"Yenileniyor...":"Yenile"})]})]}),t.jsx(oe,{mode:"wait",children:u?t.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center py-16",children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"mx-auto w-16 h-16 bg-gradient-to-br from-primary-500 to-accent-500 rounded-full flex items-center justify-center mb-4",children:t.jsx(We,{className:"w-8 h-8 text-white"})}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:E()}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:j()}),t.jsxs("div",{className:"flex justify-center items-center space-x-2 text-sm text-gray-500",children:[t.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full animate-pulse"}),t.jsx("span",{children:"Ürün semantik analizi"})]}),t.jsxs("div",{className:"flex justify-center items-center space-x-2 text-sm text-gray-500",children:[t.jsx("div",{className:"w-2 h-2 bg-accent-500 rounded-full animate-pulse"}),t.jsx("span",{children:"Kişiselleştirilmiş eşleştirme"})]})]})]},"loading"):t.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((y,P)=>t.jsx(m.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},transition:{delay:P*.1,duration:.3},children:t.jsx(Xe,{product:y})},y.id))},"results")})]}),t.jsx(m.div,{className:"text-center",variants:Me,children:t.jsxs(m.div,{className:"inline-flex items-center space-x-3 px-8 py-4 bg-gradient-to-r from-red-50 via-pink-50/50 to-red-50 dark:from-red-900/20 dark:via-pink-900/10 dark:to-red-900/20 rounded-3xl border border-red-200/50 dark:border-red-800/50 backdrop-blur-sm",whileHover:{scale:1.02,y:-2},transition:{duration:.2},children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},children:t.jsx(xe,{className:"w-6 h-6 text-red-500"})}),t.jsx("span",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:"AI destekli öneriler aktif!"}),t.jsx(m.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:t.jsx(ge,{className:"w-6 h-6 text-pink-500"})})]})})]})};class _t extends Kt.Component{constructor(r){super(r);$e(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});$e(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,a){console.error("ErrorBoundary caught an error:",r,a),this.setState({error:r,errorInfo:a})}render(){if(this.state.hasError){const{fallback:r}=this.props;return r?t.jsx(r,{error:this.state.error,errorInfo:this.state.errorInfo,onRetry:this.handleRetry,onGoHome:this.handleGoHome}):t.jsx(Ul,{error:this.state.error,errorInfo:this.state.errorInfo,onRetry:this.handleRetry,onGoHome:this.handleGoHome})}return this.props.children}}const Ul=({error:i,errorInfo:e,onRetry:r,onGoHome:a})=>t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:t.jsx("div",{className:"max-w-md w-full",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 dark:bg-red-900/20 mb-6",children:t.jsx(Ct,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Something went wrong"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"We're sorry, but something unexpected happened. Please try refreshing the page or go back to the homepage."}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[t.jsxs("button",{onClick:r,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200",children:[t.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Try Again"]}),t.jsxs("button",{onClick:a,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200",children:[t.jsx(Sr,{className:"w-4 h-4 mr-2"}),"Go Home"]})]}),!1]})})}),Fl=({children:i,fallback:e,onError:r})=>t.jsx(_t,{fallback:({error:a,onRetry:s})=>t.jsxs("div",{className:"p-4 border border-red-200 dark:border-red-800 rounded-lg bg-red-50 dark:bg-red-900/10",children:[t.jsxs("div",{className:"flex items-center space-x-2 text-red-700 dark:text-red-400 mb-2",children:[t.jsx(Ct,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm font-medium",children:"Component Error"})]}),t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-3",children:(a==null?void 0:a.message)||"This component failed to render properly."}),e||t.jsx("button",{onClick:s,className:"text-xs px-2 py-1 bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400 rounded hover:bg-red-200 dark:hover:bg-red-900/30 transition-colors duration-200",children:"Retry"})]}),onError:r,children:i});let hr=null,gr=null;const wa=async()=>{try{return hr||(hr=(await ye(()=>Promise.resolve().then(()=>pl),void 0)).createGeminiService),gr||(gr=(await ye(()=>Promise.resolve().then(()=>yl),void 0)).getVisualSearchService),{createGeminiService:hr,getVisualSearchService:gr}}catch(i){throw console.error("Error loading services:",i),new Error("Servisler yüklenirken hata oluştu")}},$l=()=>{const[i,e]=p.useState(null),[r,a]=p.useState(!1),[s,n]=p.useState([]),[o,l]=p.useState(!1),[c,d]=p.useState(null),[u,h]=p.useState([]),[g,x]=p.useState([]),[k,f]=p.useState(!0),[E,j]=p.useState(null),[T,D]=p.useState(null),{state:I}=ae(),{settings:v}=I;p.useEffect(()=>{(async()=>{try{f(!0);const S=await Q.getProducts({limit:50});x(S.products||[])}catch(S){console.error("Error loading products:",S)}finally{f(!1)}})()},[]);const w=async N=>{if(!v.geminiApiKey){D("Gemini API anahtarı bulunamadı. Lütfen ayarlarınızı kontrol edin.");return}a(!0),D(null);try{console.log("🔍 Starting visual analysis for complementary products");const{createGeminiService:S}=await wa(),b=S(v.geminiApiKey,v.selectedModel),A=`Bu yüklenen ürün görseli için detaylı görsel analiz yap ve tamamlayıcı ürün önerileri sun:

ÜRÜN ANALİZİ:
1. 🎨 **Stil & Tasarım**: Bu ürünün görsel özellikleri ve tarzı
2. 🌈 **Renk Analizi**: Dominant renkler ve uyumlu renk paleti
3. 👔 **Kategori**: Ürün türü ve kullanım alanları
4. ✨ **Kalite İpuçları**: Görselden anlaşılan kalite göstergeleri

TAMAMLAYICI ÜRÜN ÖNERİLERİ:
5. 🛍️ **Kombine Edilebilecek Ürünler**: Bu ürünle mükemmel uyum sağlayacak diğer ürün türleri
6. 🎯 **Renk Koordinasyonu**: Hangi renklerle kombine edilebilir
7. 🏷️ **Kategori Önerileri**: Hangi kategorilerden ürünler uyumlu olur
8. 💡 **Stil Tavsiyeleri**: Nasıl kombinlenebilir, hangi durumlarda kullanılır

Müşterilerin bu ürünü satın aldıklarında aynı zamanda ihtiyaç duyacakları tamamlayıcı ürünleri önermek için detaylı analiz yap. Türkçe olarak, pratik ve faydalı öneriler sun.`;try{const C=N.split(",")[1],_=N.split(";")[0].split(":")[1];if(!C||!_)throw new Error("Görsel formatı desteklenmiyor");const L=await b.generateContentWithImage(A,C,{mimeType:_});e(L.text),console.log("✅ Visual analysis completed");const R={id:Date.now(),product:{name:"Yüklenen Görsel",image:c},analysis:L.text,timestamp:new Date().toLocaleString("tr-TR")};h(O=>[R,...O.slice(0,4)]),await y(L.text)}catch(C){throw new Error("Görsel işleme hatası: "+C.message)}}catch(S){console.error("Error analyzing product image:",S);let b="Görsel analizi sırasında bir hata oluştu. Lütfen daha sonra tekrar deneyin.";S.message.includes("Rate limit")||S.message.includes("overloaded")?b="🔄 AI servis yoğunluğu nedeniyle analiz gecikti. Birkaç saniye bekleyip tekrar deneyin.":(S.message.includes("offline")||S.message.includes("Offline"))&&(b="📡 Şu anda offline modda çalışıyoruz. Temel görsel analiz yapılacak."),e(b),D(b)}finally{a(!1)}},y=async N=>{if(!g||g.length===0){console.log("⚠️ No products available for matching");return}l(!0);try{console.log("🛍️ Getting complementary products based on visual analysis");const{getVisualSearchService:S}=await wa(),A=await S().getMatchingProducts(N||i,v.geminiApiKey,{maxRecommendations:12,includeComplementary:!0});console.log("✅ Found complementary products:",A.products.length),console.log("🔍 Matching method used:",A.matchingMethod),console.log("📈 Confidence level:",A.confidence),n(A.products||[])}catch(S){console.error("Error getting complementary products:",S),n([]),e(b=>b+`

⚠️ Tamamlayıcı ürün arama sırasında bir hata oluştu. Lütfen tekrar deneyin.`)}finally{l(!1)}},P=N=>{const S=N.target.files[0];if(S&&S.type.startsWith("image/")){if(S.size>5*1024*1024){D("Dosya boyutu çok büyük. Lütfen 5MB'dan küçük bir görsel seçin.");return}const b=new FileReader;b.onload=A=>{d(A.target.result),D(null),w(A.target.result)},b.onerror=()=>{D("Dosya okuma hatası oluştu. Lütfen tekrar deneyin.")},b.readAsDataURL(S)}else D("Lütfen geçerli bir görsel dosyası seçin (JPG, PNG, GIF).")};return v.geminiApiKey?t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"🤖 Tamamlayıcı Ürün Keşfi"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"AI ile görsel analiz yaparak ürünlerinizle uyumlu tamamlayıcı ürünleri keşfedin"})]}),T&&t.jsx(m.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4 mb-6",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx(Ct,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-red-800 dark:text-red-200 text-sm",children:T}),t.jsx("button",{onClick:()=>D(null),className:"text-red-600 dark:text-red-400 text-xs underline mt-1 hover:no-underline",children:"Kapat"})]})]})}),t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 mb-8",children:t.jsx("div",{className:"max-w-2xl mx-auto",children:t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[t.jsx(Oa,{className:"w-5 h-5 mr-2"}),"Kendi Görselinizi Yükleyin"]}),t.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center hover:border-purple-400 transition-colors",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:P,className:"hidden",id:"image-upload"}),t.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer",children:[t.jsx("div",{className:"mx-auto w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mb-4",children:t.jsx(Js,{className:"w-6 h-6 text-gray-400"})}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Görsel dosyası yüklemek için tıklayın"}),t.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG, GIF desteklenir"})]})]}),c&&t.jsx("div",{className:"mt-4",children:t.jsx("div",{className:"relative w-32 h-32 mx-auto bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden",children:t.jsx("img",{src:c,alt:"Yüklenen görsel",className:"w-full h-full object-cover"})})})]})})}),t.jsx(oe,{children:c&&t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-gradient-to-r from-blue-50 via-purple-50 to-pink-50 dark:from-blue-900/20 dark:via-purple-900/10 dark:to-pink-900/20 rounded-xl p-6 border border-blue-200/50 dark:border-blue-800/50 mb-8",children:t.jsxs("div",{className:"flex items-start space-x-6",children:[t.jsxs("div",{className:"relative w-32 h-32 bg-gray-100 dark:bg-gray-700 rounded-xl overflow-hidden flex-shrink-0",children:[t.jsx("img",{src:c,alt:"Yüklenen görsel",className:"w-full h-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(m.div,{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center",whileHover:{scale:1.1,rotate:5},children:t.jsx(Je,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"🤖 AI Görsel Analiz Sonucu"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Yüklenen Görsel"})]})]}),r&&t.jsxs("div",{className:"flex items-center space-x-2 text-purple-600",children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:t.jsx(qe,{className:"w-4 h-4"})}),t.jsx("span",{className:"text-sm",children:"Analiz ediliyor..."})]})]}),i&&t.jsxs("div",{className:"bg-white/80 dark:bg-gray-800/80 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[t.jsx(xe,{className:"w-5 h-5 text-purple-500"}),t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"AI Analiz Sonucu"})]}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm whitespace-pre-wrap leading-relaxed",children:i})]})]})]})})}),t.jsx(oe,{children:o?t.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center py-16",children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"mx-auto w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center mb-4",children:t.jsx(tt,{className:"w-6 h-6 text-white"})}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Tamamlayıcı ürünler bulunuyor..."})]}):s.length>0?t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-green-50 via-emerald-50 to-green-50 dark:from-green-900/20 dark:via-emerald-900/10 dark:to-green-900/20 rounded-xl p-4 border border-green-200/50 dark:border-green-800/50",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ge,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-semibold text-green-800 dark:text-green-200",children:"Tamamlayıcı Ürün Önerileri Hazır!"})]}),t.jsxs(m.button,{onClick:()=>y(),className:"inline-flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white font-medium rounded-lg transition-all duration-300 text-sm",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(Qe,{className:"w-4 h-4"}),t.jsx("span",{children:"Yenile"})]})]}),t.jsxs("p",{className:"text-green-700 dark:text-green-300 text-sm mt-2",children:[s.length," ürün bu ürününüzle mükemmel uyum sağlayacak. 🤖 AI ile analiz edildi."]})]}),t.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:s.map((N,S)=>t.jsx(m.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},transition:{delay:S*.1,duration:.3},children:t.jsx(Xe,{product:N})},N.id))})]}):i&&!o?t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12",children:[t.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-yellow-100 to-orange-100 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-2xl flex items-center justify-center mb-4",children:t.jsx(Gt,{className:"w-8 h-8 text-yellow-500"})}),t.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Tamamlayıcı Ürün Bulunamadı"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 max-w-md mx-auto",children:"Bu ürün için şu an tamamlayıcı ürün önerisi bulunamadı. Daha sonra tekrar deneyin."}),t.jsxs(m.button,{onClick:()=>y(),className:"inline-flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-medium rounded-xl transition-all duration-300",whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(Qe,{className:"w-4 h-4"}),t.jsx("span",{children:"Tekrar Dene"})]})]}):!r&&!c&&t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16",children:[t.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-purple-100 to-pink-100 dark:from-purple-900/20 dark:to-pink-900/20 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Je,{className:"w-8 h-8 text-purple-500"})}),t.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Tamamlayıcı Ürün Keşfine Başlayın"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 max-w-md mx-auto",children:"Mevcut ürünlerden birini seçin veya kendi görselinizi yükleyerek AI ile analiz ederek size en uygun tamamlayıcı ürünleri keşfedin."})]})}),u.length>0&&t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-12 bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[t.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Son Analizler"]}),t.jsx("div",{className:"space-y-3",children:u.slice(0,3).map(N=>t.jsxs("div",{className:"flex items-center space-x-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>{j(N.product),e(N.analysis),y(N.analysis)},children:[t.jsx("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-600 rounded-lg overflow-hidden flex-shrink-0",children:t.jsx("img",{src:N.product.image,alt:N.product.name,className:"w-full h-full object-cover"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white text-sm",children:N.product.name}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:N.timestamp})]}),t.jsx(vt,{className:"w-4 h-4 text-gray-400"})]},N.id))})]})]})}):t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:t.jsx("div",{className:"max-w-4xl mx-auto",children:t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16",children:[t.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Je,{className:"w-8 h-8 text-gray-400"})}),t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"API Anahtarı Gerekli"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:"Tamamlayıcı ürün önerilerini görmek için önce Gemini API anahtarınızı yapılandırmanız gerekiyor."})]})})})},Bl=()=>t.jsx(Fl,{fallback:t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:t.jsxs("div",{className:"max-w-4xl mx-auto text-center py-16",children:[t.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Ct,{className:"w-8 h-8 text-red-500"})}),t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Tamamlayıcı Ürünler Yüklenemiyor"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto mb-4",children:"Bu sayfa yüklenirken bir hata oluştu. Sayfayı yenilemeyi deneyin."}),t.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Sayfayı Yenile"})]})}),children:t.jsx($l,{})});class Gl{constructor(){this.collectionName="userProfiles"}async saveUserProfile(e,r){try{console.log("💾 Saving user profile to Firebase:",e);const a={userId:e,responses:r.responses,analysis:r.analysis,version:"1.0",createdAt:te(),updatedAt:te(),isActive:!0},s=re(F,this.collectionName,e);return await ut(s,a),console.log("✅ User profile saved successfully"),{success:!0,profileId:e}}catch(a){throw console.error("❌ Error saving user profile:",a),new Error(`Profil kaydedilirken hata oluştu: ${a.message}`)}}async getUserProfile(e){var r,a,s,n;try{console.log("📖 Getting user profile from Firebase:",e);const o=re(F,this.collectionName,e),l=await Pe(o);if(l.exists()){const c=l.data();return console.log("✅ User profile found"),{success:!0,profile:{userId:c.userId,responses:c.responses,analysis:c.analysis,version:c.version,createdAt:((a=(r=c.createdAt)==null?void 0:r.toDate)==null?void 0:a.call(r))||new Date(c.createdAt),updatedAt:((n=(s=c.updatedAt)==null?void 0:s.toDate)==null?void 0:n.call(s))||new Date(c.updatedAt),isActive:c.isActive}}}else return console.log("ℹ️ No user profile found"),{success:!1,message:"Profil bulunamadı"}}catch(o){throw console.error("❌ Error getting user profile:",o),new Error(`Profil getirilirken hata oluştu: ${o.message}`)}}async updateUserProfile(e,r){try{console.log("🔄 Updating user profile:",e);const a=re(F,this.collectionName,e),s={...r,updatedAt:te(),version:"1.0"};return await Re(a,s),console.log("✅ User profile updated successfully"),{success:!0}}catch(a){throw console.error("❌ Error updating user profile:",a),new Error(`Profil güncellenirken hata oluştu: ${a.message}`)}}async hasUserProfile(e){try{const r=re(F,this.collectionName,e);return(await Pe(r)).exists()}catch(r){return console.error("❌ Error checking user profile:",r),!1}}async migrateFromLocalStorage(e){try{const r=localStorage.getItem("userProfile");if(!r)return null;const a=JSON.parse(r);return a.userId===e||a.userId==="anonymous"?(await this.saveUserProfile(e,{responses:a.responses,analysis:a.analysis}),localStorage.removeItem("userProfile"),console.log("✅ Profile migrated from localStorage to Firebase"),!0):!1}catch(r){return console.error("❌ Error migrating profile:",r),!1}}async getProfileStats(e){try{const r=await this.getUserProfile(e);if(!r.success)return null;const a=r.profile.responses,s=r.profile.analysis;return{completionDate:r.profile.createdAt,lastUpdate:r.profile.updatedAt,questionCount:Object.keys(a).length,confidenceScore:(s==null?void 0:s.confidence)||0,profileScore:(s==null?void 0:s.profileScore)||0,version:r.profile.version}}catch(r){return console.error("❌ Error getting profile stats:",r),null}}async deleteUserProfile(e){try{return await this.updateUserProfile(e,{isActive:!1,deletedAt:te()}),console.log("✅ User profile soft deleted"),{success:!0}}catch(r){throw console.error("❌ Error deleting user profile:",r),r}}createBackup(e){const r={backup_date:new Date().toISOString(),profile_data:e,version:"1.0"},a=JSON.stringify(r,null,2),s=new Blob([a],{type:"application/json"}),n=URL.createObjectURL(s),o=document.createElement("a");o.href=n,o.download=`ai_profile_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}}let pr=null;function jr(){return pr||(pr=new Gl),pr}const Kl=Object.freeze(Object.defineProperty({__proto__:null,getUserProfileService:jr},Symbol.toStringTag,{value:"Module"})),Hl=()=>{const{state:i,dispatch:e,actionTypes:r}=ae(),[a,s]=p.useState(0),[n,o]=p.useState({}),[l,c]=p.useState(!1),[d,u]=p.useState(null),[h,g]=p.useState(!1),[x,k]=p.useState(null),[f,E]=p.useState(!1),j=[{id:"lifestyle",title:"Yaşam Tarzınız",icon:Ke,color:"from-blue-500 to-indigo-600",questions:[{id:"daily_routine",type:"single",question:"Günlük rutininizi nasıl tanımlarsınız?",options:[{value:"structured",label:"Planlı ve düzenli",emoji:"📅"},{value:"flexible",label:"Esnek ve spontane",emoji:"🌊"},{value:"busy",label:"Yoğun ve hızlı tempolu",emoji:"⚡"},{value:"relaxed",label:"Rahat ve sakin",emoji:"😌"}]},{id:"social_preference",type:"single",question:"Sosyal aktiviteleri nasıl tercih edersiniz?",options:[{value:"extrovert",label:"Kalabalık ortamları severim",emoji:"🎉"},{value:"introvert",label:"Küçük grup aktivitelerini tercih ederim",emoji:"👥"},{value:"balanced",label:"Duruma göre değişir",emoji:"⚖️"},{value:"solo",label:"Genellikle tek başıma vakit geçiririm",emoji:"🧘"}]},{id:"work_style",type:"single",question:"Çalışma/okul hayatınızda hangi rol size daha uygun?",options:[{value:"leader",label:"Lider/Yönetici",emoji:"👑"},{value:"creative",label:"Yaratıcı/Tasarımcı",emoji:"🎨"},{value:"analytical",label:"Analitik/Stratejist",emoji:"🧠"},{value:"supportive",label:"Destekleyici/Yardımcı",emoji:"🤝"}]}]},{id:"shopping_habits",title:"Alışveriş Alışkanlıklarınız",icon:tt,color:"from-green-500 to-emerald-600",questions:[{id:"shopping_frequency",type:"single",question:"Giyim alışverişi ne sıklıkla yaparsınız?",options:[{value:"weekly",label:"Haftada bir veya daha sık",emoji:"🛍️"},{value:"monthly",label:"Ayda bir",emoji:"📅"},{value:"seasonal",label:"Mevsimlik (3-4 ayda bir)",emoji:"🍂"},{value:"rare",label:"Çok nadir (yılda 1-2 kez)",emoji:"⏰"}]},{id:"decision_speed",type:"single",question:"Satın alma kararlarınızı nasıl verirsiniz?",options:[{value:"instant",label:"Hemen karar veririm",emoji:"⚡"},{value:"quick",label:"Kısa sürede karar veririm",emoji:"💨"},{value:"research",label:"Araştırma yapar, karşılaştırırım",emoji:"🔍"},{value:"long_think",label:"Uzun süre düşünürüm",emoji:"🤔"}]},{id:"shopping_motivation",type:"multiple",question:"Alışveriş yaparken sizi motive eden faktörler nelerdir?",options:[{value:"need",label:"İhtiyaç",emoji:"✅"},{value:"fashion",label:"Moda ve trend",emoji:"👗"},{value:"mood",label:"Ruh halim",emoji:"💝"},{value:"discount",label:"İndirim ve fırsatlar",emoji:"💰"},{value:"quality",label:"Kalite",emoji:"⭐"},{value:"comfort",label:"Konfor",emoji:"😌"}]}]},{id:"style_preferences",title:"Stil Tercihleri",icon:Vr,color:"from-purple-500 to-pink-600",questions:[{id:"style_type",type:"single",question:"Hangi stil kategorisi size daha yakın?",options:[{value:"classic",label:"Klasik ve zarif",emoji:"👔"},{value:"casual",label:"Günlük ve rahat",emoji:"👕"},{value:"trendy",label:"Modaya uygun ve çağdaş",emoji:"✨"},{value:"unique",label:"Özgün ve farklı",emoji:"🦄"}]},{id:"color_preference",type:"multiple",question:"Hangi renk paletlerini tercih edersiniz?",options:[{value:"neutral",label:"Nötr renkler (bej, gri, siyah)",emoji:"⚫"},{value:"earth",label:"Toprak tonları (kahverengi, haki)",emoji:"🤎"},{value:"bright",label:"Canlı renkler (kırmızı, mavi)",emoji:"🔴"},{value:"pastel",label:"Pastel tonlar (pembe, mint)",emoji:"🌸"},{value:"dark",label:"Koyu tonlar (lacivert, bordo)",emoji:"🖤"},{value:"mixed",label:"Karışık, deneyime açığım",emoji:"🌈"}]},{id:"comfort_vs_style",type:"scale",question:"Konfor mu stil mi daha önemli?",scale:{min:1,max:5,minLabel:"Tamamen konfor",maxLabel:"Tamamen stil",emoji:["😴","😌","⚖️","✨","👑"]}}]},{id:"personality_psychology",title:"Kişilik ve Psikoloji",icon:We,color:"from-indigo-500 to-purple-600",questions:[{id:"risk_taking",type:"scale",question:"Yeni şeyler deneme konusunda ne kadar risk alırsınız?",scale:{min:1,max:5,minLabel:"Güvenli seçimler",maxLabel:"Yeni deneyimler",emoji:["🛡️","🤷","⚖️","🚀","🦋"]}},{id:"social_influence",type:"scale",question:"Başkalarının görüşleri ne kadar önemli?",scale:{min:1,max:5,minLabel:"Sadece kendi zevkim",maxLabel:"Sosyal onay önemli",emoji:["🙋","😊","👥","👀","📸"]}},{id:"mood_impact",type:"single",question:"Ruh haliniz alışveriş tercihlerinizi nasıl etkiler?",options:[{value:"high_impact",label:"Çok etkiler, mood'uma göre alışveriş yaparım",emoji:"🎭"},{value:"moderate",label:"Orta düzeyde etkiler",emoji:"🌊"},{value:"low_impact",label:"Az etkiler, genellikle aynı tarzda alışveriş yaparım",emoji:"🎯"},{value:"no_impact",label:"Hiç etkilemez, plan dahilinde hareket ederim",emoji:"📋"}]}]},{id:"budget_priorities",title:"Bütçe ve Öncelikler",icon:Qs,color:"from-yellow-500 to-orange-600",questions:[{id:"price_sensitivity",type:"scale",question:"Fiyat konusunda ne kadar hassassınız?",scale:{min:1,max:5,minLabel:"Fiyat önemli değil",maxLabel:"Fiyat çok önemli",emoji:["💎","💰","⚖️","💵","🪙"]}},{id:"quality_vs_price",type:"single",question:"Kalite ve fiyat arasında nasıl bir denge kurarsınız?",options:[{value:"premium",label:"Yüksek kalite için fazla öderim",emoji:"👑"},{value:"balanced",label:"Kalite-fiyat dengesini ararım",emoji:"⚖️"},{value:"budget",label:"Bütçe dostu seçenekleri tercih ederim",emoji:"💰"},{value:"bargain",label:"En ucuz seçenekleri ararım",emoji:"🏷️"}]},{id:"spending_priorities",type:"multiple",question:"Giyim kategorilerinde hangi alanlara daha çok harcama yaparsınız?",options:[{value:"basics",label:"Temel giyim (t-shirt, pantolon)",emoji:"👕"},{value:"formal",label:"Resmi kıyafetler",emoji:"👔"},{value:"shoes",label:"Ayakkabı",emoji:"👟"},{value:"accessories",label:"Aksesuar",emoji:"👜"},{value:"seasonal",label:"Mevsimlik özel parçalar",emoji:"🧥"},{value:"underwear",label:"İç giyim",emoji:"🩲"}]}]}];p.useEffect(()=>{T()},[]);const T=async()=>{var C,_,L,R;try{const O=((_=(C=i.user)==null?void 0:C.profile)==null?void 0:_.id)||((L=i.user)==null?void 0:L.id)||((R=i.user)==null?void 0:R.uid);if(!O)return;const $=jr(),W=await $.getUserProfile(O);if(W.success){console.log("📋 Existing profile found in Firebase"),k(W.profile),o(W.profile.responses),u(W.profile.analysis),g(!0);return}if(await $.migrateFromLocalStorage(O)){const G=await $.getUserProfile(O);G.success&&(k(G.profile),o(G.profile.responses),u(G.profile.analysis),g(!0))}}catch(O){console.error("❌ Error checking existing profile:",O)}},D=(C,_,L=!1)=>{o(R=>({...R,[C]:L?R[C]?R[C].includes(_)?R[C].filter(O=>O!==_):[...R[C],_]:[_]:_}))},I=()=>j[a].questions.every(_=>{const L=n[_.id];return _.type==="multiple"?L&&L.length>0:L!=null&&L!==""}),v=()=>{a<j.length-1?s(C=>C+1):y()},w=()=>{a>0&&s(C=>C-1)},y=async()=>{var C,_,L,R;c(!0);try{if(!i.settings.geminiApiKey)throw new Error("Gemini API key bulunamadı. Lütfen ayarlardan API anahtarınızı girin.");const O=Ve();O.setApiKey(i.settings.geminiApiKey);const $=`Sen uzman bir kullanıcı davranış analisti ve kişiselleştirme uzmanısın. Bu kullanıcının profil anketinden çıkan detaylı kişilik analizini yap.

KULLANICI ANKETİ SONUÇLARI:
${JSON.stringify(n,null,2)}

GÖREV: Bu kullanıcı için kapsamlı bir AI profili oluştur:

1. KİŞİLİK ANALİZİ (personalityAnalysis):
   - Ana kişilik özellikleri
   - Karar verme tarzı
   - Sosyal eğilimler
   - Risk alma düzeyi

2. ALISVERIS PSİKOLOJİSİ (shoppingPsychology):
   - Satın alma motivasyonları
   - Karar verme süreci
   - Fiyat hassasiyeti
   - Kalite algısı

3. STİL PROFİLİ (styleProfile):
   - Temel stil karakteristiği
   - Renk tercihleri
   - Konfor vs stil dengesi
   - Moda takip etme düzeyi

4. ÖNERİ STRATEJİSİ (recommendationStrategy):
   - Ürün önerilerinde odaklanılacak faktörler
   - Pazarlama mesajı tonu
   - Sezonallik duyarlılığı
   - Sosyal etki düzeyi

5. AI PARAMETRELER (aiParameters):
   - purchaseIntent: "düşük"/"orta"/"yüksek"
   - priceSensitivity: "düşük"/"orta"/"yüksek"
   - explorationPreference: "güvenli_seçimler"/"kısmi_keşif"/"yeni_deneyimler"
   - socialInfluence: "düşük"/"orta"/"yüksek"
   - lifestylePriority: "konfor"/"stil"/"fonksiyonellik"/"statü"/"sürdürülebilirlik"
   - emotionalState: "sakin"/"heyecanlı"/"motivli"/"stresli"
   - timeConstraint: "acil"/"normal"/"bol_zamanım_var"

6. KİŞİSELLEŞTİRME NOTLARI (personalizationNotes):
   - Özel dikkat edilecek noktalar
   - Kaçınılması gereken yaklaşımlar
   - Güçlü motivasyon tetikleyicileri

YANIT FORMATI (sadece JSON):
{
  "personalityAnalysis": {
    "mainTraits": ["trait1", "trait2", ...],
    "decisionMakingStyle": "açıklama",
    "socialTendency": "açıklama", 
    "riskLevel": "açıklama"
  },
  "shoppingPsychology": {
    "primaryMotivators": ["motivator1", "motivator2", ...],
    "decisionProcess": "açıklama",
    "priceAttitude": "açıklama",
    "qualityExpectation": "açıklama"
  },
  "styleProfile": {
    "coreStyle": "açıklama",
    "colorPreferences": ["color1", "color2", ...],
    "comfortStyleBalance": "açıklama",
    "fashionFollowing": "açıklama"
  },
  "recommendationStrategy": {
    "focusFactors": ["factor1", "factor2", ...],
    "messagingTone": "açıklama",
    "seasonalSensitivity": "açıklama",
    "socialInfluenceLevel": "açıklama"
  },
  "aiParameters": {
    "purchaseIntent": "orta",
    "priceSensitivity": "orta", 
    "explorationPreference": "kısmi_keşif",
    "socialInfluence": "orta",
    "lifestylePriority": "konfor",
    "emotionalState": "sakin",
    "timeConstraint": "normal"
  },
  "personalizationNotes": {
    "strengths": ["strength1", "strength2", ...],
    "avoidances": ["avoid1", "avoid2", ...],
    "triggers": ["trigger1", "trigger2", ...]
  },
  "confidence": 0.85,
  "profileScore": 92
}`,ee=(await O.generateContent($,{temperature:.8,maxOutputTokens:1500})).text.trim().replace(/```json|```/g,""),G=JSON.parse(ee),V=((_=(C=i.user)==null?void 0:C.profile)==null?void 0:_.id)||((L=i.user)==null?void 0:L.id)||((R=i.user)==null?void 0:R.uid)||"anonymous",se=jr(),be={responses:n,analysis:G};try{f&&x?(await se.updateUserProfile(V,{responses:n,analysis:G}),console.log("✅ Profile updated in Firebase")):(await se.saveUserProfile(V,be),console.log("✅ Profile saved to Firebase"))}catch{console.error("❌ Firebase save failed, using localStorage as fallback");const Ye={responses:n,analysis:G,createdAt:new Date().toISOString(),userId:V};localStorage.setItem("userProfile",JSON.stringify(Ye))}u(G),g(!0),E(!1),e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"success",message:"🧠 AI profil analizi tamamlandı! Artık size özel öneriler alabilirsiniz.",duration:6e3}})}catch(O){console.error("❌ Profile analysis failed:",O),e({type:r.ADD_NOTIFICATION,payload:{id:Date.now(),type:"error",message:O.message||"Profil analizi sırasında hata oluştu",duration:5e3}})}finally{c(!1)}},P=C=>{const _=n[C.id];switch(C.type){case"single":return t.jsx("div",{className:"space-y-3",children:C.options.map(L=>t.jsx(m.button,{onClick:()=>D(C.id,L.value),className:`w-full p-4 rounded-xl border-2 transition-all text-left ${_===L.value?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("span",{className:"text-2xl",children:L.emoji}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:L.label}),_===L.value&&t.jsx(m.div,{initial:{scale:0},animate:{scale:1},className:"ml-auto",children:t.jsx(Mt,{className:"w-5 h-5 text-primary-600"})})]})},L.value))});case"multiple":return t.jsx("div",{className:"space-y-3",children:C.options.map(L=>t.jsx(m.button,{onClick:()=>D(C.id,L.value,!0),className:`w-full p-4 rounded-xl border-2 transition-all text-left ${_&&_.includes(L.value)?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("span",{className:"text-2xl",children:L.emoji}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:L.label}),_&&_.includes(L.value)&&t.jsx(m.div,{initial:{scale:0},animate:{scale:1},className:"ml-auto",children:t.jsx(Mt,{className:"w-5 h-5 text-primary-600"})})]})},L.value))});case"scale":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("span",{children:C.scale.minLabel}),t.jsx("span",{children:C.scale.maxLabel})]}),t.jsx("div",{className:"flex justify-between space-x-2",children:Array.from({length:C.scale.max-C.scale.min+1},(L,R)=>t.jsx(m.button,{onClick:()=>D(C.id,R+C.scale.min),className:`flex-1 p-4 rounded-xl border-2 transition-all ${_===R+C.scale.min?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl mb-1",children:C.scale.emoji[R]}),t.jsx("div",{className:"text-sm font-medium",children:R+C.scale.min})]})},R+C.scale.min))})]});default:return null}},N=()=>{E(!0),g(!1),s(0)},S=()=>{E(!1),x?(o(x.responses),u(x.analysis),g(!0)):(o({}),u(null),g(!1),s(0))};if(h&&d&&!f)return t.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[t.jsx(m.div,{className:"mx-auto w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mb-6",initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},children:t.jsx(xe,{className:"w-10 h-10 text-white"})}),t.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:["🎉 ",x?"AI Profil Analiziniz":"AI Profil Analizi Tamamlandı!"]}),t.jsxs("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-2",children:["Profiliniz %",d.profileScore," uyumluluk ile oluşturuldu"]}),x&&t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Son güncelleme: ",new Date(x.updatedAt).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-6",children:t.jsx(m.div,{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full",initial:{width:0},animate:{width:`${d.profileScore}%`},transition:{delay:.5,duration:1.5}})})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(We,{className:"w-6 h-6 text-indigo-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Kişilik Analizi"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Ana Özellikler:"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:d.personalityAnalysis.mainTraits.map((C,_)=>t.jsx("span",{className:"bg-indigo-100 dark:bg-indigo-900/30 text-indigo-800 dark:text-indigo-200 px-2 py-1 rounded text-sm",children:C},_))})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Karar Verme:"}),t.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:d.personalityAnalysis.decisionMakingStyle})]})]})]}),t.jsxs(m.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.4},className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(Vr,{className:"w-6 h-6 text-purple-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Stil Profili"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Ana Stil:"}),t.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:d.styleProfile.coreStyle})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Renk Tercihleri:"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:d.styleProfile.colorPreferences.map((C,_)=>t.jsx("span",{className:"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-200 px-2 py-1 rounded text-sm",children:C},_))})]})]})]}),t.jsxs(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(tt,{className:"w-6 h-6 text-green-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Alışveriş Psikolojisi"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Motivasyonlar:"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:d.shoppingPsychology.primaryMotivators.map((C,_)=>t.jsx("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 px-2 py-1 rounded text-sm",children:C},_))})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Fiyat Yaklaşımı:"}),t.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:d.shoppingPsychology.priceAttitude})]})]})]}),t.jsxs(m.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.6},className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(De,{className:"w-6 h-6 text-yellow-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"AI Parametreleri"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Satın Alma:"}),t.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:d.aiParameters.purchaseIntent})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Fiyat Hassasiyet:"}),t.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:d.aiParameters.priceSensitivity})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Keşif:"}),t.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:d.aiParameters.explorationPreference})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Yaşam Tarzı:"}),t.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:d.aiParameters.lifestylePriority})]})]})]})]}),t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"flex flex-col sm:flex-row gap-4 mt-8 justify-center",children:[x&&t.jsxs(m.button,{onClick:N,className:"inline-flex items-center justify-center space-x-2 bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 text-white px-8 py-4 rounded-xl font-semibold transition-all duration-300",whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(Ke,{className:"w-5 h-5"}),t.jsx("span",{children:"Profili Düzenle"})]}),t.jsxs(m.a,{href:"/recommendations",className:"inline-flex items-center justify-center space-x-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-8 py-4 rounded-xl font-semibold transition-all duration-300",whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(We,{className:"w-5 h-5"}),t.jsx("span",{children:"AI Önerilerimi Gör"})]}),t.jsxs(m.a,{href:"/products",className:"inline-flex items-center justify-center space-x-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 px-8 py-4 rounded-xl font-semibold transition-all duration-300",whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(tt,{className:"w-5 h-5"}),t.jsx("span",{children:"Ürünleri İncele"})]})]}),t.jsx("div",{className:"text-center mt-6",children:t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["💡 ",x?"Profiliniz güncel ve AI önerileriniz kişisel!":"Profiliniz güncellendi ve AI önerileriniz artık daha kişisel olacak!"]})})]});const b=j[a],A=b.icon;return t.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[f&&t.jsx("div",{className:"text-center mb-6",children:t.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[t.jsx(Ke,{className:"w-5 h-5 text-orange-600"}),t.jsx("span",{className:"font-semibold text-orange-800 dark:text-orange-200",children:"Profil Düzenleme Modu"})]}),t.jsx("p",{className:"text-sm text-orange-700 dark:text-orange-300",children:"Mevcut cevaplarınızı değiştirerek profilinizi güncelleyebilirsiniz"}),t.jsx("button",{onClick:S,className:"mt-2 text-sm text-orange-600 hover:text-orange-700 underline",children:"İptal et ve geri dön"})]})}),t.jsxs("div",{className:"text-center mb-8",children:[t.jsx(m.div,{className:`mx-auto w-16 h-16 bg-gradient-to-br ${b.color} rounded-full flex items-center justify-center mb-4`,initial:{scale:0},animate:{scale:1},children:t.jsx(A,{className:"w-8 h-8 text-white"})},a),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"AI Profil Questionnaire"}),t.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 mb-4",children:"Size özel öneriler için kişiliğinizi tanıyalım"}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-2",children:t.jsx(m.div,{className:`bg-gradient-to-r ${b.color} h-2 rounded-full`,initial:{width:0},animate:{width:`${(a+1)/j.length*100}%`},transition:{duration:.5}})}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[a+1," / ",j.length," - ",b.title]})]}),t.jsx(oe,{mode:"wait",children:t.jsx(m.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8",children:t.jsx("div",{className:"space-y-8",children:b.questions.map((C,_)=>t.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:_*.1},className:"space-y-4",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:C.question}),C.type==="multiple"&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Birden fazla seçenek işaretleyebilirsiniz"}),P(C)]},C.id))})},a)}),t.jsxs("div",{className:"flex justify-between items-center mt-8",children:[t.jsxs(m.button,{onClick:w,disabled:a===0,className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",whileHover:{scale:a===0?1:1.05},whileTap:{scale:a===0?1:.95},children:[t.jsx(Ca,{className:"w-5 h-5"}),t.jsx("span",{children:"Önceki"})]}),t.jsx(m.button,{onClick:v,disabled:!I()||l,className:`flex items-center space-x-2 bg-gradient-to-r ${b.color} hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300`,whileHover:{scale:!I()||l?1:1.05},whileTap:{scale:!I()||l?1:.95},children:l?t.jsxs(t.Fragment,{children:[t.jsx(m.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:t.jsx(We,{className:"w-5 h-5"})}),t.jsx("span",{children:"Analiz Ediliyor..."})]}):a===j.length-1?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:f?"Profili Güncelle":"Profili Oluştur"}),t.jsx(xe,{className:"w-5 h-5"})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"Sonraki"}),t.jsx(Xs,{className:"w-5 h-5"})]})})]}),t.jsx("div",{className:"text-center mt-6",children:t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"🤖 Verdiğiniz cevaplar AI tarafından analiz edilecek ve size özel öneriler oluşturulacak"})})]})};class ql{constructor(){this.orders=this.loadOrders()}loadOrders(){try{const e=localStorage.getItem("hackathon2025-orders");return e?JSON.parse(e):[]}catch{return[]}}saveOrders(){try{localStorage.setItem("hackathon2025-orders",JSON.stringify(this.orders))}catch(e){console.error("Error saving orders:",e)}}calculateOrderTotals(e,r,a=null){const s=e.reduce((u,h)=>u+h.price*h.quantity,0);let n=0;a&&this.validateCoupon(a)&&(n=a.type==="percent"?s*a.value/100:Math.min(a.value,s));const o=s-n,l=this.calculateShipping(o,r),c=o*K.TAX_RATE,d=o+l+c;return{subtotal:Math.round(s*100)/100,discount:Math.round(n*100)/100,discountedSubtotal:Math.round(o*100)/100,shipping:Math.round(l*100)/100,tax:Math.round(c*100)/100,total:Math.round(d*100)/100,currency:K.CURRENCY,currencySymbol:K.CURRENCY_SYMBOL}}calculateShipping(e,r){if(e>=K.FREE_SHIPPING_THRESHOLD)return 0;const a={İstanbul:15,Ankara:18,İzmir:20,Bursa:22,Antalya:25,default:30},s=(r==null?void 0:r.city)||"default";return a[s]||a.default}validateCoupon(e){return!(!e||!e.code||e.expiresAt&&new Date(e.expiresAt)<new Date||e.usageLimit&&e.usageCount>=e.usageLimit)}getPaymentMethods(){return[{id:"credit_card",name:"Kredi Kartı",description:"Visa, MasterCard, American Express",icon:"💳",available:!0},{id:"debit_card",name:"Banka Kartı",description:"Türkiye'deki tüm bankalar",icon:"💰",available:!0},{id:"bank_transfer",name:"Havale/EFT",description:"Banka havalesi ile ödeme",icon:"🏦",available:!0},{id:"mobile_payment",name:"Mobil Ödeme",description:"Papara, İninal, BKM Express",icon:"📱",available:!0},{id:"installment",name:"Taksit",description:"2-12 aya varan taksit seçenekleri",icon:"🔄",available:!0}]}getShippingMethods(){return[{id:"standard",name:"Standart Kargo",description:"3-5 iş günü",estimatedDays:"3-5",price:15,icon:"📦"},{id:"express",name:"Hızlı Kargo",description:"1-2 iş günü",estimatedDays:"1-2",price:25,icon:"⚡"},{id:"same_day",name:"Aynı Gün Teslimat",description:"Seçili şehirlerde",estimatedDays:"Aynı gün",price:40,icon:"🚀",availableCities:["İstanbul","Ankara","İzmir"]}]}validateCheckoutData(e){var a;const r={};if(!e.shippingAddress)r.shippingAddress="Teslimat adresi gerekli";else{const s=e.shippingAddress;s.fullName||(r.fullName="Ad soyad gerekli"),s.phone||(r.phone="Telefon numarası gerekli"),s.address||(r.address="Adres gerekli"),s.city||(r.city="Şehir gerekli"),s.postalCode||(r.postalCode="Posta kodu gerekli")}if(e.paymentMethod||(r.paymentMethod="Ödeme yöntemi seçimi gerekli"),["credit_card","debit_card"].includes((a=e.paymentMethod)==null?void 0:a.id))if(!e.cardDetails)r.cardDetails="Kart bilgileri gerekli";else{const s=e.cardDetails;(!s.number||s.number.length<16)&&(r.cardNumber="Geçerli kart numarası gerekli"),s.expiryDate||(r.expiryDate="Son kullanma tarihi gerekli"),(!s.cvv||s.cvv.length<3)&&(r.cvv="CVV kodu gerekli"),s.holderName||(r.holderName="Kart sahibi adı gerekli")}return Object.keys(r).length>0?r:null}async processOrder(e){try{if(this.validateCheckoutData(e))throw new Error("Validation failed");await new Promise(s=>setTimeout(s,2e3));const a={id:`ORD-${Date.now()}`,orderNumber:this.generateOrderNumber(),status:"confirmed",items:e.items,totals:e.totals,shippingAddress:e.shippingAddress,billingAddress:e.billingAddress||e.shippingAddress,paymentMethod:e.paymentMethod,shippingMethod:e.shippingMethod,customerNotes:e.customerNotes||"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),estimatedDelivery:this.calculateEstimatedDelivery(e.shippingMethod),trackingNumber:this.generateTrackingNumber(),timeline:[{status:"confirmed",message:"Siparişiniz alındı ve onaylandı",timestamp:new Date().toISOString()}]};return this.orders.unshift(a),this.saveOrders(),{success:!0,order:a,message:"Siparişiniz başarıyla oluşturuldu!"}}catch(r){return console.error("Order processing error:",r),{success:!1,error:r.message||"Sipariş işlenirken bir hata oluştu"}}}generateOrderNumber(){const e=Date.now().toString(),r=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`2025${e.slice(-6)}${r}`}generateTrackingNumber(){const e="HKT",r=Math.floor(Math.random()*1e9).toString().padStart(9,"0");return`${e}${r}`}calculateEstimatedDelivery(e){const r=new Date;let a=5;switch(e==null?void 0:e.id){case"same_day":a=0;break;case"express":a=2;break;case"standard":a=5;break}const s=new Date(r);return s.setDate(r.getDate()+a),s.toISOString()}getUserOrders(e=10){return this.orders.slice(0,e)}getOrderById(e){return this.orders.find(r=>r.id===e)}updateOrderStatus(e,r,a){const s=this.getOrderById(e);return s?(s.status=r,s.updatedAt=new Date().toISOString(),s.timeline.push({status:r,message:a||this.getStatusMessage(r),timestamp:new Date().toISOString()}),this.saveOrders(),!0):!1}getStatusMessage(e){return{confirmed:"Siparişiniz onaylandı",processing:"Siparişiniz hazırlanıyor",shipped:"Siparişiniz kargoya verildi",delivered:"Siparişiniz teslim edildi",cancelled:"Siparişiniz iptal edildi"}[e]||"Sipariş durumu güncellendi"}getAvailableCoupons(){return[{code:"WELCOME10",type:"percent",value:10,description:"%10 hoş geldin indirimi",minAmount:100,expiresAt:new Date(Date.now()+30*24*60*60*1e3).toISOString()},{code:"FREESHIP",type:"shipping",value:0,description:"Ücretsiz kargo",minAmount:200,expiresAt:new Date(Date.now()+15*24*60*60*1e3).toISOString()},{code:"SAVE50",type:"amount",value:50,description:"50₺ indirim",minAmount:300,expiresAt:new Date(Date.now()+7*24*60*60*1e3).toISOString()}]}}const xt=new ql,va=()=>{const{state:i,dispatch:e,actionTypes:r}=ae(),{notifications:a}=i,s=l=>{e({type:r.REMOVE_NOTIFICATION,payload:l})},n=l=>{switch(l){case Ce.SUCCESS:return dt;case Ce.ERROR:return br;case Ce.WARNING:return Ct;case Ce.INFO:return Yr;default:return Yr}},o=l=>{switch(l){case Ce.SUCCESS:return{container:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",icon:"text-green-400",title:"text-green-800 dark:text-green-200",message:"text-green-600 dark:text-green-300",button:"text-green-500 hover:text-green-600 dark:text-green-400 dark:hover:text-green-300"};case Ce.ERROR:return{container:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",icon:"text-red-400",title:"text-red-800 dark:text-red-200",message:"text-red-600 dark:text-red-300",button:"text-red-500 hover:text-red-600 dark:text-red-400 dark:hover:text-red-300"};case Ce.WARNING:return{container:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",icon:"text-yellow-400",title:"text-yellow-800 dark:text-yellow-200",message:"text-yellow-600 dark:text-yellow-300",button:"text-yellow-500 hover:text-yellow-600 dark:text-yellow-400 dark:hover:text-yellow-300"};case Ce.INFO:default:return{container:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",icon:"text-blue-400",title:"text-blue-800 dark:text-blue-200",message:"text-blue-600 dark:text-blue-300",button:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300"}}};return a.length===0?null:t.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-4 max-w-sm w-full",children:a.map(l=>{const c=n(l.type),d=o(l.type);return t.jsx(Vl,{notification:l,Icon:c,styles:d,onRemove:s},l.id)})})},Vl=({notification:i,Icon:e,styles:r,onRemove:a})=>{const{id:s,title:n,message:o,type:l,duration:c=5e3,persistent:d=!1}=i;return p.useEffect(()=>{if(!d&&c>0){const u=setTimeout(()=>{a(s)},c);return()=>clearTimeout(u)}},[s,c,d,a]),t.jsx("div",{className:`border rounded-lg p-4 shadow-lg backdrop-blur-sm transition-all duration-300 animate-slide-in-right ${r.container}`,children:t.jsxs("div",{className:"flex items-start",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(e,{className:`h-5 w-5 ${r.icon}`})}),t.jsxs("div",{className:"ml-3 flex-1",children:[n&&t.jsx("h3",{className:`text-sm font-medium ${r.title}`,children:n}),o&&t.jsx("p",{className:`text-sm ${n?"mt-1":""} ${r.message}`,children:o})]}),t.jsx("div",{className:"flex-shrink-0 ml-4",children:t.jsx("button",{onClick:()=>a(s),className:`inline-flex rounded-md p-1.5 transition-colors duration-200 ${r.button}`,children:t.jsx(Ar,{className:"h-4 w-4"})})})]})})},Yl=()=>{const{dispatch:i,actionTypes:e}=ae(),r=c=>{const d=Date.now().toString();return i({type:e.ADD_NOTIFICATION,payload:{id:d,...c,timestamp:new Date().toISOString()}}),d};return{addNotification:r,removeNotification:c=>{i({type:e.REMOVE_NOTIFICATION,payload:c})},success:(c,d,u={})=>r({type:Ce.SUCCESS,title:c,message:d,...u}),error:(c,d,u={})=>r({type:Ce.ERROR,title:c,message:d,persistent:!0,...u}),warning:(c,d,u={})=>r({type:Ce.WARNING,title:c,message:d,...u}),info:(c,d,u={})=>r({type:Ce.INFO,title:c,message:d,...u})}},Wl={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},yr={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}},Jl=()=>{var Ye;const{state:i,dispatch:e,actionTypes:r}=ae(),a=Ht(),s=Yl(),[n,o]=p.useState(1),[l,c]=p.useState(!1),[d,u]=p.useState(null),[h,g]=p.useState({fullName:"",phone:"",email:"",address:"",city:"",district:"",postalCode:"",notes:""}),[x,k]=p.useState(null),[f,E]=p.useState(!0),[j,T]=p.useState(null),[D,I]=p.useState(null),[v,w]=p.useState({number:"",holderName:"",expiryDate:"",cvv:""}),[y,P]=p.useState(null),[N,S]=p.useState(""),[b,A]=p.useState(null),[C,_]=p.useState([]),[L,R]=p.useState([]),[O,$]=p.useState({}),W=((Ye=i.cart)==null?void 0:Ye.items)||[];p.useEffect(()=>{if(W.length===0){a("/cart");return}_(xt.getPaymentMethods()),R(xt.getShippingMethods());const M=xt.getShippingMethods()[0];I(M)},[W.length,a]),p.useEffect(()=>{if(W.length>0){const M=xt.calculateOrderTotals(W,h,y);A(M)}},[W,h,y]);const ee=(M,X)=>{g(Ne=>({...Ne,[M]:X})),O[M]&&$(Ne=>({...Ne,[M]:null}))},G=(M,X)=>{w(Ne=>({...Ne,[M]:X})),O[M]&&$(Ne=>({...Ne,[M]:null}))},V=M=>{const X={};return M>=1&&(h.fullName||(X.fullName="Ad soyad gerekli"),h.phone||(X.phone="Telefon gerekli"),h.email||(X.email="E-posta gerekli"),h.address||(X.address="Adres gerekli"),h.city||(X.city="Şehir gerekli"),h.postalCode||(X.postalCode="Posta kodu gerekli")),M>=2&&(D||(X.shippingMethod="Kargo seçimi gerekli")),M>=3&&(j||(X.paymentMethod="Ödeme yöntemi seçimi gerekli"),["credit_card","debit_card"].includes(j==null?void 0:j.id)&&(v.number||(X.cardNumber="Kart numarası gerekli"),v.holderName||(X.holderName="Kart sahibi adı gerekli"),v.expiryDate||(X.expiryDate="Son kullanma tarihi gerekli"),v.cvv||(X.cvv="CVV gerekli"))),$(X),Object.keys(X).length===0},se=()=>{V(n)&&o(M=>Math.min(M+1,4))},be=()=>{o(M=>Math.max(M-1,1))},ue=async()=>{if(!V(3))return;c(!0);const M={items:W,totals:b,shippingAddress:h,billingAddress:f?h:x,paymentMethod:j,shippingMethod:D,cardDetails:["credit_card","debit_card"].includes(j==null?void 0:j.id)?v:null,customerNotes:N,appliedCoupon:y};try{const X=await xt.processOrder(M);X.success?(u(X),o(4),e({type:r.CLEAR_CART}),e({type:r.ADD_ORDER,payload:X.order}),s.success("Sipariş Başarılı","Siparişiniz başarıyla oluşturuldu!")):s.error("Sipariş Hatası",X.error)}catch(X){console.error("Checkout error:",X),s.error("Hata","Sipariş işlenirken bir hata oluştu.")}finally{c(!1)}};return W.length===0?t.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-16 text-center",children:[t.jsx(rt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Sepetiniz Boş"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Checkout yapabilmek için önce sepete ürün eklemelisiniz."}),t.jsx(ie,{to:"/products",className:"inline-flex items-center px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Alışverişe Başla"})]}):t.jsxs(m.div,{className:"max-w-6xl mx-auto px-4 py-8",variants:Wl,initial:"hidden",animate:"visible",children:[t.jsxs(m.div,{className:"flex items-center justify-between mb-8",variants:yr,children:[t.jsx("div",{className:"flex items-center space-x-4",children:t.jsxs(ie,{to:"/cart",className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:[t.jsx(Ea,{className:"w-5 h-5"}),t.jsx("span",{children:"Sepete Dön"})]})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Checkout"})]}),t.jsx(m.div,{className:"mb-8",variants:yr,children:t.jsx("div",{className:"flex items-center justify-center space-x-8",children:[{step:1,title:"Teslimat",icon:Zs},{step:2,title:"Kargo",icon:Ra},{step:3,title:"Ödeme",icon:Pa},{step:4,title:"Onay",icon:dt}].map(({step:M,title:X,icon:Ne})=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 transition-all duration-300 ${n>=M?"bg-primary-600 border-primary-600 text-white":"border-gray-300 dark:border-gray-600 text-gray-400"}`,children:n>M?t.jsx(dt,{className:"w-5 h-5"}):t.jsx(Ne,{className:"w-5 h-5"})}),t.jsx("span",{className:`font-medium ${n>=M?"text-primary-600 dark:text-primary-400":"text-gray-400"}`,children:X})]},M))})}),t.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsxs(oe,{mode:"wait",children:[n===1&&t.jsxs(m.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-3xl p-8 border border-gray-200/50 dark:border-gray-700/50 shadow-lg",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Teslimat Adresi"}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ad Soyad *"}),t.jsx("input",{type:"text",value:h.fullName,onChange:M=>ee("fullName",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.fullName?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"Ad Soyad"}),O.fullName&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.fullName})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Telefon *"}),t.jsx("input",{type:"tel",value:h.phone,onChange:M=>ee("phone",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.phone?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"0532 123 45 67"}),O.phone&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.phone})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"E-posta *"}),t.jsx("input",{type:"email",value:h.email,onChange:M=>ee("email",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.email?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"ornek@email.com"}),O.email&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.email})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adres *"}),t.jsx("textarea",{value:h.address,onChange:M=>ee("address",M.target.value),rows:3,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.address?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"Mahalle, sokak, bina no, daire no"}),O.address&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.address})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Şehir *"}),t.jsxs("select",{value:h.city,onChange:M=>ee("city",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.city?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,children:[t.jsx("option",{value:"",children:"Şehir Seçin"}),t.jsx("option",{value:"İstanbul",children:"İstanbul"}),t.jsx("option",{value:"Ankara",children:"Ankara"}),t.jsx("option",{value:"İzmir",children:"İzmir"}),t.jsx("option",{value:"Bursa",children:"Bursa"}),t.jsx("option",{value:"Antalya",children:"Antalya"}),t.jsx("option",{value:"Adana",children:"Adana"}),t.jsx("option",{value:"Konya",children:"Konya"}),t.jsx("option",{value:"Gaziantep",children:"Gaziantep"}),t.jsx("option",{value:"Other",children:"Diğer"})]}),O.city&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.city})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Posta Kodu *"}),t.jsx("input",{type:"text",value:h.postalCode,onChange:M=>ee("postalCode",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.postalCode?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"34000"}),O.postalCode&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.postalCode})]})]}),t.jsx("div",{className:"mt-8 flex justify-end",children:t.jsx(m.button,{onClick:se,className:"px-8 py-3 bg-primary-600 text-white rounded-xl hover:bg-primary-700 transition-colors font-semibold",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Devam Et"})})]},"step1"),n===2&&t.jsxs(m.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-3xl p-8 border border-gray-200/50 dark:border-gray-700/50 shadow-lg",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Kargo Seçenekleri"}),t.jsx("div",{className:"space-y-4",children:L.map(M=>t.jsx(m.div,{className:`p-6 border-2 rounded-2xl cursor-pointer transition-all ${(D==null?void 0:D.id)===M.id?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-600 hover:border-primary-300"}`,onClick:()=>I(M),whileHover:{scale:1.01},whileTap:{scale:.99},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"text-3xl",children:M.icon}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:M.name}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:M.description}),t.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[t.jsx(Bt,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-500",children:M.estimatedDays})]})]})]}),t.jsx("div",{className:"text-right",children:t.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:M.price===0?"Ücretsiz":`${M.price}₺`})})]})},M.id))}),t.jsxs("div",{className:"mt-8 flex justify-between",children:[t.jsx(m.button,{onClick:be,className:"px-8 py-3 border border-gray-300 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Geri"}),t.jsx(m.button,{onClick:se,className:"px-8 py-3 bg-primary-600 text-white rounded-xl hover:bg-primary-700 transition-colors font-semibold",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Devam Et"})]})]},"step2"),n===3&&t.jsxs(m.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-3xl p-8 border border-gray-200/50 dark:border-gray-700/50 shadow-lg",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Ödeme Yöntemi"}),t.jsx("div",{className:"space-y-4 mb-8",children:C.map(M=>t.jsx(m.div,{className:`p-6 border-2 rounded-2xl cursor-pointer transition-all ${(j==null?void 0:j.id)===M.id?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-600 hover:border-primary-300"}`,onClick:()=>T(M),whileHover:{scale:1.01},whileTap:{scale:.99},children:t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"text-2xl",children:M.icon}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:M.name}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:M.description})]})]})},M.id))}),["credit_card","debit_card"].includes(j==null?void 0:j.id)&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-2xl p-6 mb-8",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Kart Bilgileri"}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Kart Numarası *"}),t.jsx("input",{type:"text",value:v.number,onChange:M=>G("number",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.cardNumber?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"1234 5678 9012 3456",maxLength:19}),O.cardNumber&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.cardNumber})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Kart Sahibi Adı *"}),t.jsx("input",{type:"text",value:v.holderName,onChange:M=>G("holderName",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.holderName?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"JOHN DOE"}),O.holderName&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.holderName})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Son Kullanma Tarihi *"}),t.jsx("input",{type:"text",value:v.expiryDate,onChange:M=>G("expiryDate",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.expiryDate?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"MM/YY",maxLength:5}),O.expiryDate&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.expiryDate})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"CVV *"}),t.jsx("input",{type:"text",value:v.cvv,onChange:M=>G("cvv",M.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all ${O.cvv?"border-red-500":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"123",maxLength:4}),O.cvv&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:O.cvv})]})]})]}),t.jsxs("div",{className:"mt-8 flex justify-between",children:[t.jsx(m.button,{onClick:be,className:"px-8 py-3 border border-gray-300 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Geri"}),t.jsx(m.button,{onClick:ue,disabled:l,className:"px-8 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors font-semibold flex items-center space-x-2 disabled:opacity-50",whileHover:{scale:l?1:1.02},whileTap:{scale:l?1:.98},children:l?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),t.jsx("span",{children:"İşleniyor..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(Wr,{className:"w-5 h-5"}),t.jsx("span",{children:"Siparişi Tamamla"})]})})]})]},"step3"),n===4&&d&&t.jsxs(m.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-3xl p-8 border border-gray-200/50 dark:border-gray-700/50 shadow-lg text-center",children:[t.jsx(m.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-6",children:t.jsx(dt,{className:"w-12 h-12 text-green-600"})}),t.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"Siparişiniz Alındı!"}),t.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-8",children:"Teşekkür ederiz! Siparişiniz başarıyla oluşturuldu."}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-2xl p-6 mb-8",children:t.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-left",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Sipariş Detayları"}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Sipariş No: ",t.jsx("span",{className:"font-mono",children:d.order.orderNumber})]}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Takip No: ",t.jsx("span",{className:"font-mono",children:d.order.trackingNumber})]}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Durum: ",t.jsx("span",{className:"text-green-600 font-semibold",children:"Onaylandı"})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Teslimat Bilgileri"}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Tahmini Teslimat: ",new Date(d.order.estimatedDelivery).toLocaleDateString("tr-TR")]}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Kargo: ",D==null?void 0:D.name]})]})]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[t.jsx(m.button,{onClick:()=>a("/orders"),className:"px-6 py-3 bg-primary-600 text-white rounded-xl hover:bg-primary-700 transition-colors font-semibold",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Siparişlerimi Görüntüle"}),t.jsx(m.button,{onClick:()=>a("/products"),className:"px-6 py-3 border border-gray-300 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Alışverişe Devam Et"})]})]},"step4")]})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsxs(m.div,{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-3xl p-6 border border-gray-200/50 dark:border-gray-700/50 shadow-lg sticky top-8",variants:yr,children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6",children:"Sipariş Özeti"}),t.jsx("div",{className:"space-y-4 mb-6",children:W.map(M=>t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("img",{src:M.image,alt:M.name,className:"w-12 h-12 object-cover rounded-lg"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:M.name}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Adet: ",M.quantity]})]}),t.jsx("div",{className:"text-right",children:t.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[(M.price*M.quantity).toFixed(2),"₺"]})})]},`${M.productId}-${M.variantId||""}`))}),b&&t.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-600 pt-6 space-y-3",children:[t.jsxs("div",{className:"flex justify-between text-gray-600 dark:text-gray-400",children:[t.jsx("span",{children:"Ara Toplam"}),t.jsxs("span",{children:[b.subtotal.toFixed(2),"₺"]})]}),b.discount>0&&t.jsxs("div",{className:"flex justify-between text-green-600",children:[t.jsx("span",{children:"İndirim"}),t.jsxs("span",{children:["-",b.discount.toFixed(2),"₺"]})]}),t.jsxs("div",{className:"flex justify-between text-gray-600 dark:text-gray-400",children:[t.jsx("span",{children:"Kargo"}),t.jsx("span",{children:b.shipping===0?"Ücretsiz":`${b.shipping.toFixed(2)}₺`})]}),t.jsxs("div",{className:"flex justify-between text-gray-600 dark:text-gray-400",children:[t.jsx("span",{children:"KDV"}),t.jsxs("span",{children:[b.tax.toFixed(2),"₺"]})]}),t.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900 dark:text-white border-t border-gray-200 dark:border-gray-600 pt-3",children:[t.jsx("span",{children:"Toplam"}),t.jsxs("span",{children:[b.total.toFixed(2),"₺"]})]})]}),t.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-2 text-gray-500 dark:text-gray-400",children:[t.jsx(Wr,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm",children:"256-bit SSL ile güvenli ödeme"})]})]})})]})]})},Ql=()=>t.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs(m.div,{className:"text-center py-16",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[t.jsx(m.div,{className:"mx-auto flex items-center justify-center h-24 w-24 rounded-full bg-gradient-to-br from-orange-500 to-red-500 mb-8",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:t.jsx(ei,{className:"h-12 w-12 text-white"})}),t.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Kayıt Ol"}),t.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-8",children:"Kullanıcı kayıt sistemi yakında aktif olacak"}),t.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-2xl p-8",children:[t.jsx(qe,{className:"w-12 h-12 text-orange-600 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Phase 3'te Geliyor"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Üyelik sistemi ile kişiselleştirilmiş deneyim yaşayabileceksiniz."})]})]})});class Xl{constructor(){this.geminiService=Ve(),this.processedCount=0,this.totalCount=0}async upgradeAllReviews(e){if(!e)throw new Error("Gemini API key gerekli");this.geminiService.setApiKey(e),console.log("🚀 Yorum yükseltme sistemi başlatılıyor...");try{const r=Z(F,"reviews"),a=await ne(r);if(this.totalCount=a.size,console.log(`📊 Toplam ${this.totalCount} yorum bulundu`),this.totalCount===0)return{success:!1,message:"Yorum bulunamadı"};const s=[];for(const n of a.docs){const o=n.data();if(o.enhanced||o.comment.length>200){console.log(`⏭️ Yorum zaten enhanced edilmiş: ${n.id}`);continue}try{const l=await this.enhanceReview(o,n.id);s.push({id:n.id,success:!0,enhancedReview:l}),this.processedCount++,console.log(`✅ İlerleme: ${this.processedCount}/${this.totalCount} - ${n.id}`),await this.delay(1e3)}catch(l){console.error(`❌ Yorum geliştirme hatası ${n.id}:`,l),s.push({id:n.id,success:!1,error:l.message})}}return console.log("🎉 Yorum yükseltme tamamlandı!"),{success:!0,processedCount:this.processedCount,totalCount:this.totalCount,results:s}}catch(r){throw console.error("❌ Yorum yükseltme sistemi hatası:",r),r}}async enhanceReview(e,r){const{productId:a,rating:s,comment:n,userName:o}=e;console.log(`🧠 Yorum geliştiriliyor: ${r} - Product: ${a}`);const l=this.determineProductCategory(a),c=this.buildEnhancementPrompt(n,s,l,o);try{const d=await this.geminiService.generateContent(c,{temperature:.8,maxOutputTokens:600}),u=this.parseEnhancedReview(d.text),h=re(F,"reviews",r),g={comment:u.comment,pros:u.props,cons:u.cons,usageContext:u.usageContext,recommendation:u.recommendation,enhanced:!0,enhancedAt:te(),originalComment:n,detailLevel:"comprehensive"};return await Re(h,g),console.log(`✅ Yorum başarıyla güncellendi: ${r}`),g}catch(d){throw console.error(`❌ AI geliştirme hatası ${r}:`,d),d}}buildEnhancementPrompt(e,r,a,s){const n=this.getCategorySpecifications(a);return`Sen deneyimli bir ürün değerlendirmecisisin. Kısa bir ürün yorumunu detaylı ve açıklayıcı hale getir.

MEVCUT YORUM:
- Kullanıcı: ${s}
- Rating: ${r}/5
- Yorum: "${e}"
- Kategori: ${a}

KATEGORI ÖZELLİKLERİ:
${n}

GÖREV:
Bu kısa yorumu gerçekçi, detaylı ve faydalı bir değerlendirmeye dönüştür. Kullanıcının gerçek deneyimini yansıtan spesifik detaylar ekle.

YORUM GELIŞTİRME KURALLARI:
1. Orijinal rating'i koru (${r}/5)
2. Kullanıcının sesini ve tarzını koru
3. Spesifik avantaj ve dezavantajlar ekle
4. Kullanım senaryoları ve deneyimler ekle
5. Karşılaştırmalar ve alternatif öneriler ekle
6. Gerçekçi detaylar ekle (fiyat, dayanıklılık, kullanım süresi vb.)
7. Türkçe olarak yaz, doğal konuşma dili kullan

YANIT FORMATI (JSON):
{
  "comment": "Detaylı ve açıklayıcı yorum (300-500 karakter)",
  "pros": ["Avantaj 1", "Avantaj 2", "Avantaj 3"],
  "cons": ["Dezavantaj 1", "Dezavantaj 2"],
  "usageContext": "Hangi durumda/nasıl kullandığı",
  "recommendation": "Kime önerir, hangi koşullarda"
}

ÖRNEKLER:
"Güzel ürün" → "3 aydır kullanıyorum, günlük işlerimi çok kolaylaştırdı. Kalitesi beklentimin üstünde, özellikle dayanıklılığı etkileyici. Kurulumu kolay, 10 dakikada hallettim. Tek eksi yanı enerji tüketiminin biraz yüksek olması. Benzer fiyat aralığındaki alternatiflere göre çok daha iyi performans veriyor."

Sadece JSON formatında yanıt ver, başka açıklama ekleme.`}getCategorySpecifications(e){const r={electronics:`
Elektronik ürünler için değerlendirme kriterleri:
- Performans ve hız
- Batarya ömrü
- Build quality ve tasarım
- Kullanım kolaylığı
- Garanti ve servis
- Fiyat/performans oranı
- Enerji tüketimi
- Compatibility ve entegrasyon`,clothing:`
Giyim ürünleri için değerlendirme kriterleri:
- Kumaş kalitesi ve rahatlık
- Kesim ve beden uyumu
- Renk haslığı ve dayanıklılık
- Yıkama ve bakım kolaylığı
- Tasarım ve stil
- Mevsimlik uygunluk
- Combinlenebilirlik
- Fiyat değer dengesi`,shoes:`
Ayakkabı ürünleri için değerlendirme kriterleri:
- Konfor ve ergonomi
- Malzeme kalitesi
- Dayanıklılık ve aşınma
- Nefes alabilirlik
- Taban kalitesi ve grip
- Beden uyumu
- Stil ve görünüm
- Farklı kullanım alanları`,books:`
Kitap ürünleri için değerlendirme kriterleri:
- İçerik kalitesi ve derinlik
- Anlatım tarzı ve akıcılık
- Öğretici değer
- Çeviri kalitesi (varsa)
- Hedef kitle uygunluğu
- Pratik uygulanabilirlik
- Referans değeri
- Sayfa sayısı ve fiyat`,home:`
Ev eşyaları için değerlendirme kriterleri:
- Fonksiyonellik ve kullanışlılık
- Malzeme kalitesi
- Montaj ve kurulum
- Alan verimliliği
- Bakım ve temizlik kolaylığı
- Tasarım ve estetik
- Dayanıklılık
- Garanti ve servis`,sports:`
Spor ürünleri için değerlendirme kriterleri:
- Performans artışı
- Ergonomi ve konfor
- Malzeme kalitesi
- Güvenlik özellikleri
- Dayanıklılık
- Bakım gereksinimleri
- Farklı aktivitelerde kullanım
- Taşınabilirlik`};return r[e]||r.electronics}determineProductCategory(e){return e<=10?"electronics":e<=15?"clothing":e<=20?"shoes":e<=25?"books":e<=30?"home":"sports"}parseEnhancedReview(e){try{const r=e.trim().replace(/```json|```/g,""),a=JSON.parse(r);return{comment:a.comment||"Yorum geliştirilemedi",props:a.pros||[],cons:a.cons||[],usageContext:a.usageContext||"",recommendation:a.recommendation||""}}catch(r){return console.error("❌ AI yanıt parse hatası:",r),{comment:"Yorum geliştirme sırasında hata oluştu",props:[],cons:[],usageContext:"",recommendation:""}}}delay(e){return new Promise(r=>setTimeout(r,e))}async upgradeProductReviews(e,r){if(!r)throw new Error("Gemini API key gerekli");this.geminiService.setApiKey(r);try{const a=J(Z(F,"reviews"),H("productId","==",e)),s=await ne(a);console.log(`📊 Ürün ${e} için ${s.size} yorum bulundu`);const n=s.docs.sort((l,c)=>{var h,g,x,k;const d=((g=(h=l.data().createdAt)==null?void 0:h.toDate)==null?void 0:g.call(h))||new Date(l.data().date);return(((k=(x=c.data().createdAt)==null?void 0:x.toDate)==null?void 0:k.call(x))||new Date(c.data().date))-d}),o=[];for(const l of n){const c=l.data();if(c.enhanced){console.log(`⏭️ Yorum zaten enhanced: ${l.id}`);continue}try{const d=await this.enhanceReview(c,l.id);o.push({id:l.id,success:!0,enhancedReview:d}),await this.delay(1e3)}catch(d){o.push({id:l.id,success:!1,error:d.message})}}return{success:!0,results:o}}catch(a){throw console.error(`❌ Ürün ${e} yorum güncelleme hatası:`,a),a}}async getReviewStats(){try{const r=(await ne(Z(F,"reviews"))).docs.map(o=>o.data()),a=r.length,s=r.filter(o=>o.enhanced).length,n={};return r.forEach(o=>{n[o.rating]=(n[o.rating]||0)+1}),{total:a,enhanced:s,needsUpgrade:a-s,enhancementRate:a>0?(s/a*100).toFixed(2):0,ratingDistribution:n}}catch(e){throw console.error("❌ İstatistik alma hatası:",e),e}}}let xr=null;function $r(){return xr||(xr=new Xl),xr}async function Zl(i){return await $r().upgradeAllReviews(i)}async function ec(i,e){return await $r().upgradeProductReviews(i,e)}async function tc(){return await $r().getReviewStats()}const rc=()=>{const[i,e]=p.useState(null),[r,a]=p.useState(!1),[s,n]=p.useState(""),[o,l]=p.useState(null),[c,d]=p.useState(""),[u,h]=p.useState([]);p.useEffect(()=>{g();const T="AIzaSyBn6qmXw-qH5mwPrrH9JnJ-Kp18qxwlxSk";localStorage.getItem("gemini_api_key"),n(T)},[]);const g=async()=>{try{const T=await tc();e(T)}catch(T){console.error("İstatistik yükleme hatası:",T),x("error","İstatistikler yüklenemedi: "+T.message)}},x=(T,D)=>{const I={id:Date.now(),type:T,message:D,timestamp:new Date().toLocaleTimeString("tr-TR")};h(v=>[I,...v.slice(0,49)])},k=async()=>{if(!s.trim()){alert("Lütfen Gemini API key girin");return}if(confirm("Tüm yorumları geliştirmek istediğinizden emin misiniz? Bu işlem uzun sürebilir.")){a(!0),l({current:0,total:(i==null?void 0:i.needsUpgrade)||0});try{localStorage.setItem("gemini_api_key",s),x("info","Tüm yorumlar geliştiriliyor...");const T=await Zl(s);T.success?(x("success",`✅ ${T.processedCount}/${T.totalCount} yorum başarıyla geliştirildi`),await g()):x("error","Yorum geliştirme başarısız: "+T.message)}catch(T){console.error("Yorum geliştirme hatası:",T),x("error","Hata: "+T.message)}finally{a(!1),l(null)}}},f=async()=>{if(!s.trim()){alert("Lütfen Gemini API key girin");return}if(!c){alert("Lütfen bir ürün ID girin");return}a(!0);try{x("info",`Ürün ${c} yorumları geliştiriliyor...`);const T=await ec(parseInt(c),s);if(T.success){const D=T.results.filter(I=>I.success).length;x("success",`✅ Ürün ${c}: ${D} yorum geliştirildi`),await g()}else x("error",`Ürün ${c} yorum geliştirme başarısız`)}catch(T){console.error("Product yorum geliştirme hatası:",T),x("error","Hata: "+T.message)}finally{a(!1)}},E=()=>{const T=u.map(w=>({time:w.timestamp,type:w.type,message:w.message})),D=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),I=URL.createObjectURL(D),v=document.createElement("a");v.href=I,v.download=`review-management-logs-${new Date().toISOString().split("T")[0]}.json`,v.click(),URL.revokeObjectURL(I)},j=T=>{switch(T){case"success":return t.jsx(ai,{className:"w-4 h-4 text-green-500"});case"error":return t.jsx(br,{className:"w-4 h-4 text-red-500"});case"warning":return t.jsx(br,{className:"w-4 h-4 text-yellow-500"});case"info":default:return t.jsx(Jr,{className:"w-4 h-4 text-blue-500"})}};return t.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center space-x-3",children:[t.jsx(ti,{className:"w-8 h-8 text-primary-600"}),t.jsx("span",{children:"Yorum Yönetim Paneli"})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Firebase'teki yorumları AI ile geliştirin ve yönetin"})]}),t.jsx("div",{className:"flex items-center space-x-2",children:t.jsxs("button",{onClick:g,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors flex items-center space-x-2",children:[t.jsx(Qe,{className:"w-4 h-4"}),t.jsx("span",{children:"Yenile"})]})})]})}),i&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Toplam Yorum"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:i.total})]}),t.jsx(Jr,{className:"w-8 h-8 text-blue-500"})]})}),t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Geliştirilmiş"}),t.jsx("p",{className:"text-3xl font-bold text-green-600",children:i.enhanced})]}),t.jsx(qe,{className:"w-8 h-8 text-green-500"})]})}),t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Geliştirilmeli"}),t.jsx("p",{className:"text-3xl font-bold text-orange-600",children:i.needsUpgrade})]}),t.jsx(Bt,{className:"w-8 h-8 text-orange-500"})]})}),t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Geliştirme Oranı"}),t.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[i.enhancementRate,"%"]})]}),t.jsx(Er,{className:"w-8 h-8 text-purple-500"})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"API Yapılandırması"}),t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Gemini API Key"}),t.jsx("input",{type:"password",value:s,onChange:T=>n(T.target.value),placeholder:"AIzaSy...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"API key güvenli şekilde saklanır ve sadece AI işlemleri için kullanılır"})]})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Toplu İşlemler"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("button",{onClick:k,disabled:r||!s.trim(),className:"w-full px-4 py-3 bg-primary-600 hover:bg-primary-700 disabled:bg-gray-400 text-white rounded-lg transition-colors flex items-center justify-center space-x-2 font-medium",children:r?t.jsxs(t.Fragment,{children:[t.jsx(Qe,{className:"w-5 h-5 animate-spin"}),t.jsx("span",{children:"İşlem Yapılıyor..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(qe,{className:"w-5 h-5"}),t.jsx("span",{children:"Tüm Yorumları Geliştir"})]})}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("input",{type:"number",value:c,onChange:T=>d(T.target.value),placeholder:"Ürün ID",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),t.jsxs("button",{onClick:f,disabled:r||!s.trim(),className:"px-4 py-2 bg-secondary-600 hover:bg-secondary-700 disabled:bg-gray-400 text-white rounded-lg transition-colors flex items-center space-x-2",children:[t.jsx(Oa,{className:"w-4 h-4"}),t.jsx("span",{children:"Geliştir"})]})]})]})]})]}),o&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"İşlem İlerlemesi"}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${o.total>0?o.current/o.total*100:0}%`}})}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:[o.current," / ",o.total," yorum işlendi"]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Aktivite Logları"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:E,className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded text-sm transition-colors flex items-center space-x-1",children:[t.jsx(ri,{className:"w-3 h-3"}),t.jsx("span",{children:"Dışa Aktar"})]}),t.jsx("button",{onClick:()=>h([]),className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded text-sm transition-colors",children:"Temizle"})]})]}),t.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:u.length===0?t.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"Henüz log kaydı bulunmuyor"}):u.map(T=>t.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[j(T.type),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:T.message}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:T.timestamp})]})]},T.id))})]}),i&&i.ratingDistribution&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Puan Dağılımı"}),t.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(T=>{const D=i.ratingDistribution[T]||0,I=i.total>0?D/i.total*100:0;return t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"flex items-center space-x-1 w-16",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:T}),t.jsx(De,{className:"w-4 h-4 text-yellow-400 fill-current"})]}),t.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:"bg-yellow-400 h-2 rounded-full transition-all duration-300",style:{width:`${I}%`}})}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 w-12 text-right",children:D}),t.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-500 w-12 text-right",children:[I.toFixed(1),"%"]})]},T)})})]})]})},vs=({size:i="medium",text:e="",variant:r="primary",className:a="",showText:s=!0})=>{const{state:n}=ae(),{isDarkMode:o}=n,l={small:"w-4 h-4",medium:"w-6 h-6",large:"w-8 h-8",xlarge:"w-12 h-12"},c={primary:"text-primary-600",secondary:"text-secondary-600",white:"text-white",gray:"text-gray-600",success:"text-success-600",warning:"text-warning-600",error:"text-error-600"},d={small:"text-xs",medium:"text-sm",large:"text-base",xlarge:"text-lg"};return t.jsxs("div",{className:`flex items-center justify-center space-x-2 ${a}`,children:[t.jsx(si,{className:`${l[i]} ${c[r]} animate-spin`}),s&&e&&t.jsx("span",{className:`${d[i]} ${c[r]} font-medium`,children:e})]})},ac={initial:{opacity:0,x:-20,scale:.98},in:{opacity:1,x:0,scale:1},out:{opacity:0,x:20,scale:.98}},sc={type:"tween",ease:"anticipate",duration:.4},ke=({children:i})=>{const{isAuthenticated:e}=Et(),r=gt();return e?i:t.jsx(Tr,{to:"/login",state:{from:r},replace:!0})},Na=({children:i})=>{var a,s;const{isAuthenticated:e}=Et(),r=gt();if(e){const n=((s=(a=r.state)==null?void 0:a.from)==null?void 0:s.pathname)||"/";return t.jsx(Tr,{to:n,replace:!0})}return i},ja=({children:i})=>{const{state:e}=ae(),{isDarkMode:r}=e;return t.jsx("div",{className:`min-h-screen transition-colors duration-300 ${r?"dark bg-gradient-to-br from-gray-900 via-gray-900 to-gray-800":"bg-gradient-to-br from-gray-50 via-white to-gray-100"}`,children:t.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,ease:"easeOut"},className:"w-full",children:i})})},Sa=()=>{const i=gt();return["/login","/register"].includes(i.pathname)?t.jsx(oe,{mode:"wait",children:t.jsxs(Qr,{location:i,children:[t.jsx(ce,{path:"/login",element:t.jsx(Na,{children:t.jsx(ja,{children:t.jsx(sl,{})})})}),t.jsx(ce,{path:"/register",element:t.jsx(Na,{children:t.jsx(ja,{children:t.jsx(Ql,{})})})})]},i.pathname)}):t.jsx(oe,{mode:"wait",children:t.jsx(m.div,{initial:"initial",animate:"in",exit:"out",variants:ac,transition:sc,className:"w-full",children:t.jsxs(Qr,{location:i,children:[t.jsx(ce,{path:"/",element:t.jsx(ke,{children:t.jsx(ll,{})})}),t.jsx(ce,{path:"/products",element:t.jsx(ke,{children:t.jsx(nr,{})})}),t.jsx(ce,{path:"/product/:slug",element:t.jsx(ke,{children:t.jsx(wl,{})})}),t.jsx(ce,{path:"/categories",element:t.jsx(ke,{children:t.jsx(vl,{})})}),t.jsx(ce,{path:"/categories/:category",element:t.jsx(ke,{children:t.jsx(nr,{})})}),t.jsx(ce,{path:"/products/:category",element:t.jsx(ke,{children:t.jsx(nr,{})})}),t.jsx(ce,{path:"/cart",element:t.jsx(ke,{children:t.jsx(Cl,{})})}),t.jsx(ce,{path:"/checkout",element:t.jsx(ke,{children:t.jsx(Jl,{})})}),t.jsx(ce,{path:"/visual-search",element:t.jsx(ke,{children:t.jsx(Al,{})})}),t.jsx(ce,{path:"/recommendations",element:t.jsx(ke,{children:t.jsx(zl,{})})}),t.jsx(ce,{path:"/complementary-products",element:t.jsx(ke,{children:t.jsx(Bl,{})})}),t.jsx(ce,{path:"/profile/questionnaire",element:t.jsx(ke,{children:t.jsx(Hl,{})})}),t.jsx(ce,{path:"/admin/reviews",element:t.jsx(ke,{children:t.jsx(rc,{})})}),t.jsx(ce,{path:"*",element:t.jsx(Tr,{to:"/",replace:!0})})]})},i.pathname)})};function ic(){const{state:i}=ae(),{isDarkMode:e,sidebarOpen:r,isLoading:a,showWelcome:s}=i,{initializing:n}=Et();return Kt.useEffect(()=>{n||(async()=>{try{console.log("🚀 Initializing optimized Firebase services...");const l=await Yo();console.log("✅ Optimized services initialized:",l)}catch(l){console.error("❌ Failed to initialize optimized services:",l)}})()},[n]),n?t.jsx(_t,{children:t.jsx("div",{className:`min-h-screen flex items-center justify-center transition-colors duration-300 ${e?"dark bg-gradient-to-br from-gray-900 via-gray-900 to-gray-800":"bg-gradient-to-br from-gray-50 via-white to-gray-100"}`,children:t.jsx(vs,{size:"large"})})}):s?t.jsx(_t,{children:t.jsxs("div",{className:`transition-colors duration-300 ${e?"dark":""}`,children:[t.jsx(m.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:t.jsx(al,{})}),t.jsx(va,{})]})}):t.jsx(_t,{children:t.jsxs(ni,{children:[t.jsx(nc,{}),t.jsx(va,{})]})})}const nc=()=>{const{state:i}=ae(),{isDarkMode:e,sidebarOpen:r,isLoading:a}=i,s=gt();return["/login","/register"].includes(s.pathname)?t.jsx(Sa,{}):t.jsxs("div",{className:`min-h-screen transition-colors duration-300 ${e?"dark bg-gradient-to-br from-gray-900 via-gray-900 to-gray-800":"bg-gradient-to-br from-gray-50 via-white to-gray-100"}`,children:[t.jsx(m.div,{initial:{y:-80,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,ease:"easeOut"},children:t.jsx(Zo,{})}),t.jsxs("div",{className:"flex",children:[t.jsx(m.div,{initial:{x:-300,opacity:0},animate:{x:0,opacity:1},transition:{duration:.6,delay:.2,ease:"easeOut"},children:t.jsx(el,{})}),t.jsxs("main",{className:`flex-1 transition-all duration-300 ease-out ${r?"lg:ml-64":"ml-0"} pt-16 pb-20 lg:pb-0 relative overflow-hidden`,children:[t.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[t.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-primary-400/5 via-accent-400/5 to-transparent rounded-full blur-3xl"}),t.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-primary-400/5 via-accent-400/5 to-transparent rounded-full blur-3xl"})]}),t.jsxs(m.div,{className:"relative z-10 p-4 lg:p-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.4},children:[a&&t.jsx(m.div,{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:t.jsx(vs,{size:"large"})}),t.jsx(Sa,{})]}),t.jsx(m.div,{className:"hidden lg:block",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.6},children:t.jsx(tl,{})})]})]}),t.jsx(rl,{})]})};vr.createRoot(document.getElementById("root")).render(t.jsx(Kt.StrictMode,{children:t.jsx(Di,{children:t.jsx(ic,{})})}));
